export const id=99396;export const ids=[99396];export const modules={97247:(e,t,i)=>{i.d(t,{$O:()=>G,Bm:()=>p,Cr:()=>L,Cy:()=>a,DE:()=>c,DJ:()=>g,EZ:()=>f,Eo:()=>A,Hz:()=>n,Is:()=>h,JZ:()=>q,Lx:()=>W,PY:()=>F,S0:()=>T,SG:()=>v,TH:()=>$,Tx:()=>D,U:()=>R,VL:()=>o,Ve:()=>Q,W6:()=>x,YP:()=>b,Yn:()=>k,aG:()=>z,aL:()=>r,au:()=>l,dZ:()=>_,fC:()=>V,iK:()=>w,in:()=>U,jF:()=>N,jT:()=>E,lz:()=>y,mQ:()=>H,mR:()=>O,mX:()=>K,of:()=>Z,qN:()=>S,re:()=>I,sM:()=>d,sb:()=>C,tj:()=>M,u1:()=>s,wI:()=>m,zI:()=>u,zP:()=>P,zb:()=>j});let s=function(e){return e[e.Idle=0]="Idle",e[e.Including=1]="Including",e[e.Excluding=2]="Excluding",e[e.Busy=3]="Busy",e[e.SmartStart=4]="SmartStart",e}({}),a=function(e){return e[e.Default=0]="Default",e[e.SmartStart=1]="SmartStart",e[e.Insecure=2]="Insecure",e[e.Security_S0=3]="Security_S0",e[e.Security_S2=4]="Security_S2",e}({}),n=function(e){return e[e.Temporary=-2]="Temporary",e[e.None=-1]="None",e[e.S2_Unauthenticated=0]="S2_Unauthenticated",e[e.S2_Authenticated=1]="S2_Authenticated",e[e.S2_AccessControl=2]="S2_AccessControl",e[e.S0_Legacy=7]="S0_Legacy",e}({}),r=function(e){return e[e.SmartStart=0]="SmartStart",e}({});let o=function(e){return e[e.Error_Timeout=-1]="Error_Timeout",e[e.Error_Checksum=0]="Error_Checksum",e[e.Error_TransmissionFailed=1]="Error_TransmissionFailed",e[e.Error_InvalidManufacturerID=2]="Error_InvalidManufacturerID",e[e.Error_InvalidFirmwareID=3]="Error_InvalidFirmwareID",e[e.Error_InvalidFirmwareTarget=4]="Error_InvalidFirmwareTarget",e[e.Error_InvalidHeaderInformation=5]="Error_InvalidHeaderInformation",e[e.Error_InvalidHeaderFormat=6]="Error_InvalidHeaderFormat",e[e.Error_InsufficientMemory=7]="Error_InsufficientMemory",e[e.Error_InvalidHardwareVersion=8]="Error_InvalidHardwareVersion",e[e.OK_WaitingForActivation=253]="OK_WaitingForActivation",e[e.OK_NoRestart=254]="OK_NoRestart",e[e.OK_RestartPending=255]="OK_RestartPending",e}({}),c=function(e){return e[e.Error_Timeout=0]="Error_Timeout",e[e.Error_RetryLimitReached=1]="Error_RetryLimitReached",e[e.Error_Aborted=2]="Error_Aborted",e[e.Error_NotSupported=3]="Error_NotSupported",e[e.OK=255]="OK",e}({});const d=52;let l=function(e){return e[e.NotAvailable=127]="NotAvailable",e[e.ReceiverSaturated=126]="ReceiverSaturated",e[e.NoSignalDetected=125]="NoSignalDetected",e}({}),_=function(e){return e[e.ZWave_9k6=1]="ZWave_9k6",e[e.ZWave_40k=2]="ZWave_40k",e[e.ZWave_100k=3]="ZWave_100k",e[e.LongRange_100k=4]="LongRange_100k",e}({}),u=function(e){return e[e.Unknown=0]="Unknown",e[e.Asleep=1]="Asleep",e[e.Awake=2]="Awake",e[e.Dead=3]="Dead",e[e.Alive=4]="Alive",e}({});const h=(e,t)=>{if(t.device_id&&t.entry_id)throw new Error("Only one of device or entry ID should be supplied.");if(!t.device_id&&!t.entry_id)throw new Error("Either device or entry ID should be supplied.");return e.callWS({type:"zwave_js/network_status",device_id:t.device_id,entry_id:t.entry_id})},v=(e,t)=>e.callWS({type:"zwave_js/data_collection_status",entry_id:t}),y=(e,t,i)=>e.callWS({type:"zwave_js/update_data_collection_preference",entry_id:t,opted_in:i}),p=(e,t)=>e.callWS({type:"zwave_js/get_provisioning_entries",entry_id:t}),g=(e,t,i,s=a.Default,n,r,o,c)=>e.connection.subscribeMessage((e=>i(e)),{type:"zwave_js/add_node",entry_id:t,inclusion_strategy:s,qr_code_string:r,qr_provisioning_information:n,planned_provisioning_entry:o,dsk:c}),m=(e,t)=>e.callWS({type:"zwave_js/stop_inclusion",entry_id:t}),f=(e,t)=>e.callWS({type:"zwave_js/stop_exclusion",entry_id:t}),w=(e,t,i,s)=>e.callWS({type:"zwave_js/grant_security_classes",entry_id:t,securityClasses:i,clientSideAuth:s}),k=(e,t,i)=>e.callWS({type:"zwave_js/try_parse_dsk_from_qr_code_string",entry_id:t,qr_code_string:i}),b=(e,t,i)=>e.callWS({type:"zwave_js/validate_dsk_and_enter_pin",entry_id:t,pin:i}),S=(e,t,i)=>e.callWS({type:"zwave_js/supports_feature",entry_id:t,feature:i}),$=(e,t,i)=>e.callWS({type:"zwave_js/parse_qr_code_string",entry_id:t,qr_code_string:i}),z=(e,t,i,s,a)=>e.callWS({type:"zwave_js/provision_smart_start_node",entry_id:t,qr_code_string:s,qr_provisioning_information:i,planned_provisioning_entry:a}),q=(e,t,i,s)=>e.callWS({type:"zwave_js/unprovision_smart_start_node",entry_id:t,dsk:i,node_id:s}),H=(e,t)=>e.callWS({type:"zwave_js/node_status",device_id:t}),C=(e,t,i)=>e.connection.subscribeMessage((e=>i(e)),{type:"zwave_js/subscribe_node_status",device_id:t}),I=(e,t)=>e.callWS({type:"zwave_js/node_metadata",device_id:t}),j=(e,t)=>e.callWS({type:"zwave_js/node_alerts",device_id:t}),x=(e,t)=>e.callWS({type:"zwave_js/get_config_parameters",device_id:t}),V=(e,t,i,s,a,n)=>{const r={type:"zwave_js/set_config_parameter",device_id:t,property:i,endpoint:s,value:a,property_key:n};return e.callWS(r)},A=(e,t,i)=>e.connection.subscribeMessage((e=>i(e)),{type:"zwave_js/refresh_node_info",device_id:t}),E=(e,t)=>e.callWS({type:"zwave_js/rebuild_node_routes",device_id:t}),M=(e,t,i)=>e.connection.subscribeMessage((e=>i(e)),{type:"zwave_js/remove_failed_node",device_id:t}),W=(e,t)=>e.callWS({type:"zwave_js/begin_rebuilding_routes",entry_id:t}),D=(e,t)=>e.callWS({type:"zwave_js/stop_rebuilding_routes",entry_id:t}),T=(e,t,i)=>e.connection.subscribeMessage((e=>i(e)),{type:"zwave_js/subscribe_rebuild_routes_progress",entry_id:t}),P=(e,t,i)=>e.connection.subscribeMessage((e=>i(e)),{type:"zwave_js/subscribe_controller_statistics",entry_id:t}),N=(e,t,i)=>e.connection.subscribeMessage((e=>i(e)),{type:"zwave_js/subscribe_node_statistics",device_id:t}),L=(e,t)=>e.callWS({type:"zwave_js/is_node_firmware_update_in_progress",device_id:t}),R=(e,t)=>e.callWS({type:"zwave_js/is_any_ota_firmware_update_in_progress",entry_id:t}),F=(e,t)=>e.callWS({type:"zwave_js/hard_reset_controller",entry_id:t}),O=async(e,t,i,s)=>{const a=new FormData;a.append("file",i),void 0!==s&&a.append("target",s.toString());const n=await e.fetchWithAuth(`/api/zwave_js/firmware/upload/${t}`,{method:"POST",body:a});if(200!==n.status)throw new Error(n.statusText)},K=(e,t,i)=>e.connection.subscribeMessage((e=>i(e)),{type:"zwave_js/subscribe_firmware_update_status",device_id:t}),Z=(e,t)=>e.callWS({type:"zwave_js/abort_firmware_update",device_id:t}),U=(e,t,i)=>e.connection.subscribeMessage(i,{type:"zwave_js/subscribe_log_updates",entry_id:t}),G=(e,t)=>e.callWS({type:"zwave_js/get_log_config",entry_id:t}),Q=(e,t,i)=>e.callWS({type:"zwave_js/update_log_config",entry_id:t,config:{level:i}})},99396:(e,t,i)=>{i.r(t);var s=i(36312),a=i(68689),n=(i(253),i(2075),i(16891),i(72606),i(50289)),r=i(29818),o=i(10977),c=i(34897),d=(i(13292),i(32885),i(29180)),l=(i(88725),i(24284),i(20024),i(51513),i(60203),i(90431),i(97247)),_=i(55321);const u="M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z";(0,s.A)([(0,r.EM)("dialog-zwave_js-add-node")],(function(e,t){class i extends t{constructor(...t){super(...t),e(this)}}return{F:i,d:[{kind:"field",decorators:[(0,r.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_params",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_entryId",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_status",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_device",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_stages",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_inclusionStrategy",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_dsk",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_error",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_requestedGrant",value:void 0},{kind:"field",decorators:[(0,r.wk)()],key:"_securityClasses",value:()=>[]},{kind:"field",decorators:[(0,r.wk)()],key:"_lowSecurity",value:()=>!1},{kind:"field",decorators:[(0,r.wk)()],key:"_supportsSmartStart",value:void 0},{kind:"field",key:"_addNodeTimeoutHandle",value:void 0},{kind:"field",key:"_subscribed",value:void 0},{kind:"field",key:"_qrProcessing",value:()=>!1},{kind:"method",key:"connectedCallback",value:function(){(0,a.A)(i,"connectedCallback",this,3)([]),window.addEventListener("beforeunload",this._onBeforeUnload)}},{kind:"method",key:"disconnectedCallback",value:function(){(0,a.A)(i,"disconnectedCallback",this,3)([]),this._unsubscribe()}},{kind:"method",key:"showDialog",value:async function(e){this._params=e,this._entryId=e.entry_id,this._status="loading",this._checkSmartStartSupport(),this._startInclusion()}},{kind:"field",decorators:[(0,r.P)("#pin-input")],key:"_pinInput",value:void 0},{kind:"method",key:"render",value:function(){if(!this._entryId)return n.s6;const e=this._shouldPreventClose(),t=this.hass.localize("ui.panel.config.zwave_js.add_node.title");return n.qy` <ha-dialog open @closed="${this.closeDialog}" .heading="${e?t:(0,d.l)(this.hass,t)}" scrimClickAction="${(0,o.J)(e?"":void 0)}" escapeKeyAction="${(0,o.J)(e?"":void 0)}"> ${"loading"===this._status?n.qy`<div style="display:flex;justify-content:center"> <ha-circular-progress size="large" indeterminate></ha-circular-progress> </div>`:"waiting_for_device"===this._status?n.qy`<div class="flex-container"> <ha-circular-progress indeterminate></ha-circular-progress> <p> ${this.hass.localize("ui.panel.config.zwave_js.add_node.waiting_for_device")} </p> </div>`:"choose_strategy"===this._status?n.qy`<h3>Choose strategy</h3> <div class="flex-column"> <ha-formfield .label="${n.qy`<b>Secure if possible</b> <div class="secondary"> Requires user interaction during inclusion. Fast and secure with S2 when supported. Fallback to legacy S0 or no encryption when necessary. </div>`}"> <ha-radio name="strategy" @change="${this._handleStrategyChange}" .value="${l.Cy.Default}" .checked="${this._inclusionStrategy===l.Cy.Default||void 0===this._inclusionStrategy}"> </ha-radio> </ha-formfield> <ha-formfield .label="${n.qy`<b>Legacy Secure</b> <div class="secondary"> Uses the older S0 security that is secure, but slow due to a lot of overhead. Allows securely including S2 capable devices which fail to be included with S2. </div>`}"> <ha-radio name="strategy" @change="${this._handleStrategyChange}" .value="${l.Cy.Security_S0}" .checked="${this._inclusionStrategy===l.Cy.Security_S0}"> </ha-radio> </ha-formfield> <ha-formfield .label="${n.qy`<b>Insecure</b> <div class="secondary">Do not use encryption.</div>`}"> <ha-radio name="strategy" @change="${this._handleStrategyChange}" .value="${l.Cy.Insecure}" .checked="${this._inclusionStrategy===l.Cy.Insecure}"> </ha-radio> </ha-formfield> </div> <mwc-button slot="primaryAction" @click="${this._startManualInclusion}"> Search device </mwc-button>`:"qr_scan"===this._status?n.qy` <ha-qr-scanner .hass="${this.hass}" .localize="${this.hass.localize}" .error="${this._error}" @qr-code-scanned="${this._qrCodeScanned}" @qr-code-error="${this._qrCodeError}" @qr-code-closed="${this._startOver}"></ha-qr-scanner> <mwc-button slot="secondaryAction" @click="${this._startOver}"> ${this.hass.localize("ui.panel.config.zwave_js.common.back")} </mwc-button>`:"validate_dsk_enter_pin"===this._status?n.qy` <p> Please enter the 5-digit PIN for your device and verify that the rest of the device-specific key matches the one that can be found on your device or the manual. </p> ${this._error?n.qy`<ha-alert alert-type="error"> ${this._error} </ha-alert>`:""} <div class="flex-container"> <ha-textfield label="PIN" id="pin-input" @keyup="${this._handlePinKeyUp}"></ha-textfield> ${this._dsk} </div> <mwc-button slot="primaryAction" @click="${this._validateDskAndEnterPin}"> Submit </mwc-button> `:"grant_security_classes"===this._status?n.qy` <h3> The device has requested the following security classes: </h3> ${this._error?n.qy`<ha-alert alert-type="error">${this._error}</ha-alert>`:""} <div class="flex-column"> ${this._requestedGrant?.securityClasses.sort(((e,t)=>e===l.Hz.S0_Legacy?1:t===l.Hz.S0_Legacy?-1:t-e)).map((e=>n.qy`<ha-formfield .label="${n.qy`<b>${this.hass.localize(`ui.panel.config.zwave_js.security_classes.${l.Hz[e]}.title`)}</b> <div class="secondary"> ${this.hass.localize(`ui.panel.config.zwave_js.security_classes.${l.Hz[e]}.description`)} </div>`}"> <ha-checkbox @change="${this._handleSecurityClassChange}" .value="${e}" .checked="${this._securityClasses.includes(e)}"> </ha-checkbox> </ha-formfield>`))} </div> <mwc-button slot="primaryAction" .disabled="${!this._securityClasses.length}" @click="${this._grantSecurityClasses}"> Submit </mwc-button> `:"timed_out"===this._status?n.qy` <h3>Timed out!</h3> <p> We have not found any device in inclusion mode. Make sure the device is active and in inclusion mode. </p> <mwc-button slot="primaryAction" @click="${this._startOver}"> Retry </mwc-button> `:"started_specific"===this._status?n.qy`<h3> ${this.hass.localize("ui.panel.config.zwave_js.add_node.searching_device")} </h3> <ha-circular-progress indeterminate></ha-circular-progress> <p> ${this.hass.localize("ui.panel.config.zwave_js.add_node.follow_device_instructions")} </p>`:"started"===this._status?n.qy` <div class="select-inclusion"> <div class="outline"> <h2> ${this.hass.localize("ui.panel.config.zwave_js.add_node.searching_device")} </h2> <ha-circular-progress indeterminate></ha-circular-progress> <p> ${this.hass.localize("ui.panel.config.zwave_js.add_node.follow_device_instructions")} </p> <p> <button class="link" @click="${this._chooseInclusionStrategy}"> ${this.hass.localize("ui.panel.config.zwave_js.add_node.choose_inclusion_strategy")} </button> </p> </div> ${this._supportsSmartStart?n.qy`<div class="outline"> <h2> ${this.hass.localize("ui.panel.config.zwave_js.add_node.qr_code")} </h2> <ha-svg-icon .path="${"M4,4H10V10H4V4M20,4V10H14V4H20M14,15H16V13H14V11H16V13H18V11H20V13H18V15H20V18H18V20H16V18H13V20H11V16H14V15M16,15V18H18V15H16M4,20V14H10V20H4M6,6V8H8V6H6M16,6V8H18V6H16M6,16V18H8V16H6M4,11H6V13H4V11M9,11H13V15H11V13H9V11M11,6H13V10H11V6M2,2V6H0V2A2,2 0 0,1 2,0H6V2H2M22,0A2,2 0 0,1 24,2V6H22V2H18V0H22M2,18V22H6V24H2A2,2 0 0,1 0,22V18H2M22,22V18H24V22A2,2 0 0,1 22,24H18V22H22Z"}"></ha-svg-icon> <p> ${this.hass.localize("ui.panel.config.zwave_js.add_node.qr_code_paragraph")} </p> <p> <mwc-button @click="${this._scanQRCode}"> ${this.hass.localize("ui.panel.config.zwave_js.add_node.scan_qr_code")} </mwc-button> </p> </div>`:""} </div> <mwc-button slot="primaryAction" @click="${this.closeDialog}"> ${this.hass.localize("ui.common.cancel")} </mwc-button> `:"interviewing"===this._status?n.qy` <div class="flex-container"> <ha-circular-progress indeterminate></ha-circular-progress> <div class="status"> <p> <b>${this.hass.localize("ui.panel.config.zwave_js.add_node.interview_started")}</b> </p> ${this._stages?n.qy` <div class="stages"> ${this._stages.map((e=>n.qy` <span class="stage"> <ha-svg-icon .path="${u}" class="success"></ha-svg-icon> ${e} </span> `))} </div>`:""} </div> </div> <mwc-button slot="primaryAction" @click="${this.closeDialog}"> ${this.hass.localize("ui.common.close")} </mwc-button> `:"failed"===this._status?n.qy` <div class="flex-container"> <div class="status"> <ha-alert alert-type="error" .title="${this.hass.localize("ui.panel.config.zwave_js.add_node.inclusion_failed")}"> ${this._error||this.hass.localize("ui.panel.config.zwave_js.add_node.check_logs")} </ha-alert> ${this._stages?n.qy` <div class="stages"> ${this._stages.map((e=>n.qy` <span class="stage"> <ha-svg-icon .path="${u}" class="success"></ha-svg-icon> ${e} </span> `))} </div>`:""} </div> </div> <mwc-button slot="primaryAction" @click="${this.closeDialog}"> ${this.hass.localize("ui.common.close")} </mwc-button> `:"finished"===this._status?n.qy` <div class="flex-container"> <ha-svg-icon .path="${this._lowSecurity?"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z":u}" class="${this._lowSecurity?"warning":"success"}"></ha-svg-icon> <div class="status"> <p> ${this.hass.localize("ui.panel.config.zwave_js.add_node.inclusion_finished")} </p> ${this._lowSecurity?n.qy`<ha-alert alert-type="warning" title="The device was added insecurely"> There was an error during secure inclusion. You can try again by excluding the device and adding it again. </ha-alert>`:""} <a href="${`/config/devices/device/${this._device?.id}`}"> <mwc-button> ${this.hass.localize("ui.panel.config.zwave_js.add_node.view_device")} </mwc-button> </a> ${this._stages?n.qy` <div class="stages"> ${this._stages.map((e=>n.qy` <span class="stage"> <ha-svg-icon .path="${u}" class="success"></ha-svg-icon> ${e} </span> `))} </div>`:""} </div> </div> <mwc-button slot="primaryAction" @click="${this.closeDialog}"> ${this.hass.localize("ui.common.close")} </mwc-button> `:"provisioned"===this._status?n.qy` <div class="flex-container"> <ha-svg-icon .path="${u}" class="success"></ha-svg-icon> <div class="status"> <p> ${this.hass.localize("ui.panel.config.zwave_js.add_node.provisioning_finished")} </p> </div> </div> <mwc-button slot="primaryAction" @click="${this.closeDialog}"> ${this.hass.localize("ui.common.close")} </mwc-button>`:""} </ha-dialog> `}},{kind:"method",key:"_shouldPreventClose",value:function(){return"started_specific"===this._status||"validate_dsk_enter_pin"===this._status||"grant_security_classes"===this._status||"waiting_for_device"===this._status}},{kind:"method",key:"_chooseInclusionStrategy",value:function(){this._unsubscribe(),this._status="choose_strategy"}},{kind:"method",key:"_handleStrategyChange",value:function(e){this._inclusionStrategy=e.target.value}},{kind:"method",key:"_handleSecurityClassChange",value:function(e){const t=e.currentTarget,i=Number(t.value);t.checked&&!this._securityClasses.includes(i)?this._securityClasses=[...this._securityClasses,i]:t.checked||(this._securityClasses=this._securityClasses.filter((e=>e!==i)))}},{kind:"method",key:"_scanQRCode",value:async function(){this._unsubscribe(),this._status="qr_scan"}},{kind:"method",key:"_qrCodeScanned",value:function(e){this._qrProcessing||this._handleQrCodeScanned(e.detail.value)}},{kind:"method",key:"_qrCodeError",value:function(e){this._error=e.detail.message}},{kind:"method",key:"_handleQrCodeScanned",value:async function(e){if(this._error=void 0,"qr_scan"!==this._status||this._qrProcessing)return;this._qrProcessing=!0;const t=await(0,l.Yn)(this.hass,this._entryId,e);if(t)return this._status="loading",this.updateComplete.then((()=>{this._qrProcessing=!1})),this._inclusionStrategy=l.Cy.Security_S2,void this._startInclusion(void 0,t);if(e.length<l.sM||!e.startsWith("90"))return this._qrProcessing=!1,void(this._error=`Invalid QR code (${e})`);let i;try{i=await(0,l.TH)(this.hass,this._entryId,e)}catch(e){return this._qrProcessing=!1,void(this._error=e.message)}if(this._status="loading",this.updateComplete.then((()=>{this._qrProcessing=!1})),1===i.version)try{await(0,l.aG)(this.hass,this._entryId,i),this._status="provisioned",this._params?.addedCallback&&this._params.addedCallback()}catch(e){this._error=e.message,this._status="failed"}else 0===i.version?(this._inclusionStrategy=l.Cy.Security_S2,this._startInclusion(i)):(this._error="This QR code is not supported",this._status="failed")}},{kind:"method",key:"_handlePinKeyUp",value:function(e){"Enter"===e.key&&this._validateDskAndEnterPin()}},{kind:"method",key:"_validateDskAndEnterPin",value:async function(){this._status="waiting_for_device",this._error=void 0;try{await(0,l.YP)(this.hass,this._entryId,this._pinInput.value)}catch(e){this._error=e.message,this._status="validate_dsk_enter_pin",await this.updateComplete,this._pinInput?.focus()}}},{kind:"method",key:"_grantSecurityClasses",value:async function(){this._status="waiting_for_device",this._error=void 0;try{await(0,l.iK)(this.hass,this._entryId,this._securityClasses)}catch(e){this._error=e.message,this._status="grant_security_classes"}}},{kind:"method",key:"_startManualInclusion",value:function(){this._inclusionStrategy||(this._inclusionStrategy=l.Cy.Default),this._startInclusion()}},{kind:"method",key:"_checkSmartStartSupport",value:async function(){this._supportsSmartStart=(await(0,l.qN)(this.hass,this._entryId,l.aL.SmartStart)).supported}},{kind:"method",key:"_startOver",value:function(e){this._startInclusion()}},{kind:"method",key:"_startInclusion",value:function(e,t){if(!this.hass)return;this._lowSecurity=!1;const i=e||t;this._subscribed=(0,l.DJ)(this.hass,this._entryId,(e=>{if("inclusion started"===e.event&&(this._status=i?"started_specific":"started"),"inclusion failed"===e.event&&(this._unsubscribe(),this._status="failed"),"inclusion stopped"===e.event&&(this._addNodeTimeoutHandle&&clearTimeout(this._addNodeTimeoutHandle),this._addNodeTimeoutHandle=void 0),"node found"===e.event&&(this._status="waiting_for_device"),"validate dsk and enter pin"===e.event&&(this._status="validate_dsk_enter_pin",this._dsk=e.dsk),"grant security classes"===e.event){if(void 0===this._inclusionStrategy)return void(0,l.iK)(this.hass,this._entryId,e.requested_grant.securityClasses,e.requested_grant.clientSideAuth);this._requestedGrant=e.requested_grant,this._securityClasses=e.requested_grant.securityClasses,this._status="grant_security_classes"}"device registered"===e.event&&(this._device=e.device),"node added"===e.event&&(this._status="interviewing",this._lowSecurity=e.node.low_security),"interview completed"===e.event&&(this._unsubscribe(),this._status="finished",this._params?.addedCallback&&this._params.addedCallback()),"interview stage completed"===e.event&&(void 0===this._stages?this._stages=[e.stage]:this._stages=[...this._stages,e.stage])}),this._inclusionStrategy,e,void 0,void 0,t),this._addNodeTimeoutHandle=window.setTimeout((()=>{this._unsubscribe(),this._status="timed_out"}),9e4)}},{kind:"field",key:"_onBeforeUnload",value(){return e=>{this._shouldPreventClose()&&e.preventDefault(),e.returnValue=!0}}},{kind:"method",key:"_unsubscribe",value:function(){this._subscribed&&(this._subscribed.then((e=>e())),this._subscribed=void 0),this._entryId&&(0,l.wI)(this.hass,this._entryId),this._requestedGrant=void 0,this._dsk=void 0,this._securityClasses=[],this._status=void 0,this._addNodeTimeoutHandle&&clearTimeout(this._addNodeTimeoutHandle),this._addNodeTimeoutHandle=void 0,window.removeEventListener("beforeunload",this._onBeforeUnload)}},{kind:"method",key:"closeDialog",value:function(){this._unsubscribe(),this._inclusionStrategy=void 0,this._entryId=void 0,this._status=void 0,this._device=void 0,this._stages=void 0,this._error=void 0,(0,c.r)(this,"dialog-closed",{dialog:this.localName})}},{kind:"get",static:!0,key:"styles",value:function(){return[_.nA,_.RF,n.AH`h3{margin-top:0}.success{color:var(--success-color)}.warning{color:var(--warning-color)}.stages{margin-top:16px;display:grid}.flex-container .stage ha-svg-icon{width:16px;height:16px;margin-right:0px;margin-inline-end:0px;margin-inline-start:initial}.stage{padding:8px}.flex-container{display:flex;align-items:center}.flex-column{display:flex;flex-direction:column}.flex-column ha-formfield{padding:8px 0}.select-inclusion{display:flex;align-items:center}.select-inclusion .outline:nth-child(2){margin-left:16px;margin-inline-start:16px;margin-inline-end:initial}.select-inclusion .outline{border:1px solid var(--divider-color);border-radius:4px;padding:16px;min-height:250px;text-align:center;flex:1}@media all and (max-width:500px){.select-inclusion{flex-direction:column}.select-inclusion .outline:nth-child(2){margin-left:0;margin-inline-start:0;margin-inline-end:initial;margin-top:16px}}ha-svg-icon{width:68px;height:48px}ha-textfield{display:block}.secondary{color:var(--secondary-text-color)}.flex-container ha-circular-progress,.flex-container ha-svg-icon{margin-right:20px;margin-inline-end:20px;margin-inline-start:initial}`]}}]}}),n.WF)}};
//# sourceMappingURL=99396.QIqD3ivX-J8.js.map