export const id=38081;export const ids=[38081];export const modules={38081:(e,s,a)=>{a.r(s),a.d(s,{DialogAddUser:()=>c});var i=a(36312),t=a(68689),n=a(50289),o=a(29818),r=(a(13292),a(77372),a(32885),a(29180)),d=(a(24284),a(4169),a(24640),a(60203),a(90431),a(94526)),l=a(71443),h=a(55321);let c=(0,i.A)([(0,o.EM)("dialog-add-user")],(function(e,s){class a extends s{constructor(...s){super(...s),e(this)}}return{F:a,d:[{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_loading",value:()=>!1},{kind:"field",decorators:[(0,o.wk)()],key:"_error",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_params",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_name",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_username",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_password",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_passwordConfirm",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_isAdmin",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_localOnly",value:void 0},{kind:"field",decorators:[(0,o.wk)()],key:"_allowChangeName",value:()=>!0},{kind:"method",key:"showDialog",value:function(e){this._params=e,this._name=this._params.name||"",this._username="",this._password="",this._passwordConfirm="",this._isAdmin=!1,this._localOnly=!1,this._error=void 0,this._loading=!1,this._params.name?(this._allowChangeName=!1,this._maybePopulateUsername()):this._allowChangeName=!0}},{kind:"method",key:"firstUpdated",value:function(e){(0,t.A)(a,"firstUpdated",this,3)([e]),this.addEventListener("keypress",(e=>{"Enter"===e.key&&this._createUser(e)}))}},{kind:"method",key:"render",value:function(){return this._params?n.qy` <ha-dialog open @closed="${this._close}" scrimClickAction escapeKeyAction .heading="${(0,r.l)(this.hass,this.hass.localize("ui.panel.config.users.add_user.caption"))}"> <div> ${this._error?n.qy` <div class="error">${this._error}</div> `:""} ${this._allowChangeName?n.qy`<ha-textfield class="name" name="name" .label="${this.hass.localize("ui.panel.config.users.editor.name")}" .value="${this._name}" required .validationMessage="${this.hass.localize("ui.common.error_required")}" @input="${this._handleValueChanged}" @blur="${this._maybePopulateUsername}" dialogInitialFocus></ha-textfield>`:""} <ha-textfield class="username" name="username" .label="${this.hass.localize("ui.panel.config.users.editor.username")}" .value="${this._username}" required @input="${this._handleValueChanged}" .validationMessage="${this.hass.localize("ui.common.error_required")}" dialogInitialFocus></ha-textfield> <ha-textfield .label="${this.hass.localize("ui.panel.config.users.add_user.password")}" type="password" name="password" .value="${this._password}" required @input="${this._handleValueChanged}" .validationMessage="${this.hass.localize("ui.common.error_required")}"></ha-textfield> <ha-textfield label="${this.hass.localize("ui.panel.config.users.add_user.password_confirm")}" name="passwordConfirm" .value="${this._passwordConfirm}" @input="${this._handleValueChanged}" required type="password" .invalid="${""!==this._password&&""!==this._passwordConfirm&&this._passwordConfirm!==this._password}" .validationMessage="${this.hass.localize("ui.panel.config.users.add_user.password_not_match")}"></ha-textfield> <ha-settings-row> <span slot="heading"> ${this.hass.localize("ui.panel.config.users.editor.local_access_only")} </span> <span slot="description"> ${this.hass.localize("ui.panel.config.users.editor.local_access_only_description")} </span> <ha-switch .checked="${this._localOnly}" @change="${this._localOnlyChanged}"> </ha-switch> </ha-settings-row> <ha-settings-row> <span slot="heading"> ${this.hass.localize("ui.panel.config.users.editor.admin")} </span> <span slot="description"> ${this.hass.localize("ui.panel.config.users.editor.admin_description")} </span> <ha-switch .checked="${this._isAdmin}" @change="${this._adminChanged}"> </ha-switch> </ha-settings-row> ${this._isAdmin?n.s6:n.qy` <ha-alert alert-type="info"> ${this.hass.localize("ui.panel.config.users.users_privileges_note")} </ha-alert> `} </div> ${this._loading?n.qy` <div slot="primaryAction" class="submit-spinner"> <ha-circular-progress indeterminate></ha-circular-progress> </div> `:n.qy` <ha-button slot="primaryAction" .disabled="${!this._name||!this._username||!this._password||this._password!==this._passwordConfirm}" @click="${this._createUser}"> ${this.hass.localize("ui.panel.config.users.add_user.create")} </ha-button> `} </ha-dialog> `:n.s6}},{kind:"method",key:"_close",value:function(){this._params=void 0}},{kind:"method",key:"_maybePopulateUsername",value:function(){if(this._username||!this._name)return;const e=this._name.split(" ");e.length&&(this._username=e[0].toLowerCase())}},{kind:"method",key:"_handleValueChanged",value:function(e){this._error=void 0;const s=e.target;this[`_${s.name}`]=s.value}},{kind:"method",key:"_adminChanged",value:async function(e){const s=e.target;this._isAdmin=s.checked}},{kind:"method",key:"_localOnlyChanged",value:function(e){const s=e.target;this._localOnly=s.checked}},{kind:"method",key:"_createUser",value:async function(e){if(e.preventDefault(),!this._name||!this._username||!this._password)return;let s;this._loading=!0,this._error="";try{s=(await(0,l.kg)(this.hass,this._name,[this._isAdmin?l.wj:l.eR],this._localOnly)).user}catch(e){return this._loading=!1,void(this._error=e.message)}try{await(0,d.Fy)(this.hass,s.id,this._username,this._password)}catch(e){return await(0,l.hG)(this.hass,s.id),this._loading=!1,void(this._error=e.message)}s.username=this._username,s.credentials=[{type:"homeassistant"}],this._params.userAddedCallback(s),this._close()}},{kind:"get",static:!0,key:"styles",value:function(){return[h.nA,n.AH`ha-dialog{--mdc-dialog-max-width:500px;--dialog-z-index:10}.row{display:flex;padding:8px 0}ha-textfield{display:block;margin-bottom:8px}ha-settings-row{padding:0}`]}}]}}),n.WF)}};
//# sourceMappingURL=38081.ML2k5o03uLY.js.map