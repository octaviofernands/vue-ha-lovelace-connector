export const id=65960;export const ids=[65960];export const modules={5965:(t,i,e)=>{var s=e(36312),a=(e(89655),e(253),e(2075),e(54846),e(50289)),o=e(29818),n=e(94100),r=e(21863),l=e(34897),c=e(2682),d=e(4826),h=e(84976),u=(e(85242),e(88400),e(12675),e(55792));(0,s.A)([(0,o.EM)("ha-statistic-picker")],(function(t,i){return{F:class extends i{constructor(...i){super(...i),t(this)}},d:[{kind:"field",decorators:[(0,o.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,o.MZ)()],key:"label",value:void 0},{kind:"field",decorators:[(0,o.MZ)()],key:"value",value:void 0},{kind:"field",decorators:[(0,o.MZ)({attribute:"statistic-types"})],key:"statisticTypes",value:void 0},{kind:"field",decorators:[(0,o.MZ)({type:Boolean,attribute:"allow-custom-entity"})],key:"allowCustomEntity",value:void 0},{kind:"field",decorators:[(0,o.MZ)({type:Array})],key:"statisticIds",value:void 0},{kind:"field",decorators:[(0,o.MZ)({type:Boolean})],key:"disabled",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({type:Array,attribute:"include-statistics-unit-of-measurement"})],key:"includeStatisticsUnitOfMeasurement",value:void 0},{kind:"field",decorators:[(0,o.MZ)({attribute:"include-unit-class"})],key:"includeUnitClass",value:void 0},{kind:"field",decorators:[(0,o.MZ)({attribute:"include-device-class"})],key:"includeDeviceClass",value:void 0},{kind:"field",decorators:[(0,o.MZ)({type:Boolean,attribute:"entities-only"})],key:"entitiesOnly",value:()=>!1},{kind:"field",decorators:[(0,o.MZ)({type:Array,attribute:"exclude-statistics"})],key:"excludeStatistics",value:void 0},{kind:"field",decorators:[(0,o.MZ)()],key:"helpMissingEntityUrl",value:()=>"/more-info/statistics/"},{kind:"field",decorators:[(0,o.wk)()],key:"_opened",value:void 0},{kind:"field",decorators:[(0,o.P)("ha-combo-box",!0)],key:"comboBox",value:void 0},{kind:"field",key:"_init",value:()=>!1},{kind:"field",key:"_statistics",value:()=>[]},{kind:"field",decorators:[(0,o.wk)()],key:"_filteredItems",value(){}},{kind:"field",key:"_rowRenderer",value(){return t=>a.qy`<mwc-list-item graphic="avatar" twoline> ${t.state?a.qy`<state-badge slot="graphic" .stateObj="${t.state}" .hass="${this.hass}"></state-badge>`:""} <span>${t.name}</span> <span slot="secondary">${""===t.id||"__missing"===t.id?a.qy`<a target="_blank" rel="noopener noreferrer" href="${(0,h.o)(this.hass,this.helpMissingEntityUrl)}">${this.hass.localize("ui.components.statistic-picker.learn_more")}</a>`:t.id}</span> </mwc-list-item>`}},{kind:"field",key:"_getStatistics",value(){return(0,n.A)(((t,i,e,s,a,o,n)=>{if(!t.length)return[{id:"",name:this.hass.localize("ui.components.statistic-picker.no_statistics"),strings:[]}];if(i){const e=(0,r.e)(i);t=t.filter((t=>e.includes(t.statistics_unit_of_measurement)))}if(e){const i=(0,r.e)(e);t=t.filter((t=>i.includes(t.unit_class)))}if(s){const i=(0,r.e)(s);t=t.filter((t=>{const e=this.hass.states[t.statistic_id];return!e||i.includes(e.attributes.device_class||"")}))}const l=[];return t.forEach((t=>{if(o&&t.statistic_id!==n&&o.includes(t.statistic_id))return;const i=this.hass.states[t.statistic_id];if(!i){if(!a){const i=t.statistic_id,e=(0,d.$O)(this.hass,t.statistic_id,t);l.push({id:i,name:e,strings:[i,e]})}return}const e=t.statistic_id,s=(0,d.$O)(this.hass,t.statistic_id,t);l.push({id:e,name:s,state:i,strings:[e,s]})})),l.length?(l.length>1&&l.sort(((t,i)=>(0,c.x)(t.name||"",i.name||"",this.hass.locale.language))),l.push({id:"__missing",name:this.hass.localize("ui.components.statistic-picker.missing_entity"),strings:[]}),l):[{id:"",name:this.hass.localize("ui.components.statistic-picker.no_match"),strings:[]}]}))}},{kind:"method",key:"open",value:function(){this.comboBox?.open()}},{kind:"method",key:"focus",value:function(){this.comboBox?.focus()}},{kind:"method",key:"willUpdate",value:function(t){(!this.hasUpdated&&!this.statisticIds||t.has("statisticTypes"))&&this._getStatisticIds(),(!this._init&&this.statisticIds||t.has("_opened")&&this._opened)&&(this._init=!0,this.hasUpdated?this._statistics=this._getStatistics(this.statisticIds,this.includeStatisticsUnitOfMeasurement,this.includeUnitClass,this.includeDeviceClass,this.entitiesOnly,this.excludeStatistics,this.value):this.updateComplete.then((()=>{this._statistics=this._getStatistics(this.statisticIds,this.includeStatisticsUnitOfMeasurement,this.includeUnitClass,this.includeDeviceClass,this.entitiesOnly,this.excludeStatistics,this.value)})))}},{kind:"method",key:"render",value:function(){return 0===this._statistics.length?a.s6:a.qy` <ha-combo-box .hass="${this.hass}" .label="${void 0===this.label&&this.hass?this.hass.localize("ui.components.statistic-picker.statistic"):this.label}" .value="${this._value}" .renderer="${this._rowRenderer}" .disabled="${this.disabled}" .allowCustomValue="${this.allowCustomEntity}" .items="${this._statistics}" .filteredItems="${this._filteredItems??this._statistics}" item-value-path="id" item-id-path="id" item-label-path="name" @opened-changed="${this._openedChanged}" @value-changed="${this._statisticChanged}" @filter-changed="${this._filterChanged}"></ha-combo-box> `}},{kind:"method",key:"_getStatisticIds",value:async function(){this.statisticIds=await(0,d.p3)(this.hass,this.statisticTypes)}},{kind:"get",key:"_value",value:function(){return this.value||""}},{kind:"method",key:"_statisticChanged",value:function(t){t.stopPropagation();let i=t.detail.value;"__missing"===i&&(i=""),i!==this._value&&this._setValue(i)}},{kind:"method",key:"_openedChanged",value:function(t){this._opened=t.detail.value}},{kind:"method",key:"_filterChanged",value:function(t){const i=t.detail.value.toLowerCase();this._filteredItems=i.length?(0,u.H)(i,this._statistics):void 0}},{kind:"method",key:"_setValue",value:function(t){this.value=t,setTimeout((()=>{(0,l.r)(this,"value-changed",{value:t}),(0,l.r)(this,"change")}),0)}}]}}),a.WF)},65960:(t,i,e)=>{e.a(t,(async(t,s)=>{try{e.r(i),e.d(i,{DialogEnergySolarSettings:()=>k});var a=e(36312),o=(e(89655),e(253),e(2075),e(16891),e(72606),e(50289)),n=e(29818),r=e(34897),l=(e(5965),e(88725),e(29180),e(24284),e(51513),e(31265)),c=e(47076),d=e(96778),h=e(30581),u=e(55321),_=e(51842),f=t([c]);c=(f.then?(await f)():f)[0];const g="M11.45,2V5.55L15,3.77L11.45,2M10.45,8L8,10.46L11.75,11.71L10.45,8M2,11.45L3.77,15L5.55,11.45H2M10,2H2V10C2.57,10.17 3.17,10.25 3.77,10.25C7.35,10.26 10.26,7.35 10.27,3.75C10.26,3.16 10.17,2.57 10,2M17,22V16H14L19,7V13H22L17,22Z",y=["energy"];let k=(0,a.A)([(0,n.EM)("dialog-energy-solar-settings")],(function(t,i){return{F:class extends i{constructor(...i){super(...i),t(this)}},d:[{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_params",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_source",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_configEntries",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_forecast",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_energy_units",value:void 0},{kind:"field",decorators:[(0,n.wk)()],key:"_error",value:void 0},{kind:"field",key:"_excludeList",value:void 0},{kind:"method",key:"showDialog",value:async function(t){this._params=t,this._fetchSolarForecastConfigEntries(),this._source=t.source?{...t.source}:(0,c.Q4)(),this._forecast=null!==this._source.config_entry_solar_forecast,this._energy_units=(await(0,d.j4)(this.hass,"energy")).units,this._excludeList=this._params.solar_sources.map((t=>t.stat_energy_from)).filter((t=>t!==this._source?.stat_energy_from))}},{kind:"method",key:"closeDialog",value:function(){this._params=void 0,this._source=void 0,this._error=void 0,this._excludeList=void 0,(0,r.r)(this,"dialog-closed",{dialog:this.localName})}},{kind:"method",key:"render",value:function(){if(!this._params||!this._source)return o.s6;const t=this._energy_units?.join(", ")||"";return o.qy` <ha-dialog open .heading="${o.qy`<ha-svg-icon .path="${g}" style="--mdc-icon-size:32px"></ha-svg-icon> ${this.hass.localize("ui.panel.config.energy.solar.dialog.header")}`}" @closed="${this.closeDialog}"> ${this._error?o.qy`<p class="error">${this._error}</p>`:""} <div> ${this.hass.localize("ui.panel.config.energy.solar.dialog.entity_para",{unit:t})} </div> <ha-statistic-picker .hass="${this.hass}" .helpMissingEntityUrl="${c.X4}" .includeUnitClass="${y}" .value="${this._source.stat_energy_from}" .label="${this.hass.localize("ui.panel.config.energy.solar.dialog.solar_production_energy")}" .excludeStatistics="${this._excludeList}" @value-changed="${this._statisticChanged}" dialogInitialFocus></ha-statistic-picker> <h3> ${this.hass.localize("ui.panel.config.energy.solar.dialog.solar_production_forecast")} </h3> <p> ${this.hass.localize("ui.panel.config.energy.solar.dialog.solar_production_forecast_description")} </p> <ha-formfield label="${this.hass.localize("ui.panel.config.energy.solar.dialog.dont_forecast_production")}"> <ha-radio value="false" name="forecast" .checked="${!this._forecast}" @change="${this._handleForecastChanged}"></ha-radio> </ha-formfield> <ha-formfield label="${this.hass.localize("ui.panel.config.energy.solar.dialog.forecast_production")}"> <ha-radio value="true" name="forecast" .checked="${this._forecast}" @change="${this._handleForecastChanged}"></ha-radio> </ha-formfield> ${this._forecast?o.qy`<div class="forecast-options"> ${this._configEntries?.map((t=>o.qy`<ha-formfield .label="${o.qy`<div style="display:flex;align-items:center"> <img alt="" crossorigin="anonymous" referrerpolicy="no-referrer" style="height:24px;margin-right:16px;margin-inline-end:16px;margin-inline-start:initial" src="${(0,_.MR)({domain:t.domain,type:"icon",darkOptimized:this.hass.themes?.darkMode})}">${t.title} </div>`}"> <ha-checkbox .entry="${t}" @change="${this._forecastCheckChanged}" .checked="${this._source?.config_entry_solar_forecast?.includes(t.entry_id)}"> </ha-checkbox> </ha-formfield>`))} <mwc-button @click="${this._addForecast}"> ${this.hass.localize("ui.panel.config.energy.solar.dialog.add_forecast")} </mwc-button> </div>`:""} <mwc-button @click="${this.closeDialog}" slot="secondaryAction"> ${this.hass.localize("ui.common.cancel")} </mwc-button> <mwc-button @click="${this._save}" .disabled="${!this._source.stat_energy_from}" slot="primaryAction"> ${this.hass.localize("ui.common.save")} </mwc-button> </ha-dialog> `}},{kind:"method",key:"_fetchSolarForecastConfigEntries",value:async function(){const t=this._params.info.solar_forecast_domains;this._configEntries=0===t.length?[]:1===t.length?await(0,l.VN)(this.hass,{type:["service"],domain:t[0]}):(await(0,l.VN)(this.hass,{type:["service"]})).filter((i=>t.includes(i.domain)))}},{kind:"method",key:"_handleForecastChanged",value:function(t){const i=t.currentTarget;this._forecast="true"===i.value}},{kind:"method",key:"_forecastCheckChanged",value:function(t){const i=t.currentTarget,e=i.entry;i.checked?(null===this._source.config_entry_solar_forecast&&(this._source.config_entry_solar_forecast=[]),this._source.config_entry_solar_forecast.push(e.entry_id)):this._source.config_entry_solar_forecast.splice(this._source.config_entry_solar_forecast.indexOf(e.entry_id),1)}},{kind:"method",key:"_addForecast",value:function(){(0,h.W)(this,{startFlowHandler:"forecast_solar",dialogClosedCallback:t=>{t.entryId&&(null===this._source.config_entry_solar_forecast&&(this._source.config_entry_solar_forecast=[]),this._source.config_entry_solar_forecast.push(t.entryId),this._fetchSolarForecastConfigEntries())}})}},{kind:"method",key:"_statisticChanged",value:function(t){this._source={...this._source,stat_energy_from:t.detail.value}}},{kind:"method",key:"_save",value:async function(){try{this._forecast||(this._source.config_entry_solar_forecast=null),await this._params.saveCallback(this._source),this.closeDialog()}catch(t){this._error=t.message}}},{kind:"get",static:!0,key:"styles",value:function(){return[u.RF,u.nA,o.AH`ha-dialog{--mdc-dialog-max-width:430px}img{height:24px;margin-right:16px;margin-inline-end:16px;margin-inline-start:initial}ha-formfield{display:block}ha-statistic-picker{width:100%}.forecast-options{padding-left:32px;padding-inline-start:32px;padding-inline-end:initial}.forecast-options mwc-button{padding-left:8px;padding-inline-start:8px;padding-inline-end:initial}`]}}]}}),o.WF);s()}catch(t){s(t)}}))}};
//# sourceMappingURL=65960.ApHOsKpAM60.js.map