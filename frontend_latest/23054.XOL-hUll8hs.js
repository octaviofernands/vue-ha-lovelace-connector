export const id=23054;export const ids=[23054,921];export const modules={79682:(e,i,t)=>{t.d(i,{f:()=>n});t(253),t(4525);var a=t(21863),o=t(33922);const n=(e,i)=>(l(i)||s(e,i))&&!d(e,i)&&r(e,i),s=(e,i)=>!i.component||(0,a.e)(i.component).some((i=>(0,o.x)(e,i))),r=(e,i)=>!i.not_component||!(0,a.e)(i.not_component).some((i=>(0,o.x)(e,i))),l=e=>e.core,d=(e,i)=>(e=>e.advancedOnly)(i)&&!(e=>e.userData?.showAdvanced)(e)},37456:(e,i,t)=>{t.d(i,{a:()=>o});const a=(0,t(58034).n)((e=>{history.replaceState({scrollPosition:e},"")}),300),o=e=>i=>({kind:"method",placement:"prototype",key:i.key,descriptor:{set(e){a(e),this[`__${String(i.key)}`]=e},get(){return this[`__${String(i.key)}`]||history.state?.scrollPosition},enumerable:!0,configurable:!0},finisher(t){const a=t.prototype.connectedCallback;t.prototype.connectedCallback=function(){a.call(this);const t=this[i.key];t&&this.updateComplete.then((()=>{const i=this.renderRoot.querySelector(e);i&&setTimeout((()=>{i.scrollTop=t}),0)}))}}})},72829:(e,i,t)=>{var a=t(36312),o=(t(253),t(2075),t(50289)),n=t(29818),s=(t(4169),t(88400),t(90431),t(34897));(0,a.A)([(0,n.EM)("search-input")],(function(e,i){return{F:class extends i{constructor(...i){super(...i),e(this)}},d:[{kind:"field",decorators:[(0,n.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,n.MZ)()],key:"filter",value:void 0},{kind:"field",decorators:[(0,n.MZ)({type:Boolean})],key:"suffix",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:Boolean})],key:"autofocus",value:()=>!1},{kind:"field",decorators:[(0,n.MZ)({type:String})],key:"label",value:void 0},{kind:"method",key:"focus",value:function(){this._input?.focus()}},{kind:"field",decorators:[(0,n.P)("ha-textfield",!0)],key:"_input",value:void 0},{kind:"method",key:"render",value:function(){return o.qy` <ha-textfield .autofocus="${this.autofocus}" .label="${this.label||this.hass.localize("ui.common.search")}" .value="${this.filter||""}" icon .iconTrailing="${this.filter||this.suffix}" @input="${this._filterInputChanged}"> <slot name="prefix" slot="leadingIcon"> <ha-svg-icon tabindex="-1" class="prefix" .path="${"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}"></ha-svg-icon> </slot> <div class="trailing" slot="trailingIcon"> ${this.filter&&o.qy` <ha-icon-button @click="${this._clearSearch}" .label="${this.hass.localize("ui.common.clear")}" .path="${"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}" class="clear-button"></ha-icon-button> `} <slot name="suffix"></slot> </div> </ha-textfield> `}},{kind:"method",key:"_filterChanged",value:async function(e){(0,s.r)(this,"value-changed",{value:String(e)})}},{kind:"method",key:"_filterInputChanged",value:async function(e){this._filterChanged(e.target.value)}},{kind:"method",key:"_clearSearch",value:async function(){this._filterChanged("")}},{kind:"get",static:!0,key:"styles",value:function(){return o.AH`:host{display:inline-flex}ha-icon-button,ha-svg-icon{color:var(--primary-text-color)}ha-svg-icon{outline:0}.clear-button{--mdc-icon-size:20px}ha-textfield{display:inherit}.trailing{display:flex;align-items:center}`}}]}}),o.WF)},921:(e,i,t)=>{var a=t(36312),o=t(68689),n=(t(253),t(2075),t(94438),t(16891),t(50289)),s=t(29818),r=t(85323),l=t(94100),d=t(37456),h=(t(45346),t(11804),t(88400),t(17081),t(55321)),c=t(79682);(0,a.A)([(0,s.EM)("hass-tabs-subpage")],(function(e,i){class t extends i{constructor(...i){super(...i),e(this)}}return{F:t,d:[{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,s.MZ)({type:Boolean})],key:"supervisor",value:()=>!1},{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"localizeFunc",value:void 0},{kind:"field",decorators:[(0,s.MZ)({type:String,attribute:"back-path"})],key:"backPath",value:void 0},{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"backCallback",value:void 0},{kind:"field",decorators:[(0,s.MZ)({type:Boolean,attribute:"main-page"})],key:"mainPage",value:()=>!1},{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"route",value:void 0},{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"tabs",value:void 0},{kind:"field",decorators:[(0,s.MZ)({type:Boolean,reflect:!0})],key:"narrow",value:()=>!1},{kind:"field",decorators:[(0,s.MZ)({type:Boolean,reflect:!0,attribute:"is-wide"})],key:"isWide",value:()=>!1},{kind:"field",decorators:[(0,s.MZ)({type:Boolean})],key:"pane",value:()=>!1},{kind:"field",decorators:[(0,s.wk)()],key:"_activeTab",value:void 0},{kind:"field",decorators:[(0,d.a)(".content")],key:"_savedScrollPos",value:void 0},{kind:"field",key:"_getTabs",value(){return(0,l.A)(((e,i,t,a,o,s)=>{const r=e.filter((e=>(0,c.f)(this.hass,e)));if(r.length<2){if(1===r.length){const e=r[0];return[e.translationKey?s(e.translationKey):e.name]}return[""]}return r.map((e=>n.qy` <a href="${e.path}"> <ha-tab .hass="${this.hass}" .active="${e.path===i?.path}" .narrow="${this.narrow}" .name="${e.translationKey?s(e.translationKey):e.name}"> ${e.iconPath?n.qy`<ha-svg-icon slot="icon" .path="${e.iconPath}"></ha-svg-icon>`:""} </ha-tab> </a> `))}))}},{kind:"method",key:"willUpdate",value:function(e){e.has("route")&&(this._activeTab=this.tabs.find((e=>`${this.route.prefix}${this.route.path}`.includes(e.path)))),(0,o.A)(t,"willUpdate",this,3)([e])}},{kind:"method",key:"render",value:function(){const e=this._getTabs(this.tabs,this._activeTab,this.hass.config.components,this.hass.language,this.narrow,this.localizeFunc||this.hass.localize),i=e.length>1;return n.qy` <div class="toolbar"> <slot name="toolbar"> <div class="toolbar-content"> ${this.mainPage||!this.backPath&&history.state?.root?n.qy` <ha-menu-button .hassio="${this.supervisor}" .hass="${this.hass}" .narrow="${this.narrow}"></ha-menu-button> `:this.backPath?n.qy` <a href="${this.backPath}"> <ha-icon-button-arrow-prev .hass="${this.hass}"></ha-icon-button-arrow-prev> </a> `:n.qy` <ha-icon-button-arrow-prev .hass="${this.hass}" @click="${this._backTapped}"></ha-icon-button-arrow-prev> `} ${this.narrow||!i?n.qy`<div class="main-title"> <slot name="header">${i?"":e[0]}</slot> </div>`:""} ${i&&!this.narrow?n.qy`<div id="tabbar">${e}</div>`:""} <div id="toolbar-icon"> <slot name="toolbar-icon"></slot> </div> </div> </slot> ${i&&this.narrow?n.qy`<div id="tabbar" class="bottom-bar">${e}</div>`:""} </div> <div class="container"> ${this.pane?n.qy`<div class="pane"> <div class="shadow-container"></div> <div class="ha-scrollbar"> <slot name="pane"></slot> </div> </div>`:n.s6} <div class="content ha-scrollbar ${(0,r.H)({tabs:i})}" @scroll="${this._saveScrollPos}"> <slot></slot> </div> </div> <div id="fab" class="${(0,r.H)({tabs:i})}"> <slot name="fab"></slot> </div> `}},{kind:"method",decorators:[(0,s.Ls)({passive:!0})],key:"_saveScrollPos",value:function(e){this._savedScrollPos=e.target.scrollTop}},{kind:"method",key:"_backTapped",value:function(){this.backCallback?this.backCallback():history.back()}},{kind:"get",static:!0,key:"styles",value:function(){return[h.dp,n.AH`:host{display:block;height:100%;background-color:var(--primary-background-color)}:host([narrow]){width:100%;position:fixed}.container{display:flex;height:calc(100% - var(--header-height))}:host([narrow]) .container{height:100%}ha-menu-button{margin-right:24px;margin-inline-end:24px;margin-inline-start:initial}.toolbar{font-size:20px;height:var(--header-height);background-color:var(--sidebar-background-color);font-weight:400;border-bottom:1px solid var(--divider-color);box-sizing:border-box}.toolbar-content{padding:8px 12px;display:flex;align-items:center;height:100%;box-sizing:border-box}@media (max-width:599px){.toolbar-content{padding:4px}}.toolbar a{color:var(--sidebar-text-color);text-decoration:none}.bottom-bar a{width:25%}#tabbar{display:flex;font-size:14px;overflow:hidden}#tabbar>a{overflow:hidden;max-width:45%}#tabbar.bottom-bar{position:absolute;bottom:0;left:0;padding:0 16px;box-sizing:border-box;background-color:var(--sidebar-background-color);border-top:1px solid var(--divider-color);justify-content:space-around;z-index:2;font-size:12px;width:100%;padding-bottom:env(safe-area-inset-bottom)}#tabbar:not(.bottom-bar){flex:1;justify-content:center}:host(:not([narrow])) #toolbar-icon{min-width:40px}::slotted([slot=toolbar-icon]),ha-icon-button-arrow-prev,ha-menu-button{display:flex;flex-shrink:0;pointer-events:auto;color:var(--sidebar-icon-color)}.main-title{flex:1;max-height:var(--header-height);line-height:20px;color:var(--sidebar-text-color);margin:var(--main-title-margin,var(--margin-title))}.content{position:relative;width:calc(100% - env(safe-area-inset-left) - env(safe-area-inset-right));margin-left:env(safe-area-inset-left);margin-right:env(safe-area-inset-right);margin-inline-start:env(safe-area-inset-left);margin-inline-end:env(safe-area-inset-right);overflow:auto;-webkit-overflow-scrolling:touch}:host([narrow]) .content.tabs{height:calc(100% - 2 * var(--header-height));height:calc(100% - 2 * var(--header-height) - env(safe-area-inset-bottom))}#fab{position:fixed;right:calc(16px + env(safe-area-inset-right));inset-inline-end:calc(16px + env(safe-area-inset-right));inset-inline-start:initial;bottom:calc(16px + env(safe-area-inset-bottom));z-index:1;display:flex;flex-wrap:wrap;justify-content:flex-end;gap:8px}:host([narrow]) #fab.tabs{bottom:calc(84px + env(safe-area-inset-bottom))}#fab[is-wide]{bottom:24px;right:24px;inset-inline-end:24px;inset-inline-start:initial}.pane{border-right:1px solid var(--divider-color);border-inline-end:1px solid var(--divider-color);border-inline-start:initial;box-sizing:border-box;display:flex;flex:0 0 var(--sidepane-width,250px);width:var(--sidepane-width,250px);flex-direction:column;position:relative}.pane .ha-scrollbar{flex:1}`]}}]}}),n.WF)},17270:(e,i,t)=>{t.d(i,{J8:()=>n,Rr:()=>r,b9:()=>a,iV:()=>s,xW:()=>o});const a=e=>{let i=e;return"string"==typeof e&&(i=parseInt(e,16)),"0x"+i.toString(16).padStart(4,"0")},o=e=>e.split(":").slice(-4).reverse().join(""),n=(e,i)=>{const t=e.user_given_name?e.user_given_name:e.name,a=i.user_given_name?i.user_given_name:i.name;return t.localeCompare(a)},s=(e,i)=>{const t=e.name,a=i.name;return t.localeCompare(a)},r=e=>`${e.name} (Endpoint id: ${e.endpoint_id}, Id: ${a(e.id)}, Type: ${e.type})`},23054:(e,i,t)=>{t.r(i),t.d(i,{ZHANetworkVisualizationPage:()=>u});var a=t(36312),o=t(68689),n=(t(89655),t(253),t(54846),t(16891),t(72606),t(50289)),s=t(29818),r=t(1439),l=t(16312),d=(t(72829),t(45784),t(26790),t(88725),t(24284),t(15419)),h=(t(921),t(17270)),c=t(11321);let u=(0,a.A)([(0,s.EM)("zha-network-visualization-page")],(function(e,i){class t extends i{constructor(...i){super(...i),e(this)}}return{F:t,d:[{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,s.MZ)({attribute:!1})],key:"route",value:void 0},{kind:"field",decorators:[(0,s.MZ)({type:Boolean,reflect:!0})],key:"narrow",value:()=>!1},{kind:"field",decorators:[(0,s.MZ)({type:Boolean})],key:"isWide",value:()=>!1},{kind:"field",decorators:[(0,s.MZ)()],key:"zoomedDeviceIdFromURL",value:void 0},{kind:"field",decorators:[(0,s.wk)()],key:"zoomedDeviceId",value:void 0},{kind:"field",decorators:[(0,s.P)("#visualization",!0)],key:"_visualization",value:void 0},{kind:"field",decorators:[(0,s.wk)()],key:"_devices",value:()=>new Map},{kind:"field",decorators:[(0,s.wk)()],key:"_devicesByDeviceId",value:()=>new Map},{kind:"field",decorators:[(0,s.wk)()],key:"_nodes",value:()=>[]},{kind:"field",decorators:[(0,s.wk)()],key:"_network",value:void 0},{kind:"field",decorators:[(0,s.wk)()],key:"_filter",value:void 0},{kind:"field",key:"_autoZoom",value:()=>!0},{kind:"field",key:"_enablePhysics",value:()=>!0},{kind:"method",key:"firstUpdated",value:function(e){(0,o.A)(t,"firstUpdated",this,3)([e]),this.zoomedDeviceIdFromURL&&(this.zoomedDeviceId=this.zoomedDeviceIdFromURL),this.hass&&this._fetchData(),this._network=new r.lg(this._visualization,{},{autoResize:!0,layout:{improvedLayout:!0},physics:{barnesHut:{springConstant:0,avoidOverlap:10,damping:.09}},nodes:{font:{multi:"html"}},edges:{smooth:{enabled:!0,type:"continuous",forceDirection:"none",roundness:.6}}}),this._network.on("doubleClick",(e=>{const i=e.nodes[0];if(i){const e=this._devices.get(i);e&&(0,l.o)(`/config/devices/device/${e.device_reg_id}`)}})),this._network.on("click",(e=>{const i=e.nodes[0];if(i){const e=this._devices.get(i);e&&this._autoZoom&&(this.zoomedDeviceId=e.device_reg_id,this._zoomToDevice())}})),this._network.on("stabilized",(()=>{this.zoomedDeviceId&&this._zoomToDevice()}))}},{kind:"method",key:"render",value:function(){return n.qy` <hass-tabs-subpage .tabs="${c.zhaTabs}" .hass="${this.hass}" .narrow="${this.narrow}" .isWide="${this.isWide}" .route="${this.route}" .header="${this.hass.localize("ui.panel.config.zha.visualization.header")}"> ${this.narrow?n.qy` <div slot="header"> <search-input .hass="${this.hass}" class="header" @value-changed="${this._handleSearchChange}" .filter="${this._filter}" .label="${this.hass.localize("ui.panel.config.zha.visualization.highlight_label")}"> </search-input> </div> `:""} <div class="header"> ${this.narrow?"":n.qy`<search-input .hass="${this.hass}" @value-changed="${this._handleSearchChange}" .filter="${this._filter}" .label="${this.hass.localize("ui.panel.config.zha.visualization.highlight_label")}"></search-input>`} <ha-device-picker .hass="${this.hass}" .value="${this.zoomedDeviceId}" .label="${this.hass.localize("ui.panel.config.zha.visualization.zoom_label")}" .deviceFilter="${this._filterDevices}" @value-changed="${this._onZoomToDevice}"></ha-device-picker> <div class="controls"> <ha-formfield .label="${this.hass.localize("ui.panel.config.zha.visualization.auto_zoom")}"> <ha-checkbox @change="${this._handleAutoZoomCheckboxChange}" .checked="${this._autoZoom}"> </ha-checkbox> </ha-formfield> <ha-formfield .label="${this.hass.localize("ui.panel.config.zha.visualization.enable_physics")}"><ha-checkbox @change="${this._handlePhysicsCheckboxChange}" .checked="${this._enablePhysics}"> </ha-checkbox></ha-formfield> <mwc-button @click="${this._refreshTopology}"> ${this.hass.localize("ui.panel.config.zha.visualization.refresh_topology")} </mwc-button> </div> </div> <div id="visualization"></div> </hass-tabs-subpage> `}},{kind:"method",key:"_fetchData",value:async function(){const e=await(0,d.Uc)(this.hass);this._devices=new Map(e.map((e=>[e.ieee,e]))),this._devicesByDeviceId=new Map(e.map((e=>[e.device_reg_id,e]))),this._updateDevices(e)}},{kind:"method",key:"_updateDevices",value:function(e){this._nodes=[];const i=[];e.forEach((e=>{this._nodes.push({id:e.ieee,label:this._buildLabel(e),shape:this._getShape(e),mass:this._getMass(e),color:{background:e.available?"#66FF99":"#FF9999"}}),e.neighbors&&e.neighbors.length>0&&e.neighbors.forEach((t=>{const a=i.findIndex((i=>e.ieee===i.to&&t.ieee===i.from));-1===a?i.push({from:e.ieee,to:t.ieee,label:t.lqi+"",color:this._getLQI(parseInt(t.lqi)).color,width:this._getLQI(parseInt(t.lqi)).width,length:2e3-4*parseInt(t.lqi),arrows:{from:{enabled:"Child"!==t.relationship}},dashes:"Child"!==t.relationship}):(i[a].color=this._getLQI((parseInt(i[a].label)+parseInt(t.lqi))/2).color,i[a].width=this._getLQI((parseInt(i[a].label)+parseInt(t.lqi))/2).width,i[a].length=2e3-(parseInt(i[a].label)+parseInt(t.lqi))/2*6,i[a].label+="/"+t.lqi,delete i[a].arrows,delete i[a].dashes)}))})),this._network?.setData({nodes:this._nodes,edges:i})}},{kind:"method",key:"_getLQI",value:function(e){return e>192?{color:{color:"#17ab00",highlight:"#17ab00"},width:4}:e>128?{color:{color:"#e6b402",highlight:"#e6b402"},width:3}:e>80?{color:{color:"#fc4c4c",highlight:"#fc4c4c"},width:2}:{color:{color:"#bfbfbf",highlight:"#bfbfbf"},width:1}}},{kind:"method",key:"_getMass",value:function(e){return e.available?"Coordinator"===e.device_type?2:"Router"===e.device_type?4:5:6}},{kind:"method",key:"_getShape",value:function(e){return"Coordinator"===e.device_type?"box":"Router"===e.device_type?"ellipse":"circle"}},{kind:"method",key:"_buildLabel",value:function(e){let i=null!==e.user_given_name?`<b>${e.user_given_name}</b>\n`:"";return i+=`<b>IEEE: </b>${e.ieee}`,i+=`\n<b>Device Type: </b>${e.device_type.replace("_"," ")}`,null!=e.nwk&&(i+=`\n<b>NWK: </b>${(0,h.b9)(e.nwk)}`),null!=e.manufacturer&&null!=e.model?i+=`\n<b>Device: </b>${e.manufacturer} ${e.model}`:i+="\n<b>Device is not in <i>'zigbee.db'</i></b>",e.area_id&&(i+=`\n<b>Area ID: </b>${e.area_id}`),i}},{kind:"method",key:"_handleSearchChange",value:function(e){this._filter=e.detail.value;const i=this._filter.toLowerCase();if(this._network)if(this._filter){const e=[];this._nodes.forEach((t=>{t.label&&t.label.toLowerCase().includes(i)&&e.push(t.id)})),this.zoomedDeviceId="",this._zoomOut(),this._network.selectNodes(e,!0)}else this._network.unselectAll()}},{kind:"method",key:"_onZoomToDevice",value:function(e){e.stopPropagation(),this.zoomedDeviceId=e.detail.value,this._network&&this._zoomToDevice()}},{kind:"method",key:"_zoomToDevice",value:function(){if(this._filter="",this.zoomedDeviceId){const e=this._devicesByDeviceId.get(this.zoomedDeviceId);e&&this._network.fit({nodes:[e.ieee],animation:{duration:500,easingFunction:"easeInQuad"}})}else this._zoomOut()}},{kind:"method",key:"_zoomOut",value:function(){this._network.fit({nodes:[],animation:{duration:500,easingFunction:"easeOutQuad"}})}},{kind:"method",key:"_refreshTopology",value:async function(){await(0,d.xU)(this.hass)}},{kind:"field",key:"_filterDevices",value(){return e=>{if(!this.hass)return!1;for(const i of e.identifiers)for(const e of i)if("zha"===e)return!0;return!1}}},{kind:"method",key:"_handleAutoZoomCheckboxChange",value:function(e){this._autoZoom=e.target.checked}},{kind:"method",key:"_handlePhysicsCheckboxChange",value:function(e){this._enablePhysics=e.target.checked,this._network.setOptions(this._enablePhysics?{physics:{barnesHut:{springConstant:0,avoidOverlap:10,damping:.09}}}:{physics:!1})}},{kind:"get",static:!0,key:"styles",value:function(){return[n.AH`.header{border-bottom:1px solid var(--divider-color);padding:0 8px;display:flex;align-items:center;justify-content:space-between;height:var(--header-height);box-sizing:border-box}.header>*{padding:0 8px}:host([narrow]) .header{flex-direction:column;align-items:stretch;height:var(--header-height) * 2}.search-toolbar{display:flex;align-items:center;color:var(--secondary-text-color);padding:0 16px}search-input{flex:1;display:block}search-input.header{color:var(--secondary-text-color)}ha-device-picker{flex:1}.controls{display:flex;align-items:center;justify-content:space-between}#visualization{height:calc(100% - var(--header-height));width:100%}:host([narrow]) #visualization{height:calc(100% - (var(--header-height) * 2))}`]}}]}}),n.WF)}};
//# sourceMappingURL=23054.XOL-hUll8hs.js.map