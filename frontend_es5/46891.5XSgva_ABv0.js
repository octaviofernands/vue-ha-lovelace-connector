"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[46891],{86134:function(t,e,n){n.d(e,{X:function(){return i}});var i=5},40995:function(t,e,n){n.d(e,{a:function(){return c}});var i=n(41981),r=(n(13025),n(97741),n(89655),n(46469),n(29193),n(49445),n(39790),n(28552),n(7760),n(253),n(2075),n(54846),n(16891),n(37679),n(66555),n(86134)),o=function(t){return t.reduce((function(t,e){return t+parseFloat(e.state)}),0)/t.length},a=function(t){return parseFloat(t[t.length-1].state)||0},s=function(t,e,n,s,c){t.forEach((function(t){t.state=Number(t.state)})),t=t.filter((function(t){return!Number.isNaN(t.state)}));var u=void 0!==(null==c?void 0:c.min)?c.min:Math.min.apply(Math,(0,i.A)(t.map((function(t){return t.state})))),d=void 0!==(null==c?void 0:c.max)?c.max:Math.max.apply(Math,(0,i.A)(t.map((function(t){return t.state})))),h=(new Date).getTime(),l=function(t,n,i){var r=h-new Date(n.last_changed).getTime(),o=Math.abs(r/36e5-e);return i?(o=60*(o-Math.floor(o)),o=Number((10*Math.round(o/10)).toString()[0])):o=Math.floor(o),t[o]||(t[o]=[]),t[o].push(n),t};if(t=t.reduce((function(t,e){return l(t,e,!1)}),[]),s>1&&(t=t.map((function(t){return t.reduce((function(t,e){return l(t,e,!0)}),[])}))),t.length)return function(t,e,n,i,s,c){var u=[],d=(c-s)/80;d=0!==d?d:80;var h=n/(e-(1===i?1:0));h=isFinite(h)?h:n;var l=t.filter(Boolean)[0];i>1&&(l=l.filter(Boolean)[0]);for(var f=[o(l),a(l)],v=function(t){return 80+r.X/2-(t-s)/d},_=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(i>1&&t)return t.forEach((function(t,n){return _(t,e,n,i-1)}));var r=h*(e+n/6);t&&(f=[o(t),a(t)]);var s=v(t?f[0]:f[1]);return u.push([r,s])},k=0;k<t.length;k+=1)_(t[k],k,0,i);return u.push([n,v(f[1])]),u}(t,e,n,s,u,d)},c=function(t,e,n,i,r){if(t){var o=t.map((function(t){return{state:Number(t.s),last_changed:1e3*t.lu}}));return s(o,e,n,i,r)}}},34694:function(t,e,n){var i,r,o,a,s=n(64599),c=n(35806),u=n(71008),d=n(62193),h=n(2816),l=n(27927),f=(n(81027),n(50289)),v=n(29818),_=n(86134),k=n(64782);n(13025),n(39790),n(253),n(2075),(0,l.A)([(0,v.EM)("hui-graph-base")],(function(t,e){var n=function(e){function n(){var e;(0,u.A)(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e=(0,d.A)(this,n,[].concat(r)),t(e),e}return(0,h.A)(n,e),(0,c.A)(n)}(e);return{F:n,d:[{kind:"field",decorators:[(0,v.MZ)()],key:"coordinates",value:void 0},{kind:"field",decorators:[(0,v.wk)()],key:"_path",value:void 0},{kind:"method",key:"render",value:function(){return(0,f.qy)(i||(i=(0,s.A)([" "," "])),this._path?(0,f.JW)(r||(r=(0,s.A)(['<svg width="100%" height="100%" viewBox="0 0 500 100"> <g> <mask id="fill"> <path class="fill" fill="white" d="',' L 500, 100 L 0, 100 z"/> </mask> <rect height="100%" width="100%" id="fill-rect" fill="var(--accent-color)" mask="url(#fill)"></rect> <mask id="line"> <path fill="none" stroke="var(--accent-color)" stroke-width="','" stroke-linecap="round" stroke-linejoin="round" d="','"></path> </mask> <rect height="100%" width="100%" id="rect" fill="var(--accent-color)" mask="url(#line)"></rect> </g> </svg>'])),this._path,_.X,this._path):(0,f.JW)(o||(o=(0,s.A)(['<svg width="100%" height="100%" viewBox="0 0 500 100"></svg>']))))}},{kind:"method",key:"willUpdate",value:function(t){this.coordinates&&t.has("coordinates")&&(this._path=function(t){if(!t.length)return"";var e,n,i="",r=t.filter(Boolean)[0];i+="M ".concat(r[0],",").concat(r[1]);var o,a,s,c,u,d=(0,k.A)(t);try{for(d.s();!(o=d.n()).done;)e=o.value,a=r[0],s=r[1],c=e[0],u=e[1],i+=" ".concat((n=[(a-c)/2+c,(s-u)/2+u])[0],",").concat(n[1]),i+=" Q".concat(e[0],",").concat(e[1]),r=e}catch(h){d.e(h)}finally{d.f()}return i+" ".concat(e[0],",").concat(e[1])}(this.coordinates))}},{kind:"get",static:!0,key:"styles",value:function(){return(0,f.AH)(a||(a=(0,s.A)([":host{display:flex;width:100%}.fill{opacity:.1}"])))}}]}}),f.WF)},69272:function(t,e,n){var i=n(22858).A,r=n(33994).A;n.a(t,function(){var t=i(r().mark((function t(i,o){var a,s,c,u,d,h,l,f,v,_,k,p,y,g,b,m,w,A,x,M,N,C,H,F,E,B,q,I,S,T,W,j,z,G,X;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.r(e),n.d(e,{HuiGraphHeaderFooter:function(){return X}}),a=n(41981),s=n(64599),c=n(33994),u=n(22858),d=n(35806),h=n(71008),l=n(62193),f=n(2816),v=n(27927),_=n(35890),k=n(71499),p=n(81027),y=n(82386),g=n(95737),b=n(29193),m=n(26098),w=n(39790),A=n(66457),x=n(99019),M=n(96858),N=n(50289),C=n(29818),H=n(33922),F=n(213),n(32885),E=n(11630),B=n(18102),q=n(40995),n(34694),!(I=i([E])).then){t.next=50;break}return t.next=46,I;case 46:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=51;break;case 50:t.t0=I;case 51:E=t.t0[0],G=["counter","input_number","number","sensor"],X=(0,v.A)([(0,C.EM)("hui-graph-header-footer")],(function(t,e){var i,r=function(e){function n(){var e;(0,h.A)(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e=(0,l.A)(this,n,[].concat(r)),t(e),e}return(0,f.A)(n,e),(0,d.A)(n)}(e);return{F:r,d:[{kind:"method",static:!0,key:"getConfigElement",value:(i=(0,u.A)((0,c.A)().mark((function t(){return(0,c.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e(96333).then(n.bind(n,96333));case 2:return t.abrupt("return",document.createElement("hui-graph-footer-editor"));case 3:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{kind:"method",static:!0,key:"getStubConfig",value:function(t,e,n){return{type:"graph",entity:(0,B.B)(t,1,e,n,G,(function(t){return!isNaN(Number(t.state))&&!!t.attributes.unit_of_measurement}))[0]||""}}},{kind:"field",decorators:[(0,C.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,C.MZ)()],key:"type",value:void 0},{kind:"field",decorators:[(0,C.wk)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,C.wk)()],key:"_coordinates",value:void 0},{kind:"field",key:"_error",value:void 0},{kind:"field",key:"_interval",value:void 0},{kind:"field",key:"_subscribed",value:void 0},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){if(null==t||!t.entity||!G.includes((0,F.m)(t.entity)))throw new Error("Specify an entity from within the sensor domain");var e=Object.assign({detail:1,hours_to_show:24},t);e.hours_to_show=Number(e.hours_to_show),e.detail=1===e.detail||2===e.detail?e.detail:1,this._config=e}},{kind:"method",key:"render",value:function(){return this._config&&this.hass?this._error?(0,N.qy)(S||(S=(0,s.A)(['<div class="errors">',"</div>"])),this._error):this._coordinates?this._coordinates.length?(0,N.qy)(j||(j=(0,s.A)([' <hui-graph-base .coordinates="','"></hui-graph-base> '])),this._coordinates):(0,N.qy)(W||(W=(0,s.A)([' <div class="container"> <div class="info">No state history found.</div> </div> ']))):(0,N.qy)(T||(T=(0,s.A)([' <div class="container"> <ha-circular-progress indeterminate size="small"></ha-circular-progress> </div> ']))):N.s6}},{kind:"method",key:"connectedCallback",value:function(){(0,_.A)(r,"connectedCallback",this,3)([]),this.hasUpdated&&this._config&&this._subscribeHistory()}},{kind:"method",key:"disconnectedCallback",value:function(){(0,_.A)(r,"disconnectedCallback",this,3)([]),this._unsubscribeHistory()}},{kind:"method",key:"_subscribeHistory",value:function(){var t=this;(0,H.x)(this.hass,"history")&&!this._subscribed&&this._config&&(this._subscribed=(0,E.IQ)(this.hass,(function(e){t._subscribed&&t._config&&(t._coordinates=(0,q.a)(e[t._config.entity],t._config.hours_to_show,500,t._config.detail,t._config.limits)||[])}),this._config.hours_to_show,[this._config.entity]).catch((function(e){t._subscribed=void 0,t._error=e})),this._setRedrawTimer())}},{kind:"method",key:"_redrawGraph",value:function(){this._coordinates&&(this._coordinates=(0,a.A)(this._coordinates))}},{kind:"method",key:"_setRedrawTimer",value:function(){var t=this;clearInterval(this._interval),this._interval=window.setInterval((function(){return t._redrawGraph()}),this._config.hours_to_show>24?36e5:6e4)}},{kind:"method",key:"_unsubscribeHistory",value:function(){clearInterval(this._interval),this._subscribed&&(this._subscribed.then((function(t){return null==t?void 0:t()})),this._subscribed=void 0)}},{kind:"method",key:"updated",value:function(t){if(this._config&&this.hass&&t.has("_config")){var e=t.get("_config");e&&this._subscribed&&e.entity===this._config.entity||(this._unsubscribeHistory(),this._subscribeHistory())}}},{kind:"get",static:!0,key:"styles",value:function(){return(0,N.AH)(z||(z=(0,s.A)(["ha-circular-progress{position:absolute;top:calc(50% - 14px)}.container{display:flex;justify-content:center;position:relative;padding-bottom:20%}.info{position:absolute;top:calc(50% - 16px);color:var(--secondary-text-color)}"])))}}]}}),N.WF),o(),t.next=62;break;case 59:t.prev=59,t.t2=t.catch(0),o(t.t2);case 62:case"end":return t.stop()}}),t,null,[[0,59]])})));return function(e,n){return t.apply(this,arguments)}}())}}]);
//# sourceMappingURL=46891.5XSgva_ABv0.js.map