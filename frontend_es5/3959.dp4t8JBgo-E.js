/*! For license information please see 3959.dp4t8JBgo-E.js.LICENSE.txt */
"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[3959],{46999:function(t,e,a){a.d(e,{Vy:function(){return r},fI:function(){return s}});var i=a(45253),n=["#44739e","#984ea3","#00d2d5","#ff7f00","#af8d00","#7f80cd","#b3e900","#c42e60","#a65628","#f781bf","#8dd3c7","#bebada","#fb8072","#80b1d3","#fdb462","#fccde5","#bc80bd","#ffed6f","#c4eaff","#cf8c00","#1b9e77","#d95f02","#e7298a","#e6ab02","#a6761d","#0097ff","#00d067","#f43600","#4ba93b","#5779bb","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function r(t){return n[t%n.length]}function s(t,e){var a=e.getPropertyValue("--graph-color-".concat(t+1))||r(t);return(0,i.RQ)(a)}},20732:function(t,e,a){a.d(e,{Z:function(){return i}});var i=function(t){var e=window.location.pathname;return t?e+"?"+t:e}},73207:function(t,e,a){a.d(e,{c:function(){return f}});a(95737),a(33822),a(39790),a(99019),a(96858);var i=a(46999),n=a(45253),r=a(92164),s=a(213),o=a(95239),c=a(9883),d=a(61352),l={media_player:{paused:.5,idle:1},vacuum:{returning:.5}};var u=0,h=new Map;function f(t,e,a){return function(t,e,a){var i;if(!a||t===c.Hh)return(0,d.a)("--history-unavailable-color",e);if(t===c.HV)return(0,d.a)("--history-unknown-color",e);var u=(0,o.mg)(a,t);if(u){var h=(0,d.a)(u,e);if(h){var f=(0,s.m)(a.entity_id),v=null===(i=l[f])||void 0===i?void 0:i[t];return v?(0,n.zm)((0,r.T)((0,n.Nc)((0,n.xp)(h)),v)):h}}}(t,e,a)||function(t,e){if(h.has(t))return h.get(t);var a=(0,i.fI)(u,e);return u++,h.set(t,a),a}(t,e)}},57216:function(t,e,a){a.d(e,{A_:function(){return s},SJ:function(){return i},mQ:function(){return r},n6:function(){return n}});a(26098);var i=function(t){return t.callWS({type:"lovelace/dashboards/list"})},n=function(t,e){return t.callWS(Object.assign({type:"lovelace/dashboards/create"},e))},r=function(t,e,a){return t.callWS(Object.assign({type:"lovelace/dashboards/update",dashboard_id:e},a))},s=function(t,e){return t.callWS({type:"lovelace/dashboards/delete",dashboard_id:e})}},11577:function(t,e,a){var i=a(22858).A,n=a(33994).A;a.a(t,function(){var t=i(n().mark((function t(i,r){var s,o,c,d,l,u,h,f,v,_,g,p,y,k,b,m,w,A,x,H,D,C,V,L,P,S,E,I,M,z,j,O,q,R,T,Z,Q,U,B,W,F,J,K,X,Y,N,G,$,tt,et,at,it,nt,rt,st,ot,ct,dt,lt,ut,ht,ft,vt,_t,gt,pt,yt,kt,bt,mt,wt,At,xt,Ht,Dt,Ct,Vt,Lt,Pt,St,Et,It,Mt,zt;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a.r(e),s=a(33994),o=a(658),c=a(22858),d=a(41981),l=a(64782),u=a(64599),h=a(35806),f=a(71008),v=a(62193),_=a(2816),g=a(27927),p=a(35890),y=a(81027),k=a(44124),b=a(52427),m=a(95737),w=a(79243),A=a(97741),x=a(89655),H=a(33231),D=a(26098),C=a(99471),V=a(10507),L=a(39790),P=a(9241),S=a(36016),E=a(98185),I=a(7760),M=a(74268),z=a(24545),j=a(51855),O=a(82130),q=a(31743),R=a(22328),T=a(4959),Z=a(62435),Q=a(99019),U=a(43037),B=a(63523),W=a(253),F=a(94438),J=a(54846),K=a(16891),X=a(66555),Y=a(96858),N=a(84341),G=a(49365),$=a(38389),tt=a(74860),et=a(71011),at=a(71174),it=a(6711),nt=a(50289),rt=a(29818),st=a(94100),ot=a(21863),ct=a(96979),dt=a(213),lt=a(16312),ut=a(20732),ht=a(56932),ft=a(90701),vt=a(4159),a(32885),_t=a(9043),a(4169),a(26790),a(13830),a(45346),a(11804),gt=a(4736),a(94110),pt=a(11630),yt=a(4826),kt=a(29829),bt=a(96778),mt=a(6121),wt=a(55321),At=a(30489),xt=a(7950),!(Ht=i([vt,_t,gt,pt])).then){t.next=129;break}return t.next=125,Ht;case 125:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=130;break;case 129:t.t0=Ht;case 130:Dt=t.t0,vt=Dt[0],_t=Dt[1],gt=Dt[2],pt=Dt[3],zt=(0,g.A)(null,(function(t,e){var a,i,n,r=function(e){function a(){var e;(0,f.A)(this,a),e=(0,v.A)(this,a),t(e);var i=new Date;i.setHours(i.getHours()-1,0,0,0),e._startDate=i;var n=new Date;return n.setHours(n.getHours()+2,0,0,0),e._endDate=n,e}return(0,_.A)(a,e),(0,h.A)(a)}(e);return{F:r,d:[{kind:"field",decorators:[(0,rt.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,rt.MZ)({reflect:!0,type:Boolean})],key:"narrow",value:function(){return!1}},{kind:"field",decorators:[(0,rt.MZ)({reflect:!0,type:Boolean})],key:"rtl",value:function(){return!1}},{kind:"field",decorators:[(0,rt.wk)()],key:"_startDate",value:void 0},{kind:"field",decorators:[(0,rt.wk)()],key:"_endDate",value:void 0},{kind:"field",decorators:[(0,ct.I)({key:"historyPickedValue",state:!0,subscribe:!1})],key:"_targetPickerValue",value:function(){return{}}},{kind:"field",decorators:[(0,rt.wk)()],key:"_isLoading",value:function(){return!1}},{kind:"field",decorators:[(0,rt.wk)()],key:"_stateHistory",value:void 0},{kind:"field",key:"_mungedStateHistory",value:void 0},{kind:"field",decorators:[(0,rt.wk)()],key:"_statisticsHistory",value:void 0},{kind:"field",decorators:[(0,rt.wk)()],key:"_showBack",value:void 0},{kind:"field",decorators:[(0,rt.P)("state-history-charts")],key:"_stateHistoryCharts",value:void 0},{kind:"field",key:"_subscribed",value:void 0},{kind:"field",key:"_interval",value:void 0},{kind:"method",key:"connectedCallback",value:function(){(0,p.A)(r,"connectedCallback",this,3)([]),this.hasUpdated&&this._getHistory()}},{kind:"method",key:"disconnectedCallback",value:function(){(0,p.A)(r,"disconnectedCallback",this,3)([]),this._unsubscribeHistory()}},{kind:"method",key:"_goBack",value:function(){history.back()}},{kind:"method",key:"render",value:function(){var t=this._getEntityIds().length>0;return(0,nt.qy)(Ct||(Ct=(0,u.A)([" <ha-top-app-bar-fixed> ",' <div slot="title">',"</div> ",' <ha-button-menu slot="actionItems" @action="','"> <ha-icon-button slot="trigger" .label="','" .path="','"></ha-icon-button> <ha-list-item graphic="icon" .disabled="','"> ',' <ha-svg-icon slot="graphic" .path="','"></ha-svg-icon> </ha-list-item> <ha-list-item graphic="icon" .disabled="','"> ',' <ha-svg-icon slot="graphic" .path="','"></ha-svg-icon> </ha-list-item> </ha-button-menu> <div class="flex content"> <div class="filters"> <ha-date-range-picker .hass="','" ?disabled="','" .startDate="','" .endDate="','" extendedPresets @change="','"></ha-date-range-picker> <ha-target-picker .hass="','" .value="','" .disabled="','" addOnTop @value-changed="','"></ha-target-picker> </div> '," </div> </ha-top-app-bar-fixed> "])),this._showBack?(0,nt.qy)(Vt||(Vt=(0,u.A)([' <ha-icon-button-arrow-prev slot="navigationIcon" @click="','"></ha-icon-button-arrow-prev> '])),this._goBack):(0,nt.qy)(Lt||(Lt=(0,u.A)([' <ha-menu-button slot="navigationIcon" .hass="','" .narrow="','"></ha-menu-button> '])),this.hass,this.narrow),this.hass.localize("panel.history"),t?(0,nt.qy)(Pt||(Pt=(0,u.A)([' <ha-icon-button slot="actionItems" @click="','" .disabled="','" .path="','" .label="','"></ha-icon-button> '])),this._removeAll,this._isLoading,"M14.76,20.83L17.6,18L14.76,15.17L16.17,13.76L19,16.57L21.83,13.76L23.24,15.17L20.43,18L23.24,20.83L21.83,22.24L19,19.4L16.17,22.24L14.76,20.83M12,12V19.88C12.04,20.18 11.94,20.5 11.71,20.71C11.32,21.1 10.69,21.1 10.3,20.71L8.29,18.7C8.06,18.47 7.96,18.16 8,17.87V12H7.97L2.21,4.62C1.87,4.19 1.95,3.56 2.38,3.22C2.57,3.08 2.78,3 3,3V3H17V3C17.22,3 17.43,3.08 17.62,3.22C18.05,3.56 18.13,4.19 17.79,4.62L12.03,12H12Z",this.hass.localize("ui.panel.history.remove_all")):"",this._handleMenuAction,this.hass.localize("ui.common.menu"),"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",this._isLoading,this.hass.localize("ui.panel.history.download_data"),"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z",this._isLoading,this.hass.localize("ui.panel.history.add_card"),"M18 15V18H15V20H18V23H20V20H23V18H20V15H18M13.3 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3H19C20.1 3 21 3.9 21 5V13.3C20.4 13.1 19.7 13 19 13C17.9 13 16.8 13.3 15.9 13.9L14.5 12L11 16.5L8.5 13.5L5 18H13.1C13 18.3 13 18.7 13 19C13 19.7 13.1 20.4 13.3 21Z",this.hass,this._isLoading,this._startDate,this._endDate,this._dateRangeChanged,this.hass,this._targetPickerValue,this._isLoading,this._targetsChanged,this._isLoading?(0,nt.qy)(St||(St=(0,u.A)(['<div class="progress-wrapper"> <ha-circular-progress indeterminate></ha-circular-progress> </div>']))):t?(0,nt.qy)(It||(It=(0,u.A)([' <state-history-charts .hass="','" .historyData="','" .startTime="','" .endTime="','"> </state-history-charts> '])),this.hass,this._mungedStateHistory,this._startDate,this._endDate):(0,nt.qy)(Et||(Et=(0,u.A)(['<div class="start-search"> '," </div>"])),this.hass.localize("ui.panel.history.start_search")))}},{kind:"method",key:"mergeHistoryResults",value:function(t,e){var a,i=Object.assign(Object.assign({},e),{},{line:[]}),n={},r=(0,l.A)(e.line);try{for(r.s();!(a=r.n()).done;){var s=a.value,o=(0,pt.qc)(s.unit,s.device_class,!0);o&&(n[o]={historyItem:s})}}catch(x){r.e(x)}finally{r.f()}var c,u=(0,l.A)(t.line);try{for(u.s();!(c=u.n()).done;){var h=c.value,f=(0,pt.qc)(h.unit,h.device_class,!0);f&&(f in n?n[f].ltsItem=h:n[f]={ltsItem:h})}}catch(x){u.e(x)}finally{u.f()}for(var v=0,_=Object.values(n);v<_.length;v++){var g=_[v],p=g.historyItem,y=g.ltsItem;if(p&&y){var k,b=Object.assign(Object.assign({},p),{},{data:[]}),m=new Set([].concat((0,d.A)(p.data.map((function(t){return t.entity_id}))),(0,d.A)(y.data.map((function(t){return t.entity_id}))))),w=(0,l.A)(m);try{var A=function(){var t,e=k.value,a=p.data.find((function(t){return t.entity_id===e})),i=y.data.find((function(t){return t.entity_id===e}));if(!a||!i)return b.data.push(a||i),1;var n,r=(null===(t=a.states[0])||void 0===t?void 0:t.last_changed)||i.statistics[i.statistics.length-1].last_changed+1,s=[],o=(0,l.A)(i.statistics);try{for(o.s();!(n=o.n()).done;){var c=n.value;if(c.last_changed>=r)break;s.push(c)}}catch(x){o.e(x)}finally{o.f()}b.data.push(0===s.length?a:Object.assign(Object.assign({},a),{},{statistics:s}))};for(w.s();!(k=w.n()).done;)A()}catch(x){w.e(x)}finally{w.f()}i.line.push(b)}else i.line.push(p||y)}return i}},{kind:"method",key:"willUpdate",value:function(t){if((0,p.A)(r,"willUpdate",this,3)([t]),(t.has("_stateHistory")||t.has("_statisticsHistory")||t.has("_startDate")||t.has("_endDate")||t.has("_targetPickerValue"))&&(this._statisticsHistory&&this._stateHistory?this._mungedStateHistory=this.mergeHistoryResults(this._statisticsHistory,this._stateHistory):this._mungedStateHistory=this._stateHistory||this._statisticsHistory),!this.hasUpdated){var e=(0,ht.px)(),a=e.entity_id,i=e.device_id,n=e.area_id,s=e.floor_id,o=e.label_id;if((a||i||n||s||o)&&(this._targetPickerValue={}),a){var c=a.split(",");this._targetPickerValue.entity_id=c}if(i){var d=i.split(",");this._targetPickerValue.device_id=d}if(n){var l=n.split(",");this._targetPickerValue.area_id=l}if(s){var u=s.split(",");this._targetPickerValue.floor_id=u}if(o){var h=o.split(",");this._targetPickerValue.label_id=h}var f=e.start_date;f&&(this._startDate=new Date(f));var v=e.end_date;v&&(this._endDate=new Date(v))}}},{kind:"method",key:"firstUpdated",value:function(t){(0,p.A)(r,"firstUpdated",this,3)([t]),"1"===(0,ht.px)().back&&history.length>1&&(this._showBack=!0,(0,lt.o)((0,ut.Z)((0,ht.s8)("back")),{replace:!0}))}},{kind:"method",key:"updated",value:function(t){(t.has("_startDate")||t.has("_endDate")||t.has("_targetPickerValue")||!this._stateHistory&&(t.has("_deviceEntityLookup")||t.has("_areaEntityLookup")||t.has("_areaDeviceLookup")))&&(this._getHistory(),this._getStats())}},{kind:"method",key:"_removeAll",value:function(){this._targetPickerValue={},this._updatePath()}},{kind:"method",key:"_getStats",value:(n=(0,c.A)((0,s.A)().mark((function t(){var e,a,i,n,r,c,d;return(0,s.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==(a=this._getEntityIds()).length){t.next=4;break}return this._statisticsHistory=void 0,t.abrupt("return");case 4:return t.next=6,(0,yt.sz)(this.hass,this._startDate,this._endDate,a,"hour",void 0,["mean","state"]);case 6:return i=t.sent,n={},a.forEach((function(t){t in i&&(n[t]=i[t])})),r={},Object.entries(n).forEach((function(t){var e=(0,o.A)(t,2),a=e[0],i=e[1].map((function(t){return{s:null!=t.mean?t.mean.toString():t.state.toString(),lc:t.start/1e3,a:{},lu:t.start/1e3}}));r[a]=i})),t.next=13,(0,bt.KL)(this.hass);case 13:c=t.sent,d=c.numeric_device_classes,this._statisticsHistory=(0,pt.Mm)(this.hass,r,[],this.hass.localize,d,!0,!0),((null===(e=this._statisticsHistory)||void 0===e?void 0:e.line)||[]).forEach((function(t){t.data.forEach((function(t){t.statistics=t.states,t.states=[]}))}));case 17:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{kind:"method",key:"_getHistory",value:(i=(0,c.A)((0,s.A)().mark((function t(){var e,a,i,n,r=this;return(0,s.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==(e=this._getEntityIds()).length){t.next=4;break}return this._stateHistory=void 0,t.abrupt("return");case 4:return this._isLoading=!0,this._subscribed&&this._unsubscribeHistory(),a=new Date,t.next=9,(0,bt.KL)(this.hass);case 9:i=t.sent,n=i.numeric_device_classes,this._subscribed=(0,pt.Jo)(this.hass,(function(t){r._isLoading=!1,r._stateHistory=(0,pt.Mm)(r.hass,t,e,r.hass.localize,n,!0)}),this._startDate,this._endDate,e),this._subscribed.catch((function(){r._isLoading=!1,r._unsubscribeHistory()})),this._endDate>a&&this._setRedrawTimer();case 14:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{kind:"method",key:"_setRedrawTimer",value:function(){var t=this;clearInterval(this._interval);var e=new Date,a=this._endDate>e?e:this._endDate,i=(0,it.M)(a,this._startDate);this._interval=window.setInterval((function(){var e;return null===(e=t._stateHistoryCharts)||void 0===e?void 0:e.requestUpdate()}),i<2?1e4:i<10?6e4:ft.p)}},{kind:"method",key:"_unsubscribeHistory",value:function(){this._interval&&(clearInterval(this._interval),this._interval=void 0),this._subscribed&&(this._subscribed.then((function(t){return null==t?void 0:t()})),this._subscribed=void 0)}},{kind:"method",key:"_getEntityIds",value:function(){return this.__getEntityIds(this._targetPickerValue,this.hass.entities,this.hass.devices,this.hass.areas)}},{kind:"field",key:"__getEntityIds",value:function(){var t=this;return(0,st.A)((function(e,a,i,n){if(!e)return[];var r={target:{}},s=new Set((0,ot.e)(e.entity_id)),o=new Set((0,ot.e)(e.device_id)),c=new Set((0,ot.e)(e.area_id)),d=new Set((0,ot.e)(e.floor_id));return new Set((0,ot.e)(e.label_id)).forEach((function(e){var d=(0,kt.m0)(t.hass,e,n,i,a,r);d.devices.forEach((function(t){return o.add(t)})),d.entities.forEach((function(t){return s.add(t)})),d.areas.forEach((function(t){return c.add(t)}))})),d.forEach((function(e){(0,kt.MH)(t.hass,e,n,r).areas.forEach((function(t){return c.add(t)}))})),c.forEach((function(e){var n=(0,kt.bZ)(t.hass,e,i,a,r);n.devices.forEach((function(t){return o.add(t)})),n.entities.forEach((function(t){return s.add(t)}))})),o.forEach((function(e){(0,kt._7)(t.hass,e,a,r).entities.forEach((function(t){return s.add(t)}))})),Array.from(s)}))}},{kind:"method",key:"_dateRangeChanged",value:function(t){this._startDate=t.detail.startDate;var e=t.detail.endDate;0===e.getHours()&&0===e.getMinutes()&&(e.setDate(e.getDate()+1),e.setMilliseconds(e.getMilliseconds()-1)),this._endDate=e,this._updatePath()}},{kind:"method",key:"_targetsChanged",value:function(t){this._targetPickerValue=t.detail.value||{},this._updatePath()}},{kind:"method",key:"_updatePath",value:function(){var t={};this._targetPickerValue.entity_id&&(t.entity_id=(0,ot.e)(this._targetPickerValue.entity_id).join(",")),this._targetPickerValue.label_id&&(t.label_id=(0,ot.e)(this._targetPickerValue.label_id).join(",")),this._targetPickerValue.floor_id&&(t.floor_id=(0,ot.e)(this._targetPickerValue.floor_id).join(",")),this._targetPickerValue.area_id&&(t.area_id=(0,ot.e)(this._targetPickerValue.area_id).join(",")),this._targetPickerValue.device_id&&(t.device_id=(0,ot.e)(this._targetPickerValue.device_id).join(",")),this._startDate&&(t.start_date=this._startDate.toISOString()),this._endDate&&(t.end_date=this._endDate.toISOString()),(0,lt.o)("/history?".concat((0,ht.KH)(t)),{replace:!0})}},{kind:"method",key:"_handleMenuAction",value:(a=(0,c.A)((0,s.A)().mark((function t(e){return(0,s.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e.detail.index,t.next=0===t.t0?3:1===t.t0?5:7;break;case 3:return this._downloadHistory(),t.abrupt("break",7);case 5:return this._suggestCard(),t.abrupt("break",7);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{kind:"method",key:"_downloadHistory",value:function(){if(0!==(0,d.A)(this._getEntityIds()).sort().length&&this._mungedStateHistory){var t,e=[""],a=["entity_id","state","last_changed"],i=new Set,n={climate:{current_temperature:0,hvac_action:0,target_temp_high:0,target_temp_low:0,temperature:0},humidifier:{action:0,current_humidity:0,humidity:0},water_heater:{current_temperature:0,operation_mode:0,temperature:0}},r=function(t){return new Date(t).toISOString()},s=(0,l.A)(this._mungedStateHistory.line);try{for(s.s();!(t=s.n()).done;){var c,u=t.value,h=(0,l.A)(u.data);try{for(h.s();!(c=h.n()).done;){var f=c.value,v=f.entity_id,_=(0,dt.m)(v),g=n[_];if(g&&!i.has(_)){i.add(_);for(var p=a.length,y=0,k=Object.keys(g);y<k.length;y++){var b=k[y];a.push(b),g[b]=p,p+=1}}if(f.statistics){var m,w=(0,l.A)(f.statistics);try{for(w.s();!(m=w.n()).done;){var A=m.value;e.push("".concat(v,",").concat(A.state,",").concat(r(A.last_changed),"\n"))}}catch(W){w.e(W)}finally{w.f()}}var x,H=(0,l.A)(f.states);try{for(H.s();!(x=H.n()).done;){var D=x.value,C=r(D.last_changed),V=[v,D.state,C];if(D.attributes&&g)for(var L=D.attributes,P=0,S=Object.entries(g);P<S.length;P++){var E=(0,o.A)(S[P],2),I=E[0],M=E[1];I in L&&(V[M]=L[I])}e.push(V.join(",")+"\n")}}catch(W){H.e(W)}finally{H.f()}}}catch(W){h.e(W)}finally{h.f()}}}catch(W){s.e(W)}finally{s.f()}var z,j=(0,l.A)(this._mungedStateHistory.timeline);try{for(j.s();!(z=j.n()).done;){var O,q=z.value,R=q.entity_id,T=(0,l.A)(q.data);try{for(T.s();!(O=T.n()).done;){var Z=O.value,Q=/,|"/.test(Z.state)?'"'.concat(Z.state.replaceAll('"','""'),'"'):Z.state;e.push("".concat(R,",").concat(Q,",").concat(r(Z.last_changed),"\n"))}}catch(W){T.e(W)}finally{T.f()}}}catch(W){j.e(W)}finally{j.f()}e[0]=a.join(",")+"\n";var U=new Blob(e,{type:"text/csv"}),B=window.URL.createObjectURL(U);(0,At.R)(B,"history.csv")}else(0,mt.showAlertDialog)(this,{title:this.hass.localize("ui.panel.history.download_data_error"),text:this.hass.localize("ui.panel.history.error_no_data"),warning:!0})}},{kind:"method",key:"_suggestCard",value:function(){var t=this._getEntityIds();if(0!==t.length&&this._mungedStateHistory){var e=Math.min(this._endDate.getTime(),Date.now()),a=[{title:this.hass.localize("panel.history"),type:"history-graph",hours_to_show:Math.round((e-this._startDate.getTime())/1e3/60/60),entities:t}];(0,xt.Q)(this,this.hass,a,{title:this.hass.localize("panel.history"),cards:a},t)}else(0,mt.showAlertDialog)(this,{title:this.hass.localize("ui.panel.history.add_card_error"),text:this.hass.localize("ui.panel.history.error_no_data"),warning:!0})}},{kind:"get",static:!0,key:"styles",value:function(){return[wt.RF,(0,nt.AH)(Mt||(Mt=(0,u.A)([".content{padding:0 16px 16px;padding-bottom:max(env(safe-area-inset-bottom),16px)}:host([virtualize]){height:100%}.progress-wrapper{position:relative;display:flex;align-items:center;flex-direction:column;padding:16px}.filters{display:flex;align-items:flex-start;margin-top:16px}ha-date-range-picker{margin-right:16px;margin-inline-end:16px;margin-inline-start:initial;max-width:100%;direction:var(--direction)}@media all and (max-width:1025px){.filters{flex-direction:column}ha-date-range-picker{margin-right:0;margin-inline-end:0;margin-inline-start:initial;width:100%}}.start-search{padding-top:16px;text-align:center;color:var(--secondary-text-color)}"])))]}}]}}),nt.WF),customElements.define("ha-panel-history",zt),r(),t.next=147;break;case 144:t.prev=144,t.t2=t.catch(0),r(t.t2);case 147:case"end":return t.stop()}}),t,null,[[0,144]])})));return function(e,a){return t.apply(this,arguments)}}())},7950:function(t,e,a){a.d(e,{Q:function(){return u}});var i=a(33994),n=a(64782),r=a(22858),s=(a(13025),a(39790),a(253),a(2075),a(50118)),o=a(57216),c=a(6121),d=a(84048),l=a(45111),u=function(){var t=(0,r.A)((0,i.A)().mark((function t(e,a,u,h,f){var v,_,g,p,y,k,b,m,w,A;return(0,i.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.loadFragmentTranslation("lovelace"),t.next=3,(0,o.SJ)(a);case 3:if(g=t.sent,p=g.filter((function(t){return"storage"===t.mode})),"storage"===(y=null===(v=a.panels.lovelace)||void 0===v||null===(v=v.config)||void 0===v?void 0:v.mode)||p.length){t.next=9;break}return(0,d.Q)(e,{cardConfig:u,entities:f,yaml:!0}),t.abrupt("return");case 9:if(b=null,"storage"!==y){t.next=19;break}return t.prev=11,t.next=14,(0,s.Dz)(a.connection,null,!1);case 14:k=t.sent,t.next=19;break;case 17:t.prev=17,t.t0=t.catch(11);case 19:if(k||!p.length){t.next=45;break}m=(0,n.A)(p),t.prev=21,m.s();case 23:if((w=m.n()).done){t.next=37;break}return A=w.value,t.prev=25,t.next=28,(0,s.Dz)(a.connection,A.url_path,!1);case 28:return k=t.sent,b=A.url_path,t.abrupt("break",37);case 33:t.prev=33,t.t1=t.catch(25);case 35:t.next=23;break;case 37:t.next=42;break;case 39:t.prev=39,t.t2=t.catch(21),m.e(t.t2);case 42:return t.prev=42,m.f(),t.finish(42);case 45:if(k){t.next=48;break}return g.length>p.length?(0,d.Q)(e,{cardConfig:u,sectionConfig:h,entities:f,yaml:!0}):(0,c.showAlertDialog)(e,{text:"You don't seem to be in control of any dashboard, please take control first."}),t.abrupt("return");case 48:if(p.length||null!==(_=k.views)&&void 0!==_&&_.length){t.next=51;break}return(0,c.showAlertDialog)(e,{text:"You don't have any Lovelace views, first create a view in Lovelace."}),t.abrupt("return");case 51:if(p.length||1!==k.views.length){t.next=54;break}return(0,d.Q)(e,{cardConfig:u,sectionConfig:h,lovelaceConfig:k,saveConfig:function(){var t=(0,r.A)((0,i.A)().mark((function t(e){return(0,i.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,s.ql)(a,null,e);case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),alert(a.localize("ui.panel.lovelace.add_entities.saving_failed"));case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e){return t.apply(this,arguments)}}(),path:[0],entities:f}),t.abrupt("return");case 54:(0,l.X)(e,{lovelaceConfig:k,urlPath:b,allowDashboardChange:!0,actionLabel:a.localize("ui.common.next"),dashboards:g,viewSelectedCallback:function(t,n,o){var c;(0,d.Q)(e,{cardConfig:u,sectionConfig:h,lovelaceConfig:n,saveConfig:(c=(0,r.A)((0,i.A)().mark((function e(n){return(0,i.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,s.ql)(a,t,n);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),alert(a.localize("ui.panel.lovelace.add_entities.saving_failed"));case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),function(t){return c.apply(this,arguments)}),path:[o],entities:f})}});case 55:case"end":return t.stop()}}),t,null,[[11,17],[21,39,42,45],[25,33]])})));return function(e,a,i,n,r){return t.apply(this,arguments)}}()},84048:function(t,e,a){a.d(e,{Q:function(){return r}});a(95737),a(39790),a(66457),a(99019),a(96858);var i=a(34897),n=function(){return Promise.all([a.e(84514),a.e(5504),a.e(31271),a.e(26566),a.e(80675)]).then(a.bind(a,80675))},r=function(t,e){(0,i.r)(t,"show-dialog",{dialogTag:"hui-dialog-suggest-card",dialogImport:n,dialogParams:e})}},45111:function(t,e,a){a.d(e,{X:function(){return n}});a(95737),a(39790),a(66457),a(99019),a(96858);var i=a(34897),n=function(t,e){(0,i.r)(t,"show-dialog",{dialogTag:"hui-dialog-select-view",dialogImport:function(){return a.e(53779).then(a.bind(a,53779))},dialogParams:e})}},30489:function(t,e,a){a.d(e,{R:function(){return i}});var i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=document.createElement("a");a.target="_blank",a.href=t,a.download=e,document.body.appendChild(a),a.dispatchEvent(new MouseEvent("click")),document.body.removeChild(a)}},63523:function(t,e,a){var i=a(41765),n=a(18816),r=a(13113),s=a(22669),o=a(55812),c=a(81830),d=a(49921),l=a(53138),u=a(26857),h=a(99393),f=a(27761),v=a(80674),_=a(53982),g=v("replace"),p=TypeError,y=r("".indexOf),k=r("".replace),b=r("".slice),m=Math.max;i({target:"String",proto:!0},{replaceAll:function(t,e){var a,i,r,v,w,A,x,H,D,C,V=s(this),L=0,P="";if(!c(t)){if((a=d(t))&&(i=l(s(h(t))),!~y(i,"g")))throw new p("`.replaceAll` does not allow non-global regexes");if(r=u(t,g))return n(r,t,V,e);if(_&&a)return k(l(V),t,e)}for(v=l(V),w=l(t),(A=o(e))||(e=l(e)),x=w.length,H=m(1,x),D=y(v,w);-1!==D;)C=A?l(e(w,D,v)):f(w,v,D,[],void 0,e),P+=b(v,L,D)+C,L=D+x,D=D+H>v.length?-1:y(v,w,D+H);return L<v.length&&(P+=b(v,L)),P}})},92466:function(t,e,a){var i=a(22858).A,n=a(33994).A;a.a(t,function(){var t=i(n().mark((function t(i,r){var s,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a.d(e,{gP:function(){return s.z}}),s=a(20288),!(o=i([s])).then){t.next=11;break}return t.next=7,o;case 7:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=12;break;case 11:t.t0=o;case 12:s=t.t0[0],r(),t.next=19;break;case 16:t.prev=16,t.t2=t.catch(0),r(t.t2);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e,a){return t.apply(this,arguments)}}())},91293:function(t,e,a){var i=a(22858).A,n=a(33994).A;a.a(t,function(){var t=i(n().mark((function t(i,r){var s,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a.d(e,{gP:function(){return s.gP}}),s=a(92466),!(o=i([s])).then){t.next=11;break}return t.next=7,o;case 7:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=12;break;case 11:t.t0=o;case 12:s=t.t0[0],r(),t.next=19;break;case 16:t.prev=16,t.t2=t.catch(0),r(t.t2);case 19:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(e,a){return t.apply(this,arguments)}}())}}]);
//# sourceMappingURL=3959.dp4t8JBgo-E.js.map