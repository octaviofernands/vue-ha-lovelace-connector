"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[11150],{23469:function(t,e,a){a.d(e,{g:function(){return i}});a(79641);var n=a(45253),r=a(92164);function i(t,e,a,i,s,o){var c=t.getPropertyValue(s+"-"+o).trim(),u=c.length>0?c:t.getPropertyValue(s).trim(),l=(0,n.RQ)(u);return 0===c.length&&o&&(l=(0,n.v2)((0,n.BE)(e?(0,r.T)((0,n.Nc)((0,n.xp)(l)),o):(0,r.d)((0,n.Nc)((0,n.xp)(l)),o)))),i?l+=a?"32":"7F":a&&(l+="7F"),l}},37334:function(t,e,a){var n=a(22858).A,r=a(33994).A;a.a(t,function(){var t=n(r().mark((function t(n,i){var s,o,c,u,l,d,h,f,p,g,v,y,k;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,k=function(t,e,a,n,r,i,s){var o=(0,u.c)(e,t),c=void 0!==i&&void 0!==s;if(c&&o<=35){var g=(0,l.M)(e,t),v=(0,l.M)(s,i);v>g?e=(0,d.L)(e,v-g):g>v&&(s=(0,d.L)(s,g-v))}var k={parsing:!1,animation:!1,interaction:{mode:"x"},scales:{x:{type:"time",suggestedMin:t.getTime(),max:y(o,e),adapters:{date:{locale:a,config:n}},ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,font:function(t){return t.tick&&t.tick.major?{weight:"bold"}:{}}},time:{tooltipFormat:o>35?"monthyear":o>7?"date":o>2?"weekday":o>0?"datetime":"hour",minUnit:o>35?"month":o>2?"day":"hour"}},y:{stacked:!0,type:"linear",title:{display:!0,text:r},ticks:{beginAtZero:!0,callback:function(t){return(0,h.ZV)(Math.abs(t),a)}}}},plugins:{tooltip:{position:"nearest",filter:function(t){return"0"!==t.formattedValue},itemSort:function(t,e){return e.datasetIndex-t.datasetIndex},callbacks:{title:function(t){if(o>0)return t[0].label;var e=new Date(t[0].parsed.x);return"".concat(c?"".concat((0,f.sl)(e,a,n),": "):"").concat((0,p.fU)(e,a,n)," â€“ ").concat((0,p.fU)((0,d.L)(e,1),a,n))},label:function(t){return"".concat(t.dataset.label,": ").concat((0,h.ZV)(t.parsed.y,a)," ").concat(r)}}},filler:{propagate:!1},legend:{display:!1,labels:{usePointStyle:!0}}},elements:{bar:{borderWidth:1.5,borderRadius:4},point:{hitRadius:50}},locale:(0,h.Yf)(a)};return c&&(k.scales.xAxisCompare=Object.assign(Object.assign({},k.scales.x),{},{suggestedMin:i.getTime(),max:y(o,s),display:!1})),k},y=function(t,e){var a=new Date(e);return t>2&&0===a.getHours()&&(a=(0,c.O)(a,1)),a.setMinutes(0,0,0),t>35&&a.setDate(1),t>2&&a.setHours(0),a.getTime()},a.d(e,{o:function(){return k}}),s=a(81027),o=a(26098),c=a(65513),u=a(31195),l=a(6711),d=a(83324),h=a(57636),f=a(57289),p=a(41924),!(g=n([h,f,p])).then){t.next=23;break}return t.next=19,g;case 19:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=24;break;case 23:t.t0=g;case 24:v=t.t0,h=v[0],f=v[1],p=v[2],i(),t.next=34;break;case 31:t.prev=31,t.t2=t.catch(0),i(t.t2);case 34:case"end":return t.stop()}}),t,null,[[0,31]])})));return function(e,a){return t.apply(this,arguments)}}())},62835:function(t,e,a){var n=a(22858).A,r=a(33994).A;a.a(t,function(){var t=n(r().mark((function t(n,i){var s,o,c,u,l,d,h,f,p,g,v,y,k,m,_,b,x,A,w,D,M,O,S,C,j,z,E,F,R,T,H,P,V,W,I,Z,q,L,N,U,Y,$,B,G,Q;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a.r(e),a.d(e,{HuiEnergySolarGraphCard:function(){return Q}}),s=a(658),o=a(33994),c=a(41981),u=a(22858),l=a(64782),d=a(64599),h=a(35806),f=a(71008),p=a(62193),g=a(2816),v=a(27927),y=a(81027),k=a(13025),m=a(89655),_=a(29193),b=a(26098),x=a(99471),A=a(39790),w=a(253),D=a(2075),M=a(54846),O=a(4525),S=a(66555),C=a(79784),j=a(75697),z=a(5343),E=a(31195),F=a(50289),R=a(29818),T=a(85323),H=a(94100),P=a(23469),V=a(57636),a(90701),a(13082),W=a(47076),I=a(4826),Z=a(20712),q=a(7934),L=a(37334),!(N=n([V,W,L])).then){t.next=63;break}return t.next=59,N;case 59:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=64;break;case 63:t.t0=N;case 64:U=t.t0,V=U[0],W=U[1],L=U[2],Q=(0,v.A)([(0,R.EM)("hui-energy-solar-graph-card")],(function(t,e){var a,n=function(e){function a(){var e;(0,f.A)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=(0,p.A)(this,a,[].concat(r)),t(e),e}return(0,g.A)(a,e),(0,h.A)(a)}(e);return{F:n,d:[{kind:"field",decorators:[(0,R.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,R.wk)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,R.wk)()],key:"_chartData",value:function(){return{datasets:[]}}},{kind:"field",decorators:[(0,R.wk)()],key:"_start",value:function(){return(0,C.R)()}},{kind:"field",decorators:[(0,R.wk)()],key:"_end",value:function(){return(0,j.o)()}},{kind:"field",decorators:[(0,R.wk)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,R.wk)()],key:"_compareEnd",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:function(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var t,e=this;return[(0,W.tb)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((function(t){return e._getStatistics(t)}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,q.xP)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?(0,F.qy)(Y||(Y=(0,d.A)([" <ha-card> ",' <div class="content ','"> <ha-chart-base .hass="','" .data="','" .options="','" chart-type="bar"></ha-chart-base> '," </div> </ha-card> "])),this._config.title?(0,F.qy)($||($=(0,d.A)(['<h1 class="card-header">',"</h1>"])),this._config.title):"",(0,T.H)({"has-header":!!this._config.title}),this.hass,this._chartData,this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,this._compareStart,this._compareEnd),this._chartData.datasets.length?"":(0,F.qy)(B||(B=(0,d.A)(['<div class="no-data"> '," </div>"])),(0,z.c)(this._start)?this.hass.localize("ui.panel.lovelace.cards.energy.no_data"):this.hass.localize("ui.panel.lovelace.cards.energy.no_data_period"))):F.s6}},{kind:"field",key:"_createOptions",value:function(){var t=this;return(0,H.A)((function(e,a,n,r,i,s){var o=(0,L.o)(e,a,n,r,"kWh",i,s);return Object.assign(Object.assign({},o),{},{plugins:Object.assign(Object.assign({},o.plugins),{},{tooltip:Object.assign(Object.assign({},o.plugins.tooltip),{},{callbacks:Object.assign(Object.assign({},o.plugins.tooltip.callbacks),{},{footer:function(e){var a=e.filter((function(t){var e;return"solar"===(null===(e=t.dataset)||void 0===e?void 0:e.stack)}));if(a.length<2)return[];var r,i=0,s=(0,l.A)(a);try{for(s.s();!(r=s.n()).done;){var o=r.value;i+=o.dataset.data[o.dataIndex].y}}catch(c){s.e(c)}finally{s.f()}return 0===i?[]:[t.hass.localize("ui.panel.lovelace.cards.energy.energy_solar_graph.total_produced",{num:(0,V.ZV)(i,n)})]}})})}),elements:{line:{tension:.3,borderWidth:1.5},bar:{borderWidth:1.5,borderRadius:4},point:{hitRadius:5}}})}))}},{kind:"method",key:"_getStatistics",value:(a=(0,u.A)((0,o.A)().mark((function t(e){var a,n,r,i;return(0,o.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a=e.prefs.energy_sources.filter((function(t){return"solar"===t.type}))).some((function(t){var e;return null===(e=t.config_entry_solar_forecast)||void 0===e?void 0:e.length}))){t.next=10;break}return t.prev=2,t.next=5,(0,W.al)(this.hass);case 5:n=t.sent,t.next=10;break;case 8:t.prev=8,t.t0=t.catch(2);case 10:r=[],i=getComputedStyle(this),r.push.apply(r,(0,c.A)(this._processDataSet(e.stats,e.statsMetadata,a,i))),e.statsCompare&&(r.push({order:0,data:[]}),r.push({order:999,data:[],xAxisID:"xAxisCompare"}),r.push.apply(r,(0,c.A)(this._processDataSet(e.statsCompare,e.statsMetadata,a,i,!0)))),n&&r.push.apply(r,(0,c.A)(this._processForecast(e.statsMetadata,n,a,i.getPropertyValue("--primary-text-color"),e.start,e.end))),this._start=e.start,this._end=e.end||(0,j.o)(),this._compareStart=e.startCompare,this._compareEnd=e.endCompare,this._chartData={datasets:r};case 20:case"end":return t.stop()}}),t,this,[[2,8]])}))),function(t){return a.apply(this,arguments)})},{kind:"method",key:"_processDataSet",value:function(t,e,a,n){var r=this,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=[];return a.forEach((function(a,o){var c=null,u=[];if(a.stat_energy_from in t){var d,h,f=t[a.stat_energy_from],p=(0,l.A)(f);try{for(p.s();!(h=p.n()).done;){var g=h.value;if(null!==g.change&&void 0!==g.change&&c!==g.start){var v=new Date(g.start);u.push({x:v.getTime(),y:g.change}),c=g.start,d=g.end}}}catch(y){p.e(y)}finally{p.f()}1===u.length&&u.push({x:d,y:0})}s.push({label:r.hass.localize("ui.panel.lovelace.cards.energy.energy_solar_graph.production",{name:(0,I.$O)(r.hass,a.stat_energy_from,e[a.stat_energy_from])}),borderColor:(0,P.g)(n,r.hass.themes.darkMode,!1,i,"--energy-solar-color",o),backgroundColor:(0,P.g)(n,r.hass.themes.darkMode,!0,i,"--energy-solar-color",o),data:u,order:1,stack:"solar",xAxisID:i?"xAxisCompare":void 0})})),s}},{kind:"method",key:"_processForecast",value:function(t,e,a,n,r,i){var o=this,c=[],u=(0,E.c)(i||new Date,r);return a.forEach((function(a){if(a.config_entry_solar_forecast){var l={};if(a.config_entry_solar_forecast.forEach((function(t){e[t]&&Object.entries(e[t].wh_hours).forEach((function(t){var e=(0,s.A)(t,2),a=e[0],n=e[1],o=new Date(a);if(!(o<r||i&&o>i)){u>35&&o.setDate(1),u>2?o.setHours(0,0,0,0):o.setMinutes(0,0,0);var c=o.getTime();c in l?l[c]+=n:l[c]=n}}))})),l){for(var d=[],h=0,f=Object.entries(l);h<f.length;h++){var p=(0,s.A)(f[h],2),g=p[0],v=p[1];d.push({x:Number(g),y:v/1e3})}d.length&&c.push({type:"line",label:o.hass.localize("ui.panel.lovelace.cards.energy.energy_solar_graph.forecast",{name:(0,I.$O)(o.hass,a.stat_energy_from,t[a.stat_energy_from])}),fill:!1,stepped:!1,borderColor:n,borderDash:[7,5],pointRadius:0,data:d})}}})),c}},{kind:"get",static:!0,key:"styles",value:function(){return(0,F.AH)(G||(G=(0,d.A)(["ha-card{height:100%}.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}.no-data{position:absolute;height:100%;top:0;left:0;right:0;display:flex;justify-content:center;align-items:center;padding:20%;margin-left:32px;margin-inline-start:32px;margin-inline-end:initial;box-sizing:border-box}"])))}}]}}),(0,Z.E)(F.WF)),i(),t.next=75;break;case 72:t.prev=72,t.t2=t.catch(0),i(t.t2);case 75:case"end":return t.stop()}}),t,null,[[0,72]])})));return function(e,a){return t.apply(this,arguments)}}())},24226:function(t,e,a){a.d(e,{z:function(){return r}});var n=a(30429);function r(t,e){var a=(0,n.a)(t),r=(0,n.a)(e),i=a.getTime()-r.getTime();return i<0?-1:i>0?1:i}},72730:function(t,e,a){a.d(e,{W:function(){return o}});a(29193);var n=a(24226),r=a(30429);function i(t,e){var a=(0,r.a)(t),n=(0,r.a)(e);return 12*(a.getFullYear()-n.getFullYear())+(a.getMonth()-n.getMonth())}var s=a(91103);function o(t,e){var a,o=(0,r.a)(t),c=(0,r.a)(e),u=(0,n.z)(o,c),l=Math.abs(i(o,c));if(l<1)a=0;else{1===o.getMonth()&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-u*l);var d=(0,n.z)(o,c)===-u;(0,s.c)((0,r.a)(t))&&1===l&&1===(0,n.z)(t,c)&&(d=!1),a=u*(l-Number(d))}return 0===a?0:a}},75697:function(t,e,a){a.d(e,{o:function(){return r}});var n=a(60132);function r(){return(0,n.D)(Date.now())}},77301:function(t,e,a){a.d(e,{e:function(){return r}});var n=a(30429);function r(t){return 1===(0,n.a)(t).getDate()}},91103:function(t,e,a){a.d(e,{c:function(){return s}});var n=a(60132),r=a(12152),i=a(30429);function s(t){var e=(0,i.a)(t);return+(0,n.D)(e)==+(0,r.p)(e)}},5343:function(t,e,a){a.d(e,{c:function(){return s}});var n=a(59613);function r(t){return(0,n.w)(t,Date.now())}var i=a(9854);function s(t){return(0,i.r)(t,r(t))}},65513:function(t,e,a){a.d(e,{O:function(){return r}});var n=a(83324);function r(t,e){return(0,n.L)(t,-e)}}}]);
//# sourceMappingURL=11150.x3wLubyagZM.js.map