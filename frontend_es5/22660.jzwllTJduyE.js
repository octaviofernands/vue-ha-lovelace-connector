"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[22660],{31232:function(e,t,a){a.d(t,{F:function(){return r},r:function(){return o}});var i=a(91001),s=(a(39790),a(9241),a(36016),a(98185),a(253),a(4525),/{%|{{/),r=function(e){return s.test(e)},o=function(e){return!!e&&("string"==typeof e?r(e):"object"===(0,i.A)(e)&&(Array.isArray(e)?e:Object.values(e)).some((function(e){return e&&o(e)})))}},22660:function(e,t,a){var i=a(22858).A,s=a(33994).A;a.a(e,function(){var e=i(s().mark((function e(i,r){var o,n,l,c,d,h,u,v,p,_,f,m,y,b,k,g,x,A,D,w,z,M,C,j,q,O,S,E,V,U,F,T,Y,H,B,P,Z,I,L,R,J,N,W,G,K,Q,X,$,ee,te,ae,ie,se,re,oe,ne,le,ce,de,he,ue,ve,pe,_e,fe,me;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a.r(t),o=a(658),n=a(64782),l=a(33994),c=a(22858),d=a(64599),h=a(35806),u=a(71008),v=a(62193),p=a(2816),_=a(27927),f=a(35890),m=a(42942),y=a(48062),b=a(81027),k=a(13025),g=a(44124),x=a(97741),A=a(89655),D=a(33231),w=a(72735),z=a(26098),M=a(99471),C=a(10507),j=a(39790),q=a(253),O=a(2075),S=a(94438),E=a(54846),V=a(16891),U=a(4525),F=a(66555),T=a(32707),Y=a(51431),H=a(50289),B=a(29818),P=a(94100),Z=a(96979),I=a(213),L=a(59780),R=a(31232),J=a(56932),N=a(18589),W=a(32920),G=a(94548),a(13082),a(13292),a(77372),a(15720),a(4169),K=a(95113),Q=a(5348),a(57641),X=a(39914),$=a(55979),ee=a(54525),te=a(55321),ae=a(84976),!(ie=i([G,K,Q])).then){e.next=87;break}return e.next=83,ie;case 83:e.t1=e.sent,e.t0=(0,e.t1)(),e.next=88;break;case 87:e.t0=ie;case 88:se=e.t0,G=se[0],K=se[1],Q=se[2],(0,_.A)([(0,B.EM)("developer-tools-action")],(function(e,t){var a,i,s=function(t){function a(){var t;(0,u.A)(this,a);for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return t=(0,v.A)(this,a,[].concat(s)),e(t),t}return(0,p.A)(a,t),(0,h.A)(a)}(t);return{F:s,d:[{kind:"field",decorators:[(0,B.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,B.MZ)({type:Boolean})],key:"narrow",value:function(){return!1}},{kind:"field",decorators:[(0,B.wk)()],key:"_uiAvailable",value:function(){return!0}},{kind:"field",decorators:[(0,B.wk)()],key:"_response",value:void 0},{kind:"field",decorators:[(0,B.wk)()],key:"_error",value:void 0},{kind:"field",key:"_yamlValid",value:function(){return!0}},{kind:"field",decorators:[(0,Z.I)({key:"panel-dev-action-state-service-data",state:!0,subscribe:!1})],key:"_serviceData",value:function(){return{action:"",target:{},data:{}}}},{kind:"field",decorators:[(0,Z.I)({key:"panel-dev-action-state-yaml-mode",state:!0,subscribe:!1})],key:"_yamlMode",value:function(){return!1}},{kind:"field",decorators:[(0,B.P)("#yaml-editor")],key:"_yamlEditor",value:void 0},{kind:"method",key:"firstUpdated",value:function(e){var t,a=this;(0,f.A)(s,"firstUpdated",this,3)([e]),this.hass.loadBackendTranslation("services"),this.hass.loadBackendTranslation("selector");var i=(0,J.p9)("service");if(i)this._serviceData={action:i,target:{},data:{}},this._yamlMode&&this.updateComplete.then((function(){var e;return null===(e=a._yamlEditor)||void 0===e?void 0:e.setValue(a._serviceData)}));else if(null===(t=this._serviceData)||void 0===t||!t.action){var r=Object.keys(this.hass.services).sort()[0],o=Object.keys(this.hass.services[r]).sort()[0];this._serviceData={action:"".concat(r,".").concat(o),target:{},data:{}},this._yamlMode&&this.updateComplete.then((function(){var e;return null===(e=a._yamlEditor)||void 0===e?void 0:e.setValue(a._serviceData)}))}this._checkUiSupported()}},{kind:"method",key:"render",value:function(){var e,t,a,i,s,r,o,n,l=this,c=this._fields(this.hass.services,null===(e=this._serviceData)||void 0===e?void 0:e.action),h=c.target,u=c.fields,v=null!==(t=this._serviceData)&&void 0!==t&&t.action?(0,I.m)(null===(a=this._serviceData)||void 0===a?void 0:a.action):void 0,p=null!==(i=this._serviceData)&&void 0!==i&&i.action?(0,L.Y)(null===(s=this._serviceData)||void 0===s?void 0:s.action):void 0;return(0,H.qy)(re||(re=(0,d.A)([' <div class="content"> <p> '," </p> <ha-card> "," ",' </ha-card> </div> <div class="button-row"> <div class="buttons"> <div class="switch-mode-container"> <mwc-button @click="','" .disabled="','"> '," </mwc-button> ",' </div> <ha-progress-button raised @click="','"> '," </ha-progress-button> </div> </div> "," "," "])),this.hass.localize("ui.panel.developer-tools.tabs.actions.description"),this._yamlMode?(0,H.qy)(oe||(oe=(0,d.A)(['<div class="card-content"> <ha-service-picker .hass="','" .value="','" @value-changed="','"></ha-service-picker> <ha-yaml-editor id="yaml-editor" .hass="','" .defaultValue="','" @value-changed="','"></ha-yaml-editor> </div>'])),this.hass,null===(r=this._serviceData)||void 0===r?void 0:r.action,this._serviceChanged,this.hass,this._serviceData,this._yamlChanged):(0,H.qy)(ne||(ne=(0,d.A)([' <ha-service-control .hass="','" .value="','" .narrow="','" showAdvanced @value-changed="','" class="card-content"></ha-service-control> '])),this.hass,this._serviceData,this.narrow,this._serviceDataChanged),void 0!==this._error?(0,H.qy)(le||(le=(0,d.A)(['<ha-alert alert-type="error">',"</ha-alert>"])),this._error):H.s6,this._toggleYaml,!this._uiAvailable,this._yamlMode?this.hass.localize("ui.panel.developer-tools.tabs.actions.ui_mode"):this.hass.localize("ui.panel.developer-tools.tabs.actions.yaml_mode"),this._uiAvailable?"":(0,H.qy)(ce||(ce=(0,d.A)(['<span class="error">',"</span>"])),this.hass.localize("ui.panel.developer-tools.tabs.actions.no_template_ui_support")),this._callService,this.hass.localize("ui.panel.developer-tools.tabs.actions.call_service"),this._response?(0,H.qy)(de||(de=(0,d.A)(['<div class="content"> <ha-card .header="','"> <div class="card-content"> <ha-yaml-editor .hass="','" copyClipboard readOnly="readOnly" autoUpdate hasExtraActions .value="','"> <ha-button slot="extra-actions" @click="','">',"</ha-button> </ha-yaml-editor> </div> </ha-card> </div>"])),this.hass.localize("ui.panel.developer-tools.tabs.actions.response"),this.hass,this._response,this._copyTemplate,this.hass.localize("ui.panel.developer-tools.tabs.actions.copy_clipboard_template")):H.s6,(this._yamlMode?u:this._filterSelectorFields(u)).length?(0,H.qy)(he||(he=(0,d.A)(['<div class="content"> <ha-expansion-panel .header="','" outlined .expanded="','"> ',' <table class="attributes"> <tr> <th> '," </th> <th> "," </th> <th> "," </th> </tr> "," </table> "," </ha-expansion-panel> </div>"])),this._yamlMode?this.hass.localize("ui.panel.developer-tools.tabs.actions.all_parameters"):this.hass.localize("ui.panel.developer-tools.tabs.actions.yaml_parameters"),this._yamlMode,this._yamlMode?(0,H.qy)(ue||(ue=(0,d.A)(['<div class="description"> <h3> '," </h3> "," </div>"])),h?(0,H.qy)(ve||(ve=(0,d.A)([" "," "])),this.hass.localize("ui.panel.developer-tools.tabs.actions.accepts_target")):"",null!==(o=this._serviceData)&&void 0!==o&&o.action?(0,H.qy)(pe||(pe=(0,d.A)([' <a href="','" title="','" target="_blank" rel="noreferrer"> <ha-icon-button class="help-icon" .path="','" .label="','"></ha-icon-button> </a>'])),(0,ae.o)(this.hass,"/integrations/"+(0,I.m)(null===(n=this._serviceData)||void 0===n?void 0:n.action)),this.hass.localize("ui.components.service-control.integration_doc"),"M15.07,11.25L14.17,12.17C13.45,12.89 13,13.5 13,15H11V14.5C11,13.39 11.45,12.39 12.17,11.67L13.41,10.41C13.78,10.05 14,9.55 14,9C14,7.89 13.1,7 12,7A2,2 0 0,0 10,9H8A4,4 0 0,1 12,5A4,4 0 0,1 16,9C16,9.88 15.64,10.67 15.07,11.25M13,19H11V17H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z",this.hass.localize("ui.common.help")):""):"",this.hass.localize("ui.panel.developer-tools.tabs.actions.column_parameter"),this.hass.localize("ui.panel.developer-tools.tabs.actions.column_description"),this.hass.localize("ui.panel.developer-tools.tabs.actions.column_example"),(this._yamlMode?u:this._filterSelectorFields(u)).map((function(e){return(0,H.qy)(_e||(_e=(0,d.A)([" <tr> <td><pre>","</pre></td> <td> "," </td> <td> "," </td> </tr>"])),e.key,l.hass.localize("component.".concat(v,".services.").concat(p,".fields.").concat(e.key,".description"))||e.description,l.hass.localize("component.".concat(v,".services.").concat(p,".fields.").concat(e.key,".example"))||e.example)})),this._yamlMode?(0,H.qy)(fe||(fe=(0,d.A)(['<mwc-button @click="','">',"</mwc-button>"])),this._fillExampleData,this.hass.localize("ui.panel.developer-tools.tabs.actions.fill_example_data")):""):"")}},{kind:"method",key:"_copyTemplate",value:(i=(0,c.A)((0,l.A)().mark((function e(){var t;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,W.l)("{% set ".concat((null===(t=this._serviceData)||void 0===t?void 0:t.response_variable)||"action_response"," = ").concat(JSON.stringify(this._response)," %}"));case 2:(0,N.P)(this,{message:this.hass.localize("ui.common.copied_clipboard")});case 3:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{kind:"field",key:"_filterSelectorFields",value:function(){return(0,P.A)((function(e){return e.filter((function(e){return!e.selector}))}))}},{kind:"field",key:"_validateServiceData",value:function(){return function(e,t,a,i,s){var r,o,l,c=i?"yaml":"ui";if(null==e||!e.action)return s("ui.panel.developer-tools.tabs.actions.errors.".concat(c,".no_action"));var d=(0,I.m)(e.action),h=(0,L.Y)(e.action);if(!d||!h)return s("ui.panel.developer-tools.tabs.actions.errors.".concat(c,".invalid_action"));if(a&&!e.target&&(null===(r=e.data)||void 0===r||!r.entity_id)&&(null===(o=e.data)||void 0===o||!o.device_id)&&(null===(l=e.data)||void 0===l||!l.area_id))return s("ui.panel.developer-tools.tabs.actions.errors.".concat(c,".no_target"));var u,v=(0,n.A)(t);try{for(v.s();!(u=v.n()).done;){var p=u.value;if(p.required&&(!e.data||void 0===e.data[p.key]))return s("ui.panel.developer-tools.tabs.actions.errors.".concat(c,".missing_required_field"),{key:p.key})}}catch(_){v.e(_)}finally{v.f()}}}},{kind:"field",key:"_fields",value:function(){return(0,P.A)((function(e,t){if(!t)return{target:!1,fields:[]};var a=(0,I.m)(t),i=(0,L.Y)(t);if(!(a in e))return{target:!1,fields:[]};if(!(i in e[a]))return{target:!1,fields:[]};var s="target"in e[a][i],r=e[a][i].fields;return{target:s,fields:Object.keys(r).map((function(e){return Object.assign({key:e},r[e])}))}}))}},{kind:"method",key:"_callService",value:(a=(0,c.A)((0,l.A)().mark((function e(t){var a,i,s,r,n,c,d,h,u,v,p,_,f,m;return(0,l.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.currentTarget,!this._yamlMode||this._yamlValid){e.next=6;break}return(0,X.j)("failure"),s.actionError(),this._error=this.hass.localize("ui.panel.developer-tools.tabs.actions.errors.yaml.invalid_yaml"),e.abrupt("return");case 6:if(r=this._fields(this.hass.services,null===(a=this._serviceData)||void 0===a?void 0:a.action),n=r.target,c=r.fields,this._error=this._validateServiceData(this._serviceData,c,n,this._yamlMode,this.hass.localize),void 0===this._error){e.next=12;break}return(0,X.j)("failure"),s.actionError(),e.abrupt("return");case 12:return d=this._serviceData.action.split(".",2),h=(0,o.A)(d,2),u=h[0],v=h[1],p=[],null!==(i=this.hass.services)&&void 0!==i&&null!==(i=i[u])&&void 0!==i&&i[v]&&"response"in this.hass.services[u][v]?(p.push(Object.assign(Object.assign({},this._serviceData),{},{response_variable:"service_result"})),p.push({stop:"done",response_variable:"service_result"})):p.push(this._serviceData),e.prev=15,e.next=18,(0,ee.d)(this.hass,p);case 18:this._response=e.sent.response,e.next=34;break;case 21:if(e.prev=21,e.t0=e.catch(15),(null===(_=e.t0.error)||void 0===_?void 0:_.code)!==T.UD||!(0,ee.C)(u,v)){e.next=25;break}return e.abrupt("return");case 25:if((0,X.j)("failure"),s.actionError(),!e.t0.translation_domain||!e.t0.translation_key){e.next=32;break}return e.next=30,this.hass.loadBackendTranslation("exceptions",e.t0.translation_domain);case 30:m=e.sent,f=m("component.".concat(e.t0.translation_domain,".exceptions.").concat(e.t0.translation_key,".message"),e.t0.translation_placeholders);case 32:return this._error=f||this.hass.localize("ui.notification_toast.action_failed",{service:this._serviceData.action})+" ".concat(e.t0.message),e.abrupt("return");case 34:s.actionSuccess();case 35:case"end":return e.stop()}}),e,this,[[15,21]])}))),function(e){return a.apply(this,arguments)})},{kind:"method",key:"_toggleYaml",value:function(){this._yamlMode=!this._yamlMode,this._yamlValid=!0,this._error=void 0}},{kind:"method",key:"_yamlChanged",value:function(e){e.detail.isValid?(this._yamlValid=!0,this._serviceDataChanged(e)):this._yamlValid=!1}},{kind:"method",key:"_checkUiSupported",value:function(){var e,t=this._fields(this.hass.services,null===(e=this._serviceData)||void 0===e?void 0:e.action).fields;this._serviceData&&(Object.entries(this._serviceData).some((function(e){var t=(0,o.A)(e,2),a=t[0],i=t[1];return"data"!==a&&(0,R.r)(i)}))||this._serviceData.data&&Object.entries(this._serviceData.data).some((function(e){var a=(0,o.A)(e,2),i=a[0],s=a[1],r=t.find((function(e){return e.key===i}));return(null==r||!r.selector||!("template"in r.selector)&&!("object"in r.selector))&&(0,R.r)(s)})))?(this._yamlMode=!0,this._uiAvailable=!1):this._uiAvailable=!0}},{kind:"method",key:"_serviceDataChanged",value:function(e){var t;(null===(t=this._serviceData)||void 0===t?void 0:t.action)!==e.detail.value.action&&(this._error=void 0),this._serviceData=(0,$.Rn)(e.detail.value),this._checkUiSupported()}},{kind:"method",key:"_serviceChanged",value:function(e){var t;e.stopPropagation(),this._serviceData={action:e.detail.value||"",data:{}},this._response=void 0,this._error=void 0,null===(t=this._yamlEditor)||void 0===t||t.setValue(this._serviceData),this._checkUiSupported()}},{kind:"method",key:"_fillExampleData",value:function(){var e,t,a,i,s,r,o=this,n=this._fields(this.hass.services,null===(e=this._serviceData)||void 0===e?void 0:e.action).fields,l=null!==(t=this._serviceData)&&void 0!==t&&t.action?(0,I.m)(null===(a=this._serviceData)||void 0===a?void 0:a.action):void 0,c=null!==(i=this._serviceData)&&void 0!==i&&i.action?(0,L.Y)(null===(s=this._serviceData)||void 0===s?void 0:s.action):void 0,d={};n.forEach((function(e){if(e.example){var t="";try{t=(0,Y.load)(e.example)}catch(a){t=o.hass.localize("component.".concat(l,".services.").concat(c,".fields.").concat(e.key,".example"))||e.example}d[e.key]=t}})),this._serviceData=Object.assign(Object.assign({},this._serviceData),{},{data:d}),null===(r=this._yamlEditor)||void 0===r||r.setValue(this._serviceData),this._checkUiSupported()}},{kind:"get",static:!0,key:"styles",value:function(){return[te.RF,(0,H.AH)(me||(me=(0,d.A)([".content{padding:16px;padding:max(16px,env(safe-area-inset-top)) max(16px,env(safe-area-inset-right)) max(16px,env(safe-area-inset-bottom)) max(16px,env(safe-area-inset-left));max-width:1200px;margin:auto}.button-row{padding:8px 16px;padding:max(8px,env(safe-area-inset-top)) max(16px,env(safe-area-inset-right)) max(8px,env(safe-area-inset-bottom)) max(16px,env(safe-area-inset-left));border-top:1px solid var(--divider-color);border-bottom:1px solid var(--divider-color);background:var(--card-background-color);position:sticky;bottom:0;box-sizing:border-box;width:100%}.button-row .buttons{display:flex;justify-content:space-between;max-width:1200px;margin:auto}.switch-mode-container{display:flex;align-items:center}.switch-mode-container .error{margin-left:8px;margin-inline-start:8px;margin-inline-end:initial}.attributes{width:100%}.attributes th{text-align:var(--float-start);background-color:var(--card-background-color);border-bottom:1px solid var(--primary-text-color);direction:var(--direction)}.attributes tr{vertical-align:top;direction:ltr}.attributes tr:nth-child(odd){background-color:var(--table-row-background-color,#eee)}.attributes tr:nth-child(2n){background-color:var(--table-row-alternative-background-color,#eee)}.attributes td:nth-child(3){white-space:pre-wrap;word-break:break-word}.attributes td{padding:4px;vertical-align:middle}.help-icon{color:var(--secondary-text-color)}.description{justify-content:space-between;display:flex;align-items:center}"])))]}}]}}),H.WF),r(),e.next=100;break;case 97:e.prev=97,e.t2=e.catch(0),r(e.t2);case 100:case"end":return e.stop()}}),e,null,[[0,97]])})));return function(t,a){return e.apply(this,arguments)}}())}}]);
//# sourceMappingURL=22660.jzwllTJduyE.js.map