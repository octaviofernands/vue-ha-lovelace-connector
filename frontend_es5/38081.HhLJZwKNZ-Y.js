"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[38081],{38081:function(e,s,a){a.r(s),a.d(s,{DialogAddUser:function(){return x}});var i,t,r,n,o,d,l,h=a(33994),c=a(22858),u=a(64599),_=a(35806),p=a(71008),m=a(62193),f=a(2816),k=a(27927),g=a(35890),v=(a(81027),a(50693),a(50289)),w=a(29818),y=(a(13292),a(77372),a(32885),a(29180)),A=(a(24284),a(4169),a(24640),a(60203),a(90431),a(94526)),C=a(71443),b=a(55321),x=(0,k.A)([(0,w.EM)("dialog-add-user")],(function(e,s){var a,k,x=function(s){function a(){var s;(0,p.A)(this,a);for(var i=arguments.length,t=new Array(i),r=0;r<i;r++)t[r]=arguments[r];return s=(0,m.A)(this,a,[].concat(t)),e(s),s}return(0,f.A)(a,s),(0,_.A)(a)}(s);return{F:x,d:[{kind:"field",decorators:[(0,w.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,w.wk)()],key:"_loading",value:function(){return!1}},{kind:"field",decorators:[(0,w.wk)()],key:"_error",value:void 0},{kind:"field",decorators:[(0,w.wk)()],key:"_params",value:void 0},{kind:"field",decorators:[(0,w.wk)()],key:"_name",value:void 0},{kind:"field",decorators:[(0,w.wk)()],key:"_username",value:void 0},{kind:"field",decorators:[(0,w.wk)()],key:"_password",value:void 0},{kind:"field",decorators:[(0,w.wk)()],key:"_passwordConfirm",value:void 0},{kind:"field",decorators:[(0,w.wk)()],key:"_isAdmin",value:void 0},{kind:"field",decorators:[(0,w.wk)()],key:"_localOnly",value:void 0},{kind:"field",decorators:[(0,w.wk)()],key:"_allowChangeName",value:function(){return!0}},{kind:"method",key:"showDialog",value:function(e){this._params=e,this._name=this._params.name||"",this._username="",this._password="",this._passwordConfirm="",this._isAdmin=!1,this._localOnly=!1,this._error=void 0,this._loading=!1,this._params.name?(this._allowChangeName=!1,this._maybePopulateUsername()):this._allowChangeName=!0}},{kind:"method",key:"firstUpdated",value:function(e){var s=this;(0,g.A)(x,"firstUpdated",this,3)([e]),this.addEventListener("keypress",(function(e){"Enter"===e.key&&s._createUser(e)}))}},{kind:"method",key:"render",value:function(){return this._params?(0,v.qy)(i||(i=(0,u.A)([' <ha-dialog open @closed="','" scrimClickAction escapeKeyAction .heading="','"> <div> '," ",' <ha-textfield class="username" name="username" .label="','" .value="','" required @input="','" .validationMessage="','" dialogInitialFocus></ha-textfield> <ha-textfield .label="','" type="password" name="password" .value="','" required @input="','" .validationMessage="','"></ha-textfield> <ha-textfield label="','" name="passwordConfirm" .value="','" @input="','" required type="password" .invalid="','" .validationMessage="','"></ha-textfield> <ha-settings-row> <span slot="heading"> ',' </span> <span slot="description"> ',' </span> <ha-switch .checked="','" @change="','"> </ha-switch> </ha-settings-row> <ha-settings-row> <span slot="heading"> ',' </span> <span slot="description"> ',' </span> <ha-switch .checked="','" @change="','"> </ha-switch> </ha-settings-row> '," </div> "," </ha-dialog> "])),this._close,(0,y.l)(this.hass,this.hass.localize("ui.panel.config.users.add_user.caption")),this._error?(0,v.qy)(t||(t=(0,u.A)([' <div class="error">',"</div> "])),this._error):"",this._allowChangeName?(0,v.qy)(r||(r=(0,u.A)(['<ha-textfield class="name" name="name" .label="','" .value="','" required .validationMessage="','" @input="','" @blur="','" dialogInitialFocus></ha-textfield>'])),this.hass.localize("ui.panel.config.users.editor.name"),this._name,this.hass.localize("ui.common.error_required"),this._handleValueChanged,this._maybePopulateUsername):"",this.hass.localize("ui.panel.config.users.editor.username"),this._username,this._handleValueChanged,this.hass.localize("ui.common.error_required"),this.hass.localize("ui.panel.config.users.add_user.password"),this._password,this._handleValueChanged,this.hass.localize("ui.common.error_required"),this.hass.localize("ui.panel.config.users.add_user.password_confirm"),this._passwordConfirm,this._handleValueChanged,""!==this._password&&""!==this._passwordConfirm&&this._passwordConfirm!==this._password,this.hass.localize("ui.panel.config.users.add_user.password_not_match"),this.hass.localize("ui.panel.config.users.editor.local_access_only"),this.hass.localize("ui.panel.config.users.editor.local_access_only_description"),this._localOnly,this._localOnlyChanged,this.hass.localize("ui.panel.config.users.editor.admin"),this.hass.localize("ui.panel.config.users.editor.admin_description"),this._isAdmin,this._adminChanged,this._isAdmin?v.s6:(0,v.qy)(n||(n=(0,u.A)([' <ha-alert alert-type="info"> '," </ha-alert> "])),this.hass.localize("ui.panel.config.users.users_privileges_note")),this._loading?(0,v.qy)(o||(o=(0,u.A)([' <div slot="primaryAction" class="submit-spinner"> <ha-circular-progress indeterminate></ha-circular-progress> </div> ']))):(0,v.qy)(d||(d=(0,u.A)([' <ha-button slot="primaryAction" .disabled="','" @click="','"> '," </ha-button> "])),!this._name||!this._username||!this._password||this._password!==this._passwordConfirm,this._createUser,this.hass.localize("ui.panel.config.users.add_user.create"))):v.s6}},{kind:"method",key:"_close",value:function(){this._params=void 0}},{kind:"method",key:"_maybePopulateUsername",value:function(){if(!this._username&&this._name){var e=this._name.split(" ");e.length&&(this._username=e[0].toLowerCase())}}},{kind:"method",key:"_handleValueChanged",value:function(e){this._error=void 0;var s=e.target;this["_".concat(s.name)]=s.value}},{kind:"method",key:"_adminChanged",value:(k=(0,c.A)((0,h.A)().mark((function e(s){var a;return(0,h.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=s.target,this._isAdmin=a.checked;case 2:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{kind:"method",key:"_localOnlyChanged",value:function(e){var s=e.target;this._localOnly=s.checked}},{kind:"method",key:"_createUser",value:(a=(0,c.A)((0,h.A)().mark((function e(s){var a,i;return(0,h.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.preventDefault(),this._name&&this._username&&this._password){e.next=3;break}return e.abrupt("return");case 3:return this._loading=!0,this._error="",e.prev=5,e.next=8,(0,C.kg)(this.hass,this._name,[this._isAdmin?C.wj:C.eR],this._localOnly);case 8:i=e.sent,a=i.user,e.next=17;break;case 12:return e.prev=12,e.t0=e.catch(5),this._loading=!1,this._error=e.t0.message,e.abrupt("return");case 17:return e.prev=17,e.next=20,(0,A.Fy)(this.hass,a.id,this._username,this._password);case 20:e.next=29;break;case 22:return e.prev=22,e.t1=e.catch(17),e.next=26,(0,C.hG)(this.hass,a.id);case 26:return this._loading=!1,this._error=e.t1.message,e.abrupt("return");case 29:a.username=this._username,a.credentials=[{type:"homeassistant"}],this._params.userAddedCallback(a),this._close();case 33:case"end":return e.stop()}}),e,this,[[5,12],[17,22]])}))),function(e){return a.apply(this,arguments)})},{kind:"get",static:!0,key:"styles",value:function(){return[b.nA,(0,v.AH)(l||(l=(0,u.A)(["ha-dialog{--mdc-dialog-max-width:500px;--dialog-z-index:10}.row{display:flex;padding:8px 0}ha-textfield{display:block;margin-bottom:8px}ha-settings-row{padding:0}"])))]}}]}}),v.WF)}}]);
//# sourceMappingURL=38081.HhLJZwKNZ-Y.js.map