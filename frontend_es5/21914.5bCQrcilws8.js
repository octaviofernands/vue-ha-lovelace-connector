"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[21914],{46999:function(t,e,a){a.d(e,{Vy:function(){return r},fI:function(){return s}});var n=a(45253),i=["#44739e","#984ea3","#00d2d5","#ff7f00","#af8d00","#7f80cd","#b3e900","#c42e60","#a65628","#f781bf","#8dd3c7","#bebada","#fb8072","#80b1d3","#fdb462","#fccde5","#bc80bd","#ffed6f","#c4eaff","#cf8c00","#1b9e77","#d95f02","#e7298a","#e6ab02","#a6761d","#0097ff","#00d067","#f43600","#4ba93b","#5779bb","#927acc","#97ee3f","#bf3947","#9f5b00","#f48758","#8caed6","#f2b94f","#eff26e","#e43872","#d9b100","#9d7a00","#698cff","#d9d9d9","#00d27e","#d06800","#009f82","#c49200","#cbe8ff","#fecddf","#c27eb6","#8cd2ce","#c4b8d9","#f883b0","#a49100","#f48800","#27d0df","#a04a9b"];function r(t){return i[t%i.length]}function s(t,e){var a=e.getPropertyValue("--graph-color-".concat(t+1))||r(t);return(0,n.RQ)(a)}},56136:function(t,e,a){a.d(e,{a:function(){return n}});var n=function(t){return!(t.native instanceof MouseEvent)||t.native instanceof PointerEvent&&"mouse"!==t.native.pointerType}},23469:function(t,e,a){a.d(e,{g:function(){return r}});a(79641);var n=a(45253),i=a(92164);function r(t,e,a,r,s,o){var d=t.getPropertyValue(s+"-"+o).trim(),c=d.length>0?d:t.getPropertyValue(s).trim(),u=(0,n.RQ)(c);return 0===d.length&&o&&(u=(0,n.v2)((0,n.BE)(e?(0,i.T)((0,n.Nc)((0,n.xp)(u)),o):(0,i.d)((0,n.Nc)((0,n.xp)(u)),o)))),r?u+=a?"32":"7F":a&&(u+="7F"),u}},37334:function(t,e,a){var n=a(22858).A,i=a(33994).A;a.a(t,function(){var t=n(i().mark((function t(n,r){var s,o,d,c,u,f,h,l,p,v,k,m,_;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,_=function(t,e,a,n,i,r,s){var o=(0,c.c)(e,t),d=void 0!==r&&void 0!==s;if(d&&o<=35){var v=(0,u.M)(e,t),k=(0,u.M)(s,r);k>v?e=(0,f.L)(e,k-v):v>k&&(s=(0,f.L)(s,v-k))}var _={parsing:!1,animation:!1,interaction:{mode:"x"},scales:{x:{type:"time",suggestedMin:t.getTime(),max:m(o,e),adapters:{date:{locale:a,config:n}},ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,font:function(t){return t.tick&&t.tick.major?{weight:"bold"}:{}}},time:{tooltipFormat:o>35?"monthyear":o>7?"date":o>2?"weekday":o>0?"datetime":"hour",minUnit:o>35?"month":o>2?"day":"hour"}},y:{stacked:!0,type:"linear",title:{display:!0,text:i},ticks:{beginAtZero:!0,callback:function(t){return(0,h.ZV)(Math.abs(t),a)}}}},plugins:{tooltip:{position:"nearest",filter:function(t){return"0"!==t.formattedValue},itemSort:function(t,e){return e.datasetIndex-t.datasetIndex},callbacks:{title:function(t){if(o>0)return t[0].label;var e=new Date(t[0].parsed.x);return"".concat(d?"".concat((0,l.sl)(e,a,n),": "):"").concat((0,p.fU)(e,a,n)," â€“ ").concat((0,p.fU)((0,f.L)(e,1),a,n))},label:function(t){return"".concat(t.dataset.label,": ").concat((0,h.ZV)(t.parsed.y,a)," ").concat(i)}}},filler:{propagate:!1},legend:{display:!1,labels:{usePointStyle:!0}}},elements:{bar:{borderWidth:1.5,borderRadius:4},point:{hitRadius:50}},locale:(0,h.Yf)(a)};return d&&(_.scales.xAxisCompare=Object.assign(Object.assign({},_.scales.x),{},{suggestedMin:r.getTime(),max:m(o,s),display:!1})),_},m=function(t,e){var a=new Date(e);return t>2&&0===a.getHours()&&(a=(0,d.O)(a,1)),a.setMinutes(0,0,0),t>35&&a.setDate(1),t>2&&a.setHours(0),a.getTime()},a.d(e,{o:function(){return _}}),s=a(81027),o=a(26098),d=a(65513),c=a(31195),u=a(6711),f=a(83324),h=a(57636),l=a(57289),p=a(41924),!(v=n([h,l,p])).then){t.next=23;break}return t.next=19,v;case 19:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=24;break;case 23:t.t0=v;case 24:k=t.t0,h=k[0],l=k[1],p=k[2],r(),t.next=34;break;case 31:t.prev=31,t.t2=t.catch(0),r(t.t2);case 34:case"end":return t.stop()}}),t,null,[[0,31]])})));return function(e,a){return t.apply(this,arguments)}}())},1799:function(t,e,a){var n=a(22858).A,i=a(33994).A;a.a(t,function(){var t=n(i().mark((function t(n,r){var s,o,d,c,u,f,h,l,p,v,k,m,_,g,b,y,x,A,S,D,w,E,C,M,I,O,U,j,F,H,P,z,R,T,V,L,N,W,Z,q,Q,Y,$,B,G,J,K,X;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a.r(e),a.d(e,{HuiEnergyDevicesDetailGraphCard:function(){return X}}),s=a(64782),o=a(41981),d=a(64599),c=a(35806),u=a(71008),f=a(62193),h=a(2816),l=a(27927),p=a(81027),v=a(13025),k=a(82386),m=a(39805),_=a(97741),g=a(89655),b=a(33231),y=a(50693),x=a(29193),A=a(26098),S=a(10507),D=a(39790),w=a(36604),E=a(253),C=a(2075),M=a(54846),I=a(16891),O=a(66555),U=a(79784),j=a(75697),F=a(50289),H=a(29818),P=a(85323),z=a(94100),R=a(46999),T=a(23469),a(13082),V=a(47076),L=a(4826),N=a(20712),W=a(7934),Z=a(37334),q=a(34897),Q=a(96979),Y=a(56136),!($=n([V,Z])).then){t.next=72;break}return t.next=68,$;case 68:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=73;break;case 72:t.t0=$;case 73:B=t.t0,V=B[0],Z=B[1],X=(0,l.A)([(0,H.EM)("hui-energy-devices-detail-graph-card")],(function(t,e){var a=function(e){function a(){var e;(0,u.A)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e=(0,f.A)(this,a,[].concat(i)),t(e),e}return(0,h.A)(a,e),(0,c.A)(a)}(e);return{F:a,d:[{kind:"field",decorators:[(0,H.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,H.wk)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,H.wk)()],key:"_chartData",value:function(){return{datasets:[]}}},{kind:"field",decorators:[(0,H.wk)()],key:"_chartDatasetExtra",value:function(){return[]}},{kind:"field",decorators:[(0,H.wk)()],key:"_data",value:void 0},{kind:"field",decorators:[(0,H.wk)()],key:"_start",value:function(){return(0,U.R)()}},{kind:"field",decorators:[(0,H.wk)()],key:"_end",value:function(){return(0,j.o)()}},{kind:"field",decorators:[(0,H.wk)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,H.wk)()],key:"_compareEnd",value:void 0},{kind:"field",decorators:[(0,Q.I)({key:"energy-devices-hidden-stats",state:!0,subscribe:!1})],key:"_hiddenStats",value:function(){return[]}},{kind:"field",key:"_untrackedIndex",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:function(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var t,e=this;return[(0,V.tb)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((function(t){e._data=t,e._processStatistics()}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,W.xP)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"willUpdate",value:function(t){(t.has("_hiddenStats")||t.has("_config"))&&this._data&&this._processStatistics()}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?(0,F.qy)(G||(G=(0,d.A)([" <ha-card> ",' <div class="content ','"> <ha-chart-base externalHidden .hass="','" .data="','" .extraData="','" .options="','" chart-type="bar" @dataset-hidden="','" @dataset-unhidden="','"></ha-chart-base> </div> </ha-card> '])),this._config.title?(0,F.qy)(J||(J=(0,d.A)(['<h1 class="card-header">',"</h1>"])),this._config.title):"",(0,P.H)({"has-header":!!this._config.title}),this.hass,this._chartData,this._chartDatasetExtra,this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,"kWh",this._compareStart,this._compareEnd),this._datasetHidden,this._datasetUnhidden):F.s6}},{kind:"method",key:"_datasetHidden",value:function(t){var e=t.detail.index===this._untrackedIndex?"untracked":this._data.prefs.device_consumption[t.detail.index].stat_consumption;this._hiddenStats=[].concat((0,o.A)(this._hiddenStats),[e])}},{kind:"method",key:"_datasetUnhidden",value:function(t){var e=t.detail.index===this._untrackedIndex?"untracked":this._data.prefs.device_consumption[t.detail.index].stat_consumption;this._hiddenStats=this._hiddenStats.filter((function(t){return t!==e}))}},{kind:"field",key:"_createOptions",value:function(){var t=this;return(0,z.A)((function(e,a,n,i,r,s,o){var d=(0,Z.o)(e,a,n,i,r,s,o);return Object.assign(Object.assign({},d),{},{interaction:{mode:"nearest"},plugins:Object.assign(Object.assign({},d.plugins),{},{legend:{display:!0,labels:{usePointStyle:!0}}}),onClick:function(e,a,n){var i,r,s,o;if(!(0,Y.a)(e)){var d=null!==(i=null===(r=a[0])||void 0===r?void 0:r.datasetIndex)&&void 0!==i?i:-1;if(!(d<0)){var c=null===(s=t._data)||void 0===s||null===(s=s.prefs.device_consumption[d])||void 0===s?void 0:s.stat_consumption;c&&!(0,L.OQ)(c)&&((0,q.r)(t,"hass-more-info",{entityId:c}),null==n||null===(o=n.canvas)||void 0===o||o.dispatchEvent(new Event("mouseout")))}}}})}))}},{kind:"method",key:"_processStatistics",value:function(){var t=this._data,e=t.stats,a=t.statsCompare,n=getComputedStyle(this),i={};t.prefs.device_consumption.forEach((function(t){var a=t.stat_consumption in e&&(0,L.$j)(e[t.stat_consumption])||0;i[t.stat_consumption]=a}));var r=t.prefs.device_consumption.map((function(t){return t.stat_consumption}));r.sort((function(t,e){return i[e]-i[t]}));var s=[],d=[],c=this._processDataSet(n,e,t.statsMetadata,t.prefs.device_consumption,r),u=c.data,f=c.dataExtras;s.push.apply(s,(0,o.A)(u)),d.push.apply(d,(0,o.A)(f));var h=(0,V.gv)(t),l=h.summedData,p=h.compareSummedData,v="from_grid"in l||"solar"in l||"from_battery"in l,k=v?(0,V.DR)(l,p):{consumption:void 0,compareConsumption:void 0},m=k.consumption,_=k.compareConsumption;if(v){this._untrackedIndex=s.length;var g=this._processUntracked(n,u,m,!1),b=g.dataset,y=g.datasetExtra;s.push(b),d.push(y)}if(a){s.push({order:0,data:[]}),d.push({show_legend:!1}),s.push({order:999,data:[],xAxisID:"xAxisCompare"}),d.push({show_legend:!1});var x=this._processDataSet(n,a,t.statsMetadata,t.prefs.device_consumption,r,!0),A=x.data,S=x.dataExtras;if(s.push.apply(s,(0,o.A)(A)),d.push.apply(d,(0,o.A)(S)),v){var D=this._processUntracked(n,A,_,!0),w=D.dataset,E=D.datasetExtra;s.push(w),d.push(E)}}this._start=t.start,this._end=t.end||(0,j.o)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare,this._chartData={datasets:s},this._chartDatasetExtra=d}},{kind:"method",key:"_processUntracked",value:function(t,e,a,n){var i={};e.forEach((function(t){t.data.forEach((function(t){i[t.x]=(i[t.x]||0)+t.y}))}));var r=[];return Object.keys(a.total).forEach((function(t){r.push({x:Number(t),y:a.total[t]-(i[t]||0)})})),{dataset:{label:this.hass.localize("ui.panel.lovelace.cards.energy.energy_devices_detail_graph.untracked_consumption"),hidden:this._hiddenStats.includes("untracked"),borderColor:(0,T.g)(t,this.hass.themes.darkMode,!1,n,"--state-unavailable-color"),backgroundColor:(0,T.g)(t,this.hass.themes.darkMode,!0,n,"--state-unavailable-color"),data:r,order:1+this._untrackedIndex,stack:"devices",pointStyle:!n&&"circle",xAxisID:n?"xAxisCompare":void 0},datasetExtra:{show_legend:!n}}}},{kind:"method",key:"_processDataSet",value:function(t,e,a,n,i){var r=this,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],d=[],c=[];return n.forEach((function(n,u){var f,h=(0,R.fI)(u,t),l=null,p=[];if(n.stat_consumption in e){var v,k,m=e[n.stat_consumption],_=(0,s.A)(m);try{for(_.s();!(k=_.n()).done;){var g=k.value;if(null!==g.change&&void 0!==g.change&&l!==g.start){var b=new Date(g.start);p.push({x:b.getTime(),y:g.change}),l=g.start,v=g.end}}}catch(A){_.e(A)}finally{_.f()}1===p.length&&p.push({x:v,y:0})}var y=i.indexOf(n.stat_consumption),x=!!(null!==(f=r._config)&&void 0!==f&&f.max_devices&&y>=r._config.max_devices);d.push({label:n.name||(0,L.$O)(r.hass,n.stat_consumption,a[n.stat_consumption]),hidden:r._hiddenStats.includes(n.stat_consumption)||x,borderColor:o?h+"7F":h,backgroundColor:o?h+"32":h+"7F",data:p,order:1+y,stack:"devices",pointStyle:!o&&"circle",xAxisID:o?"xAxisCompare":void 0}),c.push({show_legend:!o&&!x})})),{data:d,dataExtras:c}}},{kind:"get",static:!0,key:"styles",value:function(){return(0,F.AH)(K||(K=(0,d.A)([".card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}"])))}}]}}),(0,N.E)(F.WF)),r(),t.next=84;break;case 81:t.prev=81,t.t2=t.catch(0),r(t.t2);case 84:case"end":return t.stop()}}),t,null,[[0,81]])})));return function(e,a){return t.apply(this,arguments)}}())},24226:function(t,e,a){a.d(e,{z:function(){return i}});var n=a(30429);function i(t,e){var a=(0,n.a)(t),i=(0,n.a)(e),r=a.getTime()-i.getTime();return r<0?-1:r>0?1:r}},72730:function(t,e,a){a.d(e,{W:function(){return o}});a(29193);var n=a(24226),i=a(30429);function r(t,e){var a=(0,i.a)(t),n=(0,i.a)(e);return 12*(a.getFullYear()-n.getFullYear())+(a.getMonth()-n.getMonth())}var s=a(91103);function o(t,e){var a,o=(0,i.a)(t),d=(0,i.a)(e),c=(0,n.z)(o,d),u=Math.abs(r(o,d));if(u<1)a=0;else{1===o.getMonth()&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-c*u);var f=(0,n.z)(o,d)===-c;(0,s.c)((0,i.a)(t))&&1===u&&1===(0,n.z)(t,d)&&(f=!1),a=c*(u-Number(f))}return 0===a?0:a}},75697:function(t,e,a){a.d(e,{o:function(){return i}});var n=a(60132);function i(){return(0,n.D)(Date.now())}},77301:function(t,e,a){a.d(e,{e:function(){return i}});var n=a(30429);function i(t){return 1===(0,n.a)(t).getDate()}},91103:function(t,e,a){a.d(e,{c:function(){return s}});var n=a(60132),i=a(12152),r=a(30429);function s(t){var e=(0,r.a)(t);return+(0,n.D)(e)==+(0,i.p)(e)}},65513:function(t,e,a){a.d(e,{O:function(){return i}});var n=a(83324);function i(t,e){return(0,n.L)(t,-e)}}}]);
//# sourceMappingURL=21914.5bCQrcilws8.js.map