"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[99396],{97247:function(e,t,i){i.d(t,{$O:function(){return Y},Bm:function(){return g},Cr:function(){return O},Cy:function(){return a},DE:function(){return d},DJ:function(){return m},EZ:function(){return w},Eo:function(){return W},Hz:function(){return o},Is:function(){return f},JZ:function(){return H},Lx:function(){return P},PY:function(){return Z},S0:function(){return L},SG:function(){return p},TH:function(){return x},Tx:function(){return N},U:function(){return K},VL:function(){return u},Ve:function(){return J},W6:function(){return E},YP:function(){return A},Yn:function(){return S},aG:function(){return q},aL:function(){return c},au:function(){return _},dZ:function(){return h},fC:function(){return M},iK:function(){return b},in:function(){return B},jF:function(){return F},jT:function(){return D},lz:function(){return y},mQ:function(){return C},mR:function(){return U},mX:function(){return G},of:function(){return Q},qN:function(){return z},re:function(){return j},sM:function(){return l},sb:function(){return I},tj:function(){return T},u1:function(){return s},wI:function(){return k},zI:function(){return v},zP:function(){return R},zb:function(){return V}});var n=i(33994),r=i(22858),s=(i(64017),i(71499),i(39790),i(7760),function(e){return e[e.Idle=0]="Idle",e[e.Including=1]="Including",e[e.Excluding=2]="Excluding",e[e.Busy=3]="Busy",e[e.SmartStart=4]="SmartStart",e}({})),a=function(e){return e[e.Default=0]="Default",e[e.SmartStart=1]="SmartStart",e[e.Insecure=2]="Insecure",e[e.Security_S0=3]="Security_S0",e[e.Security_S2=4]="Security_S2",e}({}),o=function(e){return e[e.Temporary=-2]="Temporary",e[e.None=-1]="None",e[e.S2_Unauthenticated=0]="S2_Unauthenticated",e[e.S2_Authenticated=1]="S2_Authenticated",e[e.S2_AccessControl=2]="S2_AccessControl",e[e.S0_Legacy=7]="S0_Legacy",e}({}),c=function(e){return e[e.SmartStart=0]="SmartStart",e}({}),u=function(e){return e[e.Error_Timeout=-1]="Error_Timeout",e[e.Error_Checksum=0]="Error_Checksum",e[e.Error_TransmissionFailed=1]="Error_TransmissionFailed",e[e.Error_InvalidManufacturerID=2]="Error_InvalidManufacturerID",e[e.Error_InvalidFirmwareID=3]="Error_InvalidFirmwareID",e[e.Error_InvalidFirmwareTarget=4]="Error_InvalidFirmwareTarget",e[e.Error_InvalidHeaderInformation=5]="Error_InvalidHeaderInformation",e[e.Error_InvalidHeaderFormat=6]="Error_InvalidHeaderFormat",e[e.Error_InsufficientMemory=7]="Error_InsufficientMemory",e[e.Error_InvalidHardwareVersion=8]="Error_InvalidHardwareVersion",e[e.OK_WaitingForActivation=253]="OK_WaitingForActivation",e[e.OK_NoRestart=254]="OK_NoRestart",e[e.OK_RestartPending=255]="OK_RestartPending",e}({}),d=function(e){return e[e.Error_Timeout=0]="Error_Timeout",e[e.Error_RetryLimitReached=1]="Error_RetryLimitReached",e[e.Error_Aborted=2]="Error_Aborted",e[e.Error_NotSupported=3]="Error_NotSupported",e[e.OK=255]="OK",e}({}),l=52,_=function(e){return e[e.NotAvailable=127]="NotAvailable",e[e.ReceiverSaturated=126]="ReceiverSaturated",e[e.NoSignalDetected=125]="NoSignalDetected",e}({}),h=function(e){return e[e.ZWave_9k6=1]="ZWave_9k6",e[e.ZWave_40k=2]="ZWave_40k",e[e.ZWave_100k=3]="ZWave_100k",e[e.LongRange_100k=4]="LongRange_100k",e}({}),v=function(e){return e[e.Unknown=0]="Unknown",e[e.Asleep=1]="Asleep",e[e.Awake=2]="Awake",e[e.Dead=3]="Dead",e[e.Alive=4]="Alive",e}({}),f=function(e,t){if(t.device_id&&t.entry_id)throw new Error("Only one of device or entry ID should be supplied.");if(!t.device_id&&!t.entry_id)throw new Error("Either device or entry ID should be supplied.");return e.callWS({type:"zwave_js/network_status",device_id:t.device_id,entry_id:t.entry_id})},p=function(e,t){return e.callWS({type:"zwave_js/data_collection_status",entry_id:t})},y=function(e,t,i){return e.callWS({type:"zwave_js/update_data_collection_preference",entry_id:t,opted_in:i})},g=function(e,t){return e.callWS({type:"zwave_js/get_provisioning_entries",entry_id:t})},m=function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a.Default,r=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0;return e.connection.subscribeMessage((function(e){return i(e)}),{type:"zwave_js/add_node",entry_id:t,inclusion_strategy:n,qr_code_string:s,qr_provisioning_information:r,planned_provisioning_entry:o,dsk:c})},k=function(e,t){return e.callWS({type:"zwave_js/stop_inclusion",entry_id:t})},w=function(e,t){return e.callWS({type:"zwave_js/stop_exclusion",entry_id:t})},b=function(e,t,i,n){return e.callWS({type:"zwave_js/grant_security_classes",entry_id:t,securityClasses:i,clientSideAuth:n})},S=function(e,t,i){return e.callWS({type:"zwave_js/try_parse_dsk_from_qr_code_string",entry_id:t,qr_code_string:i})},A=function(e,t,i){return e.callWS({type:"zwave_js/validate_dsk_and_enter_pin",entry_id:t,pin:i})},z=function(e,t,i){return e.callWS({type:"zwave_js/supports_feature",entry_id:t,feature:i})},x=function(e,t,i){return e.callWS({type:"zwave_js/parse_qr_code_string",entry_id:t,qr_code_string:i})},q=function(e,t,i,n,r){return e.callWS({type:"zwave_js/provision_smart_start_node",entry_id:t,qr_code_string:n,qr_provisioning_information:i,planned_provisioning_entry:r})},H=function(e,t,i,n){return e.callWS({type:"zwave_js/unprovision_smart_start_node",entry_id:t,dsk:i,node_id:n})},C=function(e,t){return e.callWS({type:"zwave_js/node_status",device_id:t})},I=function(e,t,i){return e.connection.subscribeMessage((function(e){return i(e)}),{type:"zwave_js/subscribe_node_status",device_id:t})},j=function(e,t){return e.callWS({type:"zwave_js/node_metadata",device_id:t})},V=function(e,t){return e.callWS({type:"zwave_js/node_alerts",device_id:t})},E=function(e,t){return e.callWS({type:"zwave_js/get_config_parameters",device_id:t})},M=function(e,t,i,n,r,s){var a={type:"zwave_js/set_config_parameter",device_id:t,property:i,endpoint:n,value:r,property_key:s};return e.callWS(a)},W=function(e,t,i){return e.connection.subscribeMessage((function(e){return i(e)}),{type:"zwave_js/refresh_node_info",device_id:t})},D=function(e,t){return e.callWS({type:"zwave_js/rebuild_node_routes",device_id:t})},T=function(e,t,i){return e.connection.subscribeMessage((function(e){return i(e)}),{type:"zwave_js/remove_failed_node",device_id:t})},P=function(e,t){return e.callWS({type:"zwave_js/begin_rebuilding_routes",entry_id:t})},N=function(e,t){return e.callWS({type:"zwave_js/stop_rebuilding_routes",entry_id:t})},L=function(e,t,i){return e.connection.subscribeMessage((function(e){return i(e)}),{type:"zwave_js/subscribe_rebuild_routes_progress",entry_id:t})},R=function(e,t,i){return e.connection.subscribeMessage((function(e){return i(e)}),{type:"zwave_js/subscribe_controller_statistics",entry_id:t})},F=function(e,t,i){return e.connection.subscribeMessage((function(e){return i(e)}),{type:"zwave_js/subscribe_node_statistics",device_id:t})},O=function(e,t){return e.callWS({type:"zwave_js/is_node_firmware_update_in_progress",device_id:t})},K=function(e,t){return e.callWS({type:"zwave_js/is_any_ota_firmware_update_in_progress",entry_id:t})},Z=function(e,t){return e.callWS({type:"zwave_js/hard_reset_controller",entry_id:t})},U=function(){var e=(0,r.A)((0,n.A)().mark((function e(t,i,r,s){var a,o;return(0,n.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("file",r),void 0!==s&&a.append("target",s.toString()),e.next=5,t.fetchWithAuth("/api/zwave_js/firmware/upload/".concat(i),{method:"POST",body:a});case 5:if(200===(o=e.sent).status){e.next=8;break}throw new Error(o.statusText);case 8:case"end":return e.stop()}}),e)})));return function(t,i,n,r){return e.apply(this,arguments)}}(),G=function(e,t,i){return e.connection.subscribeMessage((function(e){return i(e)}),{type:"zwave_js/subscribe_firmware_update_status",device_id:t})},Q=function(e,t){return e.callWS({type:"zwave_js/abort_firmware_update",device_id:t})},B=function(e,t,i){return e.connection.subscribeMessage(i,{type:"zwave_js/subscribe_log_updates",entry_id:t})},Y=function(e,t){return e.callWS({type:"zwave_js/get_log_config",entry_id:t})},J=function(e,t,i){return e.callWS({type:"zwave_js/update_log_config",entry_id:t,config:{level:i}})}},99396:function(e,t,i){i.r(t);var n,r,s,a,o,c,u,d,l,_,h,v,f,p,y,g,m,k,w,b,S,A,z,x,q,H,C,I,j,V,E=i(41981),M=i(64599),W=i(33994),D=i(22858),T=i(35806),P=i(71008),N=i(62193),L=i(2816),R=i(27927),F=i(35890),O=(i(81027),i(13025),i(82386),i(97741),i(33231),i(29193),i(39790),i(36604),i(92765),i(253),i(2075),i(16891),i(72606),i(50289)),K=i(29818),Z=i(10977),U=i(34897),G=(i(13292),i(32885),i(29180)),Q=(i(88725),i(24284),i(20024),i(51513),i(60203),i(90431),i(97247)),B=i(55321),Y="M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z";(0,R.A)([(0,K.EM)("dialog-zwave_js-add-node")],(function(e,t){var i,R,J,X,$,ee,te=function(t){function i(){var t;(0,P.A)(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t=(0,N.A)(this,i,[].concat(r)),e(t),t}return(0,L.A)(i,t),(0,T.A)(i)}(t);return{F:te,d:[{kind:"field",decorators:[(0,K.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,K.wk)()],key:"_params",value:void 0},{kind:"field",decorators:[(0,K.wk)()],key:"_entryId",value:void 0},{kind:"field",decorators:[(0,K.wk)()],key:"_status",value:void 0},{kind:"field",decorators:[(0,K.wk)()],key:"_device",value:void 0},{kind:"field",decorators:[(0,K.wk)()],key:"_stages",value:void 0},{kind:"field",decorators:[(0,K.wk)()],key:"_inclusionStrategy",value:void 0},{kind:"field",decorators:[(0,K.wk)()],key:"_dsk",value:void 0},{kind:"field",decorators:[(0,K.wk)()],key:"_error",value:void 0},{kind:"field",decorators:[(0,K.wk)()],key:"_requestedGrant",value:void 0},{kind:"field",decorators:[(0,K.wk)()],key:"_securityClasses",value:function(){return[]}},{kind:"field",decorators:[(0,K.wk)()],key:"_lowSecurity",value:function(){return!1}},{kind:"field",decorators:[(0,K.wk)()],key:"_supportsSmartStart",value:void 0},{kind:"field",key:"_addNodeTimeoutHandle",value:void 0},{kind:"field",key:"_subscribed",value:void 0},{kind:"field",key:"_qrProcessing",value:function(){return!1}},{kind:"method",key:"connectedCallback",value:function(){(0,F.A)(te,"connectedCallback",this,3)([]),window.addEventListener("beforeunload",this._onBeforeUnload)}},{kind:"method",key:"disconnectedCallback",value:function(){(0,F.A)(te,"disconnectedCallback",this,3)([]),this._unsubscribe()}},{kind:"method",key:"showDialog",value:(ee=(0,D.A)((0,W.A)().mark((function e(t){return(0,W.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._params=t,this._entryId=t.entry_id,this._status="loading",this._checkSmartStartSupport(),this._startInclusion();case 5:case"end":return e.stop()}}),e,this)}))),function(e){return ee.apply(this,arguments)})},{kind:"field",decorators:[(0,K.P)("#pin-input")],key:"_pinInput",value:void 0},{kind:"method",key:"render",value:function(){var e,t,i=this;if(!this._entryId)return O.s6;var V=this._shouldPreventClose(),E=this.hass.localize("ui.panel.config.zwave_js.add_node.title");return(0,O.qy)(n||(n=(0,M.A)([' <ha-dialog open @closed="','" .heading="','" scrimClickAction="','" escapeKeyAction="','"> '," </ha-dialog> "])),this.closeDialog,V?E:(0,G.l)(this.hass,E),(0,Z.J)(V?"":void 0),(0,Z.J)(V?"":void 0),"loading"===this._status?(0,O.qy)(r||(r=(0,M.A)(['<div style="display:flex;justify-content:center"> <ha-circular-progress size="large" indeterminate></ha-circular-progress> </div>']))):"waiting_for_device"===this._status?(0,O.qy)(s||(s=(0,M.A)(['<div class="flex-container"> <ha-circular-progress indeterminate></ha-circular-progress> <p> '," </p> </div>"])),this.hass.localize("ui.panel.config.zwave_js.add_node.waiting_for_device")):"choose_strategy"===this._status?(0,O.qy)(a||(a=(0,M.A)(['<h3>Choose strategy</h3> <div class="flex-column"> <ha-formfield .label="','"> <ha-radio name="strategy" @change="','" .value="','" .checked="','"> </ha-radio> </ha-formfield> <ha-formfield .label="','"> <ha-radio name="strategy" @change="','" .value="','" .checked="','"> </ha-radio> </ha-formfield> <ha-formfield .label="','"> <ha-radio name="strategy" @change="','" .value="','" .checked="','"> </ha-radio> </ha-formfield> </div> <mwc-button slot="primaryAction" @click="','"> Search device </mwc-button>'])),(0,O.qy)(o||(o=(0,M.A)(['<b>Secure if possible</b> <div class="secondary"> Requires user interaction during inclusion. Fast and secure with S2 when supported. Fallback to legacy S0 or no encryption when necessary. </div>']))),this._handleStrategyChange,Q.Cy.Default,this._inclusionStrategy===Q.Cy.Default||void 0===this._inclusionStrategy,(0,O.qy)(c||(c=(0,M.A)(['<b>Legacy Secure</b> <div class="secondary"> Uses the older S0 security that is secure, but slow due to a lot of overhead. Allows securely including S2 capable devices which fail to be included with S2. </div>']))),this._handleStrategyChange,Q.Cy.Security_S0,this._inclusionStrategy===Q.Cy.Security_S0,(0,O.qy)(u||(u=(0,M.A)(['<b>Insecure</b> <div class="secondary">Do not use encryption.</div>']))),this._handleStrategyChange,Q.Cy.Insecure,this._inclusionStrategy===Q.Cy.Insecure,this._startManualInclusion):"qr_scan"===this._status?(0,O.qy)(d||(d=(0,M.A)([' <ha-qr-scanner .hass="','" .localize="','" .error="','" @qr-code-scanned="','" @qr-code-error="','" @qr-code-closed="','"></ha-qr-scanner> <mwc-button slot="secondaryAction" @click="','"> '," </mwc-button>"])),this.hass,this.hass.localize,this._error,this._qrCodeScanned,this._qrCodeError,this._startOver,this._startOver,this.hass.localize("ui.panel.config.zwave_js.common.back")):"validate_dsk_enter_pin"===this._status?(0,O.qy)(l||(l=(0,M.A)([" <p> Please enter the 5-digit PIN for your device and verify that the rest of the device-specific key matches the one that can be found on your device or the manual. </p> ",' <div class="flex-container"> <ha-textfield label="PIN" id="pin-input" @keyup="','"></ha-textfield> ',' </div> <mwc-button slot="primaryAction" @click="','"> Submit </mwc-button> '])),this._error?(0,O.qy)(_||(_=(0,M.A)(['<ha-alert alert-type="error"> '," </ha-alert>"])),this._error):"",this._handlePinKeyUp,this._dsk,this._validateDskAndEnterPin):"grant_security_classes"===this._status?(0,O.qy)(h||(h=(0,M.A)([" <h3> The device has requested the following security classes: </h3> ",' <div class="flex-column"> ',' </div> <mwc-button slot="primaryAction" .disabled="','" @click="','"> Submit </mwc-button> '])),this._error?(0,O.qy)(v||(v=(0,M.A)(['<ha-alert alert-type="error">',"</ha-alert>"])),this._error):"",null===(e=this._requestedGrant)||void 0===e?void 0:e.securityClasses.sort((function(e,t){return e===Q.Hz.S0_Legacy?1:t===Q.Hz.S0_Legacy?-1:t-e})).map((function(e){return(0,O.qy)(f||(f=(0,M.A)(['<ha-formfield .label="','"> <ha-checkbox @change="','" .value="','" .checked="','"> </ha-checkbox> </ha-formfield>'])),(0,O.qy)(p||(p=(0,M.A)(["<b>",'</b> <div class="secondary"> '," </div>"])),i.hass.localize("ui.panel.config.zwave_js.security_classes.".concat(Q.Hz[e],".title")),i.hass.localize("ui.panel.config.zwave_js.security_classes.".concat(Q.Hz[e],".description"))),i._handleSecurityClassChange,e,i._securityClasses.includes(e))})),!this._securityClasses.length,this._grantSecurityClasses):"timed_out"===this._status?(0,O.qy)(y||(y=(0,M.A)([' <h3>Timed out!</h3> <p> We have not found any device in inclusion mode. Make sure the device is active and in inclusion mode. </p> <mwc-button slot="primaryAction" @click="','"> Retry </mwc-button> '])),this._startOver):"started_specific"===this._status?(0,O.qy)(g||(g=(0,M.A)(["<h3> "," </h3> <ha-circular-progress indeterminate></ha-circular-progress> <p> "," </p>"])),this.hass.localize("ui.panel.config.zwave_js.add_node.searching_device"),this.hass.localize("ui.panel.config.zwave_js.add_node.follow_device_instructions")):"started"===this._status?(0,O.qy)(m||(m=(0,M.A)([' <div class="select-inclusion"> <div class="outline"> <h2> '," </h2> <ha-circular-progress indeterminate></ha-circular-progress> <p> ",' </p> <p> <button class="link" @click="','"> '," </button> </p> </div> ",' </div> <mwc-button slot="primaryAction" @click="','"> '," </mwc-button> "])),this.hass.localize("ui.panel.config.zwave_js.add_node.searching_device"),this.hass.localize("ui.panel.config.zwave_js.add_node.follow_device_instructions"),this._chooseInclusionStrategy,this.hass.localize("ui.panel.config.zwave_js.add_node.choose_inclusion_strategy"),this._supportsSmartStart?(0,O.qy)(k||(k=(0,M.A)(['<div class="outline"> <h2> ',' </h2> <ha-svg-icon .path="','"></ha-svg-icon> <p> ',' </p> <p> <mwc-button @click="','"> '," </mwc-button> </p> </div>"])),this.hass.localize("ui.panel.config.zwave_js.add_node.qr_code"),"M4,4H10V10H4V4M20,4V10H14V4H20M14,15H16V13H14V11H16V13H18V11H20V13H18V15H20V18H18V20H16V18H13V20H11V16H14V15M16,15V18H18V15H16M4,20V14H10V20H4M6,6V8H8V6H6M16,6V8H18V6H16M6,16V18H8V16H6M4,11H6V13H4V11M9,11H13V15H11V13H9V11M11,6H13V10H11V6M2,2V6H0V2A2,2 0 0,1 2,0H6V2H2M22,0A2,2 0 0,1 24,2V6H22V2H18V0H22M2,18V22H6V24H2A2,2 0 0,1 0,22V18H2M22,22V18H24V22A2,2 0 0,1 22,24H18V22H22Z",this.hass.localize("ui.panel.config.zwave_js.add_node.qr_code_paragraph"),this._scanQRCode,this.hass.localize("ui.panel.config.zwave_js.add_node.scan_qr_code")):"",this.closeDialog,this.hass.localize("ui.common.cancel")):"interviewing"===this._status?(0,O.qy)(w||(w=(0,M.A)([' <div class="flex-container"> <ha-circular-progress indeterminate></ha-circular-progress> <div class="status"> <p> <b>',"</b> </p> ",' </div> </div> <mwc-button slot="primaryAction" @click="','"> '," </mwc-button> "])),this.hass.localize("ui.panel.config.zwave_js.add_node.interview_started"),this._stages?(0,O.qy)(b||(b=(0,M.A)([' <div class="stages"> '," </div>"])),this._stages.map((function(e){return(0,O.qy)(S||(S=(0,M.A)([' <span class="stage"> <ha-svg-icon .path="','" class="success"></ha-svg-icon> '," </span> "])),Y,e)}))):"",this.closeDialog,this.hass.localize("ui.common.close")):"failed"===this._status?(0,O.qy)(A||(A=(0,M.A)([' <div class="flex-container"> <div class="status"> <ha-alert alert-type="error" .title="','"> '," </ha-alert> ",' </div> </div> <mwc-button slot="primaryAction" @click="','"> '," </mwc-button> "])),this.hass.localize("ui.panel.config.zwave_js.add_node.inclusion_failed"),this._error||this.hass.localize("ui.panel.config.zwave_js.add_node.check_logs"),this._stages?(0,O.qy)(z||(z=(0,M.A)([' <div class="stages"> '," </div>"])),this._stages.map((function(e){return(0,O.qy)(x||(x=(0,M.A)([' <span class="stage"> <ha-svg-icon .path="','" class="success"></ha-svg-icon> '," </span> "])),Y,e)}))):"",this.closeDialog,this.hass.localize("ui.common.close")):"finished"===this._status?(0,O.qy)(q||(q=(0,M.A)([' <div class="flex-container"> <ha-svg-icon .path="','" class="','"></ha-svg-icon> <div class="status"> <p> '," </p> ",' <a href="','"> <mwc-button> '," </mwc-button> </a> ",' </div> </div> <mwc-button slot="primaryAction" @click="','"> '," </mwc-button> "])),this._lowSecurity?"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z":Y,this._lowSecurity?"warning":"success",this.hass.localize("ui.panel.config.zwave_js.add_node.inclusion_finished"),this._lowSecurity?(0,O.qy)(H||(H=(0,M.A)(['<ha-alert alert-type="warning" title="The device was added insecurely"> There was an error during secure inclusion. You can try again by excluding the device and adding it again. </ha-alert>']))):"","/config/devices/device/".concat(null===(t=this._device)||void 0===t?void 0:t.id),this.hass.localize("ui.panel.config.zwave_js.add_node.view_device"),this._stages?(0,O.qy)(C||(C=(0,M.A)([' <div class="stages"> '," </div>"])),this._stages.map((function(e){return(0,O.qy)(I||(I=(0,M.A)([' <span class="stage"> <ha-svg-icon .path="','" class="success"></ha-svg-icon> '," </span> "])),Y,e)}))):"",this.closeDialog,this.hass.localize("ui.common.close")):"provisioned"===this._status?(0,O.qy)(j||(j=(0,M.A)([' <div class="flex-container"> <ha-svg-icon .path="','" class="success"></ha-svg-icon> <div class="status"> <p> ',' </p> </div> </div> <mwc-button slot="primaryAction" @click="','"> '," </mwc-button>"])),Y,this.hass.localize("ui.panel.config.zwave_js.add_node.provisioning_finished"),this.closeDialog,this.hass.localize("ui.common.close")):"")}},{kind:"method",key:"_shouldPreventClose",value:function(){return"started_specific"===this._status||"validate_dsk_enter_pin"===this._status||"grant_security_classes"===this._status||"waiting_for_device"===this._status}},{kind:"method",key:"_chooseInclusionStrategy",value:function(){this._unsubscribe(),this._status="choose_strategy"}},{kind:"method",key:"_handleStrategyChange",value:function(e){this._inclusionStrategy=e.target.value}},{kind:"method",key:"_handleSecurityClassChange",value:function(e){var t=e.currentTarget,i=Number(t.value);t.checked&&!this._securityClasses.includes(i)?this._securityClasses=[].concat((0,E.A)(this._securityClasses),[i]):t.checked||(this._securityClasses=this._securityClasses.filter((function(e){return e!==i})))}},{kind:"method",key:"_scanQRCode",value:($=(0,D.A)((0,W.A)().mark((function e(){return(0,W.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._unsubscribe(),this._status="qr_scan";case 2:case"end":return e.stop()}}),e,this)}))),function(){return $.apply(this,arguments)})},{kind:"method",key:"_qrCodeScanned",value:function(e){this._qrProcessing||this._handleQrCodeScanned(e.detail.value)}},{kind:"method",key:"_qrCodeError",value:function(e){this._error=e.detail.message}},{kind:"method",key:"_handleQrCodeScanned",value:(X=(0,D.A)((0,W.A)().mark((function e(t){var i,n,r,s=this;return(0,W.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._error=void 0,"qr_scan"===this._status&&!this._qrProcessing){e.next=3;break}return e.abrupt("return");case 3:return this._qrProcessing=!0,e.next=6,(0,Q.Yn)(this.hass,this._entryId,t);case 6:if(!(i=e.sent)){e.next=13;break}return this._status="loading",this.updateComplete.then((function(){s._qrProcessing=!1})),this._inclusionStrategy=Q.Cy.Security_S2,this._startInclusion(void 0,i),e.abrupt("return");case 13:if(!(t.length<Q.sM)&&t.startsWith("90")){e.next=17;break}return this._qrProcessing=!1,this._error="Invalid QR code (".concat(t,")"),e.abrupt("return");case 17:return e.prev=17,e.next=20,(0,Q.TH)(this.hass,this._entryId,t);case 20:n=e.sent,e.next=28;break;case 23:return e.prev=23,e.t0=e.catch(17),this._qrProcessing=!1,this._error=e.t0.message,e.abrupt("return");case 28:if(this._status="loading",this.updateComplete.then((function(){s._qrProcessing=!1})),1!==n.version){e.next=44;break}return e.prev=31,e.next=34,(0,Q.aG)(this.hass,this._entryId,n);case 34:this._status="provisioned",null!==(r=this._params)&&void 0!==r&&r.addedCallback&&this._params.addedCallback(),e.next=42;break;case 38:e.prev=38,e.t1=e.catch(31),this._error=e.t1.message,this._status="failed";case 42:e.next=45;break;case 44:0===n.version?(this._inclusionStrategy=Q.Cy.Security_S2,this._startInclusion(n)):(this._error="This QR code is not supported",this._status="failed");case 45:case"end":return e.stop()}}),e,this,[[17,23],[31,38]])}))),function(e){return X.apply(this,arguments)})},{kind:"method",key:"_handlePinKeyUp",value:function(e){"Enter"===e.key&&this._validateDskAndEnterPin()}},{kind:"method",key:"_validateDskAndEnterPin",value:(J=(0,D.A)((0,W.A)().mark((function e(){var t;return(0,W.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._status="waiting_for_device",this._error=void 0,e.prev=2,e.next=5,(0,Q.YP)(this.hass,this._entryId,this._pinInput.value);case 5:e.next=14;break;case 7:return e.prev=7,e.t0=e.catch(2),this._error=e.t0.message,this._status="validate_dsk_enter_pin",e.next=13,this.updateComplete;case 13:null===(t=this._pinInput)||void 0===t||t.focus();case 14:case"end":return e.stop()}}),e,this,[[2,7]])}))),function(){return J.apply(this,arguments)})},{kind:"method",key:"_grantSecurityClasses",value:(R=(0,D.A)((0,W.A)().mark((function e(){return(0,W.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._status="waiting_for_device",this._error=void 0,e.prev=2,e.next=5,(0,Q.iK)(this.hass,this._entryId,this._securityClasses);case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(2),this._error=e.t0.message,this._status="grant_security_classes";case 11:case"end":return e.stop()}}),e,this,[[2,7]])}))),function(){return R.apply(this,arguments)})},{kind:"method",key:"_startManualInclusion",value:function(){this._inclusionStrategy||(this._inclusionStrategy=Q.Cy.Default),this._startInclusion()}},{kind:"method",key:"_checkSmartStartSupport",value:(i=(0,D.A)((0,W.A)().mark((function e(){return(0,W.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,Q.qN)(this.hass,this._entryId,Q.aL.SmartStart);case 2:this._supportsSmartStart=e.sent.supported;case 3:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{kind:"method",key:"_startOver",value:function(e){this._startInclusion()}},{kind:"method",key:"_startInclusion",value:function(e,t){var i=this;if(this.hass){this._lowSecurity=!1;var n=e||t;this._subscribed=(0,Q.DJ)(this.hass,this._entryId,(function(e){if("inclusion started"===e.event&&(i._status=n?"started_specific":"started"),"inclusion failed"===e.event&&(i._unsubscribe(),i._status="failed"),"inclusion stopped"===e.event&&(i._addNodeTimeoutHandle&&clearTimeout(i._addNodeTimeoutHandle),i._addNodeTimeoutHandle=void 0),"node found"===e.event&&(i._status="waiting_for_device"),"validate dsk and enter pin"===e.event&&(i._status="validate_dsk_enter_pin",i._dsk=e.dsk),"grant security classes"===e.event){if(void 0===i._inclusionStrategy)return void(0,Q.iK)(i.hass,i._entryId,e.requested_grant.securityClasses,e.requested_grant.clientSideAuth);i._requestedGrant=e.requested_grant,i._securityClasses=e.requested_grant.securityClasses,i._status="grant_security_classes"}var t;("device registered"===e.event&&(i._device=e.device),"node added"===e.event&&(i._status="interviewing",i._lowSecurity=e.node.low_security),"interview completed"===e.event)&&(i._unsubscribe(),i._status="finished",null!==(t=i._params)&&void 0!==t&&t.addedCallback&&i._params.addedCallback());"interview stage completed"===e.event&&(void 0===i._stages?i._stages=[e.stage]:i._stages=[].concat((0,E.A)(i._stages),[e.stage]))}),this._inclusionStrategy,e,void 0,void 0,t),this._addNodeTimeoutHandle=window.setTimeout((function(){i._unsubscribe(),i._status="timed_out"}),9e4)}}},{kind:"field",key:"_onBeforeUnload",value:function(){var e=this;return function(t){e._shouldPreventClose()&&t.preventDefault(),t.returnValue=!0}}},{kind:"method",key:"_unsubscribe",value:function(){this._subscribed&&(this._subscribed.then((function(e){return e()})),this._subscribed=void 0),this._entryId&&(0,Q.wI)(this.hass,this._entryId),this._requestedGrant=void 0,this._dsk=void 0,this._securityClasses=[],this._status=void 0,this._addNodeTimeoutHandle&&clearTimeout(this._addNodeTimeoutHandle),this._addNodeTimeoutHandle=void 0,window.removeEventListener("beforeunload",this._onBeforeUnload)}},{kind:"method",key:"closeDialog",value:function(){this._unsubscribe(),this._inclusionStrategy=void 0,this._entryId=void 0,this._status=void 0,this._device=void 0,this._stages=void 0,this._error=void 0,(0,U.r)(this,"dialog-closed",{dialog:this.localName})}},{kind:"get",static:!0,key:"styles",value:function(){return[B.nA,B.RF,(0,O.AH)(V||(V=(0,M.A)(["h3{margin-top:0}.success{color:var(--success-color)}.warning{color:var(--warning-color)}.stages{margin-top:16px;display:grid}.flex-container .stage ha-svg-icon{width:16px;height:16px;margin-right:0px;margin-inline-end:0px;margin-inline-start:initial}.stage{padding:8px}.flex-container{display:flex;align-items:center}.flex-column{display:flex;flex-direction:column}.flex-column ha-formfield{padding:8px 0}.select-inclusion{display:flex;align-items:center}.select-inclusion .outline:nth-child(2){margin-left:16px;margin-inline-start:16px;margin-inline-end:initial}.select-inclusion .outline{border:1px solid var(--divider-color);border-radius:4px;padding:16px;min-height:250px;text-align:center;flex:1}@media all and (max-width:500px){.select-inclusion{flex-direction:column}.select-inclusion .outline:nth-child(2){margin-left:0;margin-inline-start:0;margin-inline-end:initial;margin-top:16px}}ha-svg-icon{width:68px;height:48px}ha-textfield{display:block}.secondary{color:var(--secondary-text-color)}.flex-container ha-circular-progress,.flex-container ha-svg-icon{margin-right:20px;margin-inline-end:20px;margin-inline-start:initial}"])))]}}]}}),O.WF)}}]);
//# sourceMappingURL=99396.5AuQyEX0APE.js.map