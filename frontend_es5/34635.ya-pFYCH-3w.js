"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[34635,57540],{16025:function(t,e,n){var i=n(22858).A,a=n(33994).A;n.a(t,function(){var t=i(a().mark((function t(i,r){var o,s,u,c,l,h,f,d,g,v,m,y,p,_,k,x,b,A,w,M,z,F,E,H,q;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.r(e),o=n(64599),s=n(35806),u=n(71008),c=n(62193),l=n(2816),h=n(27927),f=n(81027),d=n(97741),g=n(16891),n(7986),v=n(50289),m=n(29818),y=n(55165),n(13082),p=n(43106),n(88400),_=n(47076),k=n(4826),x=n(20712),b=n(57540),A=n(7934),!(w=i([p,_,b])).then){t.next=34;break}return t.next=30,w;case 30:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=35;break;case 34:t.t0=w;case 35:M=t.t0,p=M[0],_=M[1],b=M[2],q={maximumFractionDigits:0},(0,h.A)([(0,m.EM)("hui-energy-self-sufficiency-gauge-card")],(function(t,e){var n=function(e){function n(){var e;(0,u.A)(this,n);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return e=(0,c.A)(this,n,[].concat(a)),t(e),e}return(0,l.A)(n,e),(0,s.A)(n)}(e);return{F:n,d:[{kind:"field",decorators:[(0,m.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,m.wk)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,m.wk)()],key:"_data",value:void 0},{kind:"field",key:"hassSubscribeRequiredHostProps",value:function(){return["_config"]}},{kind:"method",key:"hassSubscribe",value:function(){var t,e=this;return[(0,_.tb)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe((function(t){e._data=t}))]}},{kind:"method",key:"getCardSize",value:function(){return 4}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,A.xP)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"render",value:function(){var t;if(!this._config||!this.hass)return v.s6;if(!this._data)return(0,v.qy)(z||(z=(0,o.A)(["",""])),this.hass.localize("ui.panel.lovelace.cards.energy.loading"));var e=this._data.prefs,n=(0,_.E$)(e),i=void 0!==n.solar,a=void 0!==n.battery,r=n.grid[0].flow_to.length>0,s=null!==(t=(0,k.gF)(this._data.stats,n.grid[0].flow_from.map((function(t){return t.stat_energy_from}))))&&void 0!==t?t:0,u=null;i&&(u=(0,k.gF)(this._data.stats,n.solar.map((function(t){return t.stat_energy_from})))||0);var c=null,l=null;a&&(c=(0,k.gF)(this._data.stats,n.battery.map((function(t){return t.stat_energy_to})))||0,l=(0,k.gF)(this._data.stats,n.battery.map((function(t){return t.stat_energy_from})))||0);var h=null;r&&(h=(0,k.gF)(this._data.stats,n.grid[0].flow_to.map((function(t){return t.stat_energy_to})))||0);var f=null;i&&(f=(u||0)-(h||0)-(c||0));var d=null,g=null;null!==f&&f<0&&(a&&(d=-1*f)>s&&(g=d-s,d=s),f=0);var m=null;a&&(m=(l||0)-(g||0));var p,x=Math.max(0,s-(d||0)),b=Math.max(0,x+(f||0)+(m||0));return null!==s&&null!==b&&b>0&&(p=100*(1-s/b)),(0,v.qy)(F||(F=(0,o.A)([" <ha-card> "," </ha-card> "])),void 0!==p?(0,v.qy)(E||(E=(0,o.A)([' <ha-svg-icon id="info" .path="','"></ha-svg-icon> <simple-tooltip animation-delay="0" for="info" position="left"> <span> ',' </span> </simple-tooltip> <ha-gauge min="0" max="100" .value="','" label="%" .formatOptions="','" .locale="','" style="','"></ha-gauge> <div class="name"> '," </div> "])),"M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",this.hass.localize("ui.panel.lovelace.cards.energy.self_sufficiency_gauge.card_indicates_self_sufficiency_quota"),p,q,this.hass.locale,(0,y.W)({"--gauge-color":this._computeSeverity(p)}),this.hass.localize("ui.panel.lovelace.cards.energy.self_sufficiency_gauge.self_sufficiency_quota")):this.hass.localize("ui.panel.lovelace.cards.energy.self_sufficiency_gauge.self_sufficiency_could_not_calc"))}},{kind:"method",key:"_computeSeverity",value:function(t){return t>75?b.severityMap.green:t<50?b.severityMap.yellow:b.severityMap.normal}},{kind:"get",static:!0,key:"styles",value:function(){return(0,v.AH)(H||(H=(0,o.A)(["ha-card{height:100%;overflow:hidden;padding:16px;display:flex;align-items:center;justify-content:center;flex-direction:column;box-sizing:border-box}ha-gauge{width:100%;max-width:250px;direction:ltr}.name{text-align:center;line-height:initial;color:var(--primary-text-color);width:100%;font-size:15px;margin-top:8px}ha-svg-icon{position:absolute;right:4px;inset-inline-end:4px;inset-inline-start:initial;top:4px;color:var(--secondary-text-color)}simple-tooltip>span{font-size:12px;line-height:12px}simple-tooltip{width:80%;max-width:250px;top:8px!important}"])))}}]}}),(0,x.E)(v.WF)),r(),t.next=48;break;case 45:t.prev=45,t.t2=t.catch(0),r(t.t2);case 48:case"end":return t.stop()}}),t,null,[[0,45]])})));return function(e,n){return t.apply(this,arguments)}}())},57540:function(t,e,n){var i=n(22858).A,a=n(33994).A;n.a(t,function(){var t=i(a().mark((function t(i,r){var o,s,u,c,l,h,f,d,g,v,m,y,p,_,k,x,b,A,w,M,z,F,E,H,q,N,C,S,D,j,L,O,T,W,U,Z,I,P,Q,V,X,Y,$,B,J,R,G,K,tt,et,nt,it;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n.r(e),n.d(e,{DEFAULT_MAX:function(){return nt},DEFAULT_MIN:function(){return et},severityMap:function(){return it}}),o=n(64782),s=n(41981),u=n(64599),c=n(33994),l=n(22858),h=n(35806),f=n(71008),d=n(62193),g=n(2816),v=n(27927),m=n(35890),y=n(71499),p=n(81027),_=n(95737),k=n(97741),x=n(33231),b=n(50693),A=n(29193),w=n(26098),M=n(10507),z=n(39790),F=n(66457),E=n(99019),H=n(16891),q=n(96858),N=n(50289),C=n(29818),S=n(10977),D=n(85323),j=n(55165),L=n(38962),O=n(19244),T=n(26175),W=n(57636),n(13082),U=n(43106),Z=n(9883),I=n(25319),P=n(18102),Q=n(63582),V=n(562),X=n(7934),Y=n(46645),!($=i([W,U])).then){t.next=68;break}return t.next=64,$;case 64:t.t1=t.sent,t.t0=(0,t.t1)(),t.next=69;break;case 68:t.t0=$;case 69:B=t.t0,W=B[0],U=B[1],et=0,nt=100,it={red:"var(--error-color)",green:"var(--success-color)",yellow:"var(--warning-color)",normal:"var(--info-color)"},(0,v.A)([(0,C.EM)("hui-gauge-card")],(function(t,e){var i,a=function(e){function n(){var e;(0,f.A)(this,n);for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return e=(0,d.A)(this,n,[].concat(a)),t(e),e}return(0,g.A)(n,e),(0,h.A)(n)}(e);return{F:a,d:[{kind:"method",static:!0,key:"getConfigElement",value:(i=(0,l.A)((0,c.A)().mark((function t(){return(0,c.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e(59149).then(n.bind(n,59149));case 2:return t.abrupt("return",document.createElement("hui-gauge-card-editor"));case 3:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{kind:"method",static:!0,key:"getStubConfig",value:function(t,e,n){return{type:"gauge",entity:(0,P.B)(t,1,e,n,["counter","input_number","number","sensor"],(function(t){return!isNaN(Number(t.state))}))[0]||""}}},{kind:"field",decorators:[(0,C.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,C.wk)()],key:"_config",value:void 0},{kind:"method",key:"getCardSize",value:function(){return 4}},{kind:"method",key:"setConfig",value:function(t){if(!t.entity)throw new Error("Entity must be specified");if(!(0,T.n)(t.entity))throw new Error("Invalid entity");this._config=Object.assign({min:et,max:nt},t)}},{kind:"method",key:"render",value:function(){var t,e;if(!this._config||!this.hass)return N.s6;var n=this.hass.states[this._config.entity];if(!n)return(0,N.qy)(J||(J=(0,u.A)([" <hui-warning> "," </hui-warning> "])),(0,Y.j)(this.hass,this._config.entity));var i=Number(n.state);if(n.state===Z.Hh)return(0,N.qy)(R||(R=(0,u.A)([" <hui-warning>","</hui-warning> "])),this.hass.localize("ui.panel.lovelace.warning.entity_unavailable",{entity:this._config.entity}));if(isNaN(i))return(0,N.qy)(G||(G=(0,u.A)([" <hui-warning>","</hui-warning> "])),this.hass.localize("ui.panel.lovelace.warning.entity_non_numeric",{entity:this._config.entity}));var a=null!==(t=this._config.name)&&void 0!==t?t:(0,O.u)(n);return(0,N.qy)(K||(K=(0,u.A)([' <ha-card class="','" @action="','" .actionHandler="','" tabindex="','"> <ha-gauge .min="','" .max="','" .value="','" .formatOptions="','" .locale="','" .label="','" style="','" .needle="','" .levels="','"></ha-gauge> <div class="name" .title="','">',"</div> </ha-card> "])),(0,D.H)({action:(0,V.A)(this._config)}),this._handleAction,(0,I.T)({hasHold:(0,V.h)(this._config.hold_action),hasDoubleClick:(0,V.h)(this._config.double_tap_action)}),(0,S.J)(!this._config.tap_action||(0,V.h)(this._config.tap_action)?"0":void 0),this._config.min,this._config.max,n.state,(0,W.ZQ)(n,this.hass.entities[n.entity_id]),this.hass.locale,this._config.unit||(null===(e=this.hass)||void 0===e?void 0:e.states[this._config.entity].attributes.unit_of_measurement)||"",(0,j.W)({"--gauge-color":this._computeSeverity(i)}),this._config.needle,this._config.needle?this._severityLevels():void 0,a,a)}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,X.LX)(this,t)}},{kind:"method",key:"updated",value:function(t){if((0,m.A)(a,"updated",this,3)([t]),this._config&&this.hass){var e=t.get("hass"),n=t.get("_config");e&&n&&e.themes===this.hass.themes&&n.theme===this._config.theme||(0,L.Q)(this,this.hass.themes,this._config.theme)}}},{kind:"method",key:"_computeSeverity",value:function(t){if(!this._config.needle){var e=this._config.segments;if(e){e=(0,s.A)(e).sort((function(t,e){return t.from-e.from}));for(var n=0;n<e.length;n++){var i,a=e[n];if(a&&t>=a.from&&(n+1===e.length||t<(null===(i=e[n+1])||void 0===i?void 0:i.from)))return a.color}return it.normal}var r=this._config.severity;if(!r)return it.normal;var u,c=Object.keys(r).map((function(t){return[t,r[t]]})),l=(0,o.A)(c);try{for(l.s();!(u=l.n()).done;){var h=u.value;if(null==it[h[0]]||isNaN(h[1]))return it.normal}}catch(f){l.e(f)}finally{l.f()}return c.sort((function(t,e){return t[1]-e[1]})),t>=c[0][1]&&t<c[1][1]?it[c[0][0]]:t>=c[1][1]&&t<c[2][1]?it[c[1][0]]:t>=c[2][1]?it[c[2][0]]:it.normal}}},{kind:"method",key:"_severityLevels",value:function(){var t=this._config.segments;if(t)return t.map((function(t){return{level:null==t?void 0:t.from,stroke:null==t?void 0:t.color,label:null==t?void 0:t.label}}));var e=this._config.severity;return e?Object.keys(e).map((function(t){return{level:e[t],stroke:it[t]}})):[{level:0,stroke:it.normal}]}},{kind:"method",key:"_handleAction",value:function(t){(0,Q.$)(this,this.hass,this._config,t.detail.action)}},{kind:"get",static:!0,key:"styles",value:function(){return(0,N.AH)(tt||(tt=(0,u.A)(["ha-card{height:100%;overflow:hidden;padding:16px;display:flex;align-items:center;justify-content:center;flex-direction:column;box-sizing:border-box}ha-card.action{cursor:pointer}ha-card:focus{outline:0}ha-gauge{width:100%;max-width:250px}.name{text-align:center;line-height:initial;color:var(--primary-text-color);width:100%;font-size:15px;margin-top:8px}"])))}}]}}),N.WF),r(),t.next=82;break;case 79:t.prev=79,t.t2=t.catch(0),r(t.t2);case 82:case"end":return t.stop()}}),t,null,[[0,79]])})));return function(e,n){return t.apply(this,arguments)}}())},24226:function(t,e,n){n.d(e,{z:function(){return a}});var i=n(30429);function a(t,e){var n=(0,i.a)(t),a=(0,i.a)(e),r=n.getTime()-a.getTime();return r<0?-1:r>0?1:r}},72730:function(t,e,n){n.d(e,{W:function(){return s}});n(29193);var i=n(24226),a=n(30429);function r(t,e){var n=(0,a.a)(t),i=(0,a.a)(e);return 12*(n.getFullYear()-i.getFullYear())+(n.getMonth()-i.getMonth())}var o=n(91103);function s(t,e){var n,s=(0,a.a)(t),u=(0,a.a)(e),c=(0,i.z)(s,u),l=Math.abs(r(s,u));if(l<1)n=0;else{1===s.getMonth()&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-c*l);var h=(0,i.z)(s,u)===-c;(0,o.c)((0,a.a)(t))&&1===l&&1===(0,i.z)(t,u)&&(h=!1),n=c*(l-Number(h))}return 0===n?0:n}},77301:function(t,e,n){n.d(e,{e:function(){return a}});var i=n(30429);function a(t){return 1===(0,i.a)(t).getDate()}},91103:function(t,e,n){n.d(e,{c:function(){return o}});var i=n(60132),a=n(12152),r=n(30429);function o(t){var e=(0,r.a)(t);return+(0,i.D)(e)==+(0,a.p)(e)}}}]);
//# sourceMappingURL=34635.ya-pFYCH-3w.js.map